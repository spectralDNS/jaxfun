<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>curvilinear.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>curvilinear</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/index-DVgeLSg0.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-DxWb3aMV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-NOntBqny.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-CF9gSfGe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-PzrizfuL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-BNkRH34W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-LUpffRIq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-MyTWYTLd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-maX8rbyb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-Bt3KRZho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cells-Botr-aL3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/textarea-BmPX99zz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/switch-Vbll2pdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/mode-C1hn9AVp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/ai-model-dropdown-BMv5J-EA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cell-link-DvW8RUk0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/datasource-acoDY9Ku.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/state-AxOl5_1Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/MarimoErrorOutput-a6bY4dzO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/html-to-image-CVa2JapI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/focus--DQRDy9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/LazyAnyLanguageCodeMirror-BTO7DS3k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/markdown-renderer-DqiLSa6X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/command-BMidGaii.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/download-COpfLoar.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useRunCells-DrrCdLgV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/RenderHTML-CG3x4AfR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/JsonOutput-ChH_9MPt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDeleteCell-CRLMdzIa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/process-output-uzyiTMlC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/esm-BqiVbELQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/add-cell-with-ai-C09q01JF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chat-display-DLmJWehR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/column-preview-BZevmZKp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/globals-DVVNoYwt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/utilities.esm-Di0IV3nO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/floating-outline-CMt2sk--.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useAddCell-DKJ0NHXX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/readonly-python-code-Co1fGZLh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/types-Dv1-Phf0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/form-CEIWhPlm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/index-CeUwN_0i.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
    window.__MARIMO_STATIC__.modelNotifications = [];
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "curvilinear.py",
            "mode": "read",
            "version": "0.19.11",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "mo.md(r\"\"\"\n# Curvilinear coordinates in Jaxfun\n\nJaxfun is developed to work with any curvilinear coordinate system and not just the regular Cartesian. A user should describe equations for a generic coordinate system using operators like `div`, `grad`, `dot`, `outer`, `cross` and `curl`. The correct equations in curvilinear coordinates should then be automatically derived by Jaxfun under the hood. What goes on under the hood is described in more detail in this article.\n\nThere is not really enough time or space to go through all details regarding curvilinear coordinates here, so the interested reader is referred to the excellent online textbook by Kelly, PA. Mechanics Lecture Notes: An introduction to Solid Mechanics.  Available from [here](http://homepages.engineering.auckland.ac.nz/~pkel015/SolidMechanicsBooks/index.html)\n\nIn the following we will consider two coordinate systems, the Cartesian with coordinates\n\n\\begin{equation}\n    \\mathbf{x} = \\{x^{i}\\}_{i\\in\\mathcal{I}^n},\n\\end{equation}\n\nand the computational, with coordinates\n\n\\begin{equation}\n    \\mathbf{X} = \\{X^{i}\\}_{i\\in\\mathcal{I}^m}.\n\\end{equation}\n\nHere $\\mathcal{I}^m$ and $\\mathcal{I}^n$ are two index sets for the number of computational coordinates, and the dimension of the physical space, respectively, and $m\\leq n$. Throughout this article an index set will be denoted as $\\mathcal{I}^{N}=\\{0, 1, \\ldots, N-1\\}$, where $N\\in \\mathbb{Z}^+$.\n\nThe physical domain will be denoted as $\\Omega^m \\subseteq \\mathbb{R}^n$, where $m=1,2$ and 3 represents curves, surfaces and volumes, respectively. Likewise, the computational domain will be denoted as $\\mathbb{I}^m \\subseteq \\mathbb{R}^m$. The computational domain is a hypercube, with $\\mathbb{I}^2 = \\text{I}^0 \\times \\text{I}^1$ and $\\mathbb{I}^3 = \\text{I}^0 \\times \\text{I}^1 \\times \\text{I}^2$, where $\\text{I}^m$ is the interval used for computational dimension $m$. Hence, computations are always performed on hypercubes.\n\"\"\")", "code_hash": "73cf3df9faa94c25d8de751fb289f38b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe coordinate curves $X^{i}$ are functions of the Cartesian coordinates\n\n\\begin{equation}\n X^{i} = X^{i}(\\mathbf{x}), \\quad \\text{for } i \\in \\mathcal{I}^m, \\tag{3}\n\\end{equation}\n\nand we get the Cartesian coordinates through the inverse maps\n\n\\begin{equation}\nx^i=x^i(\\mathbf{X}), \\quad \\text{for } i \\in \\mathcal{I}^n.\\tag{4}\n\\end{equation}\n\nUsing these generic maps a function $u : \\Omega^m \\rightarrow \\mathbb{K}$, where $\\mathbb{K}$ may be either $\\mathbb{R}$ or $\\mathbb{C}$, may now be transformed from physical to computational space through a change of variables as\n\n\\begin{equation}\nu(\\mathbf{x}) = u(\\mathbf{x}(\\mathbf{X})) = U(\\mathbf{X}),\\tag{5}\n\\end{equation}\n\nA simple and well known example is for polar coordinates, where the Cartesian coordinates $x$ and $y$ are mapped to the polar coordinates $r$ and $\\theta$ as\n\n$$\nx(r, \\theta) = r \\cos \\theta \\quad \\text{and} \\quad  y(r, \\theta) = r \\sin \\theta\n$$\n\nA Cartesian function for a circle of radius one is $u(x, y) = \\sqrt{x^2 + y^2} -1$. Inserting for the polar maps we get $u(x(r, \\theta), y(r, \\theta)) = \\sqrt{(r \\cos \\theta)^2 + (r \\sin \\theta)^2} - 1 = r - 1 = U(r, \\theta)$.\n\"\"\")", "code_hash": "4b15a72329e9919142c761ef0f1ad4e0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe transformation for any curvilinear coordinate system will be defined through the use of a position vector, which can be written as a function of the new coordinates\n\n\\begin{equation}\n    \\mathbf{r}(\\mathbf{X}) = x^i(\\mathbf{X}) \\,\\mathbf{i}_i,\\tag{6}\n\\end{equation}\n\nwhere there is here, and throughout this article, summation implied by repeating indices. The Cartesian unit basis vectors are denoted as $\\mathbf{i}_i\\in\\mathbb{R}^n$ for $i\\in \\mathcal{I}^n$. The position vector can describe any point in the physical domain $\\Omega^m$.\n\"\"\")", "code_hash": "b4c1c463791a9a112b03b0788cf5b78d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(r\"\"\"\nA curvilinear coordinate system can be described using two different sets of basis vectors, the co- or contravariant basis vectors.\n\nThe covariant basis vectors are defined as\n\n\\begin{equation}\n    \\mathbf{b}_i(\\mathbf{X}) = \\frac{\\partial \\mathbf{r}}{\\partial X^{i}}, \\quad \\text{for } i \\, \\in \\mathcal{I}^m,\\tag{8}\n\\end{equation}\n\nThe covariant basis vectors $\\mathbf{b}_i$ are tangent to the $m$ coordinate curves $X^i(\\mathbf{x})$.\n\nThe contravariant basis vectors are defined as\n\n\\begin{equation}\n    \\mathbf{b}^{i}(\\mathbf{X}) =  \\mathbf{i}_j\\frac{\\partial X^{i}}{\\partial x^j}, \\quad \\text{for } i \\, \\in \\mathcal{I}^m.\\tag{9}\n\\end{equation}\n\nThe contravariant basis vectors are orthogonal to the covariant basis vectors\n\n\\begin{equation}\n    \\mathbf{b}^{i} \\cdot \\mathbf{b}_{j} = \\delta_{j}^{i}, \\quad \\text{for } i, j \\, \\in \\mathcal{I}^{m \\times m}.\\tag{10}\n\\end{equation}\n\nAny vector $\\mathbf{v}(\\mathbf{X})$ (boldface lower case letter) can be given with either co- or contravariant basis functions in the computational domain and we write them as\n\n\\begin{equation}\n    \\mathbf{v} = {v}^{i} \\mathbf{b}_i = {v}_i \\mathbf{b}^{i},\\tag{11}\n\\end{equation}\n\nwhere ${v}_{i}(\\mathbf{X})$ and ${v}^{i}(\\mathbf{X})$ are co- and contravariant vector components, respectively. The sub- or superscript of the coefficient are used to recognise which basis functions are used. The vector $\\mathbf{v}$ can also be given in Cartesian basis vectors, but since both sub- and superscripts are taken, we must make use of an alternative notation that includes the Cartesian variables $\\mathbf{v}(\\mathbf{x}) = v^{i}(\\mathbf{x}) \\mathbf{i}_i$.\n\nWhen a vector is written with contravariant vector components $\\mathbf{v} = {v}^{i} \\mathbf{b}_i$, the vector is called a contravariant vector. This is the default used by Jaxfun. When the vector is written with covariant components $\\mathbf{v} = {v}_i \\mathbf{b}^{i}$ it is called a covariant vector. This is a bit confusing since a contravariant vector is using covariant basis vectors and vice versa!\n\"\"\")", "code_hash": "32d456cc4fb3f566e3c9cf09f71d418c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mo.md(r\"\"\"\nIn Jaxfun we work by default in the covariant basis with contravariant vector components. However, we can obtain the covariant components ${v}_{i}$ as\n\n$$\n{v}_{i} = {v}^j \\mathbf{b}_j \\cdot \\mathbf{b}_i = {v}^j g_{ji}\n$$\n\nThe co- and contravariant metric tensors are defined as\n\n\\begin{align}\ng_{ij}(\\mathbf{X}) \u0026= \\mathbf{b}_i \\cdot \\mathbf{b}_j \\quad \\text{for } i, j \\in \\mathcal{I}^{m \\times m}, \\tag{12} \\\\\ng^{ij}(\\mathbf{X}) \u0026= \\mathbf{b}^{i} \\cdot \\mathbf{b}^{j} \\quad \\text{for } i, j \\in \\mathcal{I}^{m \\times m}, \\tag{13}\n\\end{align}\n\nrespectively. Finally, the determinant of the covariant metric tensor is given as\n\n\\begin{equation}\n    g(\\mathbf{X}) = \\det([g_{ij}]),\\tag{14}\n\\end{equation}\n\nwhere $[g_{ij}]$ represents the tensor with components $g_{ij}$.\nNote that if $m=n$, then $\\sqrt{g}$ is equal to the determinant of the Jacobian matrix. Also note that if the basis vectors are orthogonal, then $[g_{ij}]$ and $[g^{ij}]$ are diagonal matrices and the co- and contravariant basis vectors  $\\mathbf{b}_{i}$ and $\\mathbf{b}^{i}$ are parallel.\n\nWe can get the contravariant basis vectors from the covariant and vice versa using\n\n$$\n\\begin{align*}\n\\mathbf{b}^{i} \u0026= g^{ij} \\mathbf{b}_{j} \\\\\n\\mathbf{b}_{i} \u0026= g_{ij} \\mathbf{b}^{j}\n\\end{align*}\n$$\n\nThe metric tensors are available in Jaxfun using methods `get_covariant_metric_tensor` and `get_contravariant_metric_tensor` on the given curvilinear coordinate system.\n\"\"\")", "code_hash": "f665154f375ab0bb75234227687c681f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe vector dot product can be defined for curvilinear coordinates as\n\n$$\n\\mathbf{u} \\cdot \\mathbf{v} = {u}^{i}\\mathbf{b}_i \\cdot {v}_j \\mathbf{b}^{j} = {u}^{i} {v}_i\n$$\n\nbecause of Eq. (10).\n\nThe dot product between two vectors both expressed in a covariant basis can be computed as\n\n$$\n{u}^{i}\\mathbf{b}_i \\cdot {v}^{j} \\mathbf{b}_{j} = {u}^{i} {v}^{j} g_{ij}\n$$\n\"\"\")", "code_hash": "6b6712e9bcb2857b8cd749595d134c85", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe illustrate first with a simple example. Consider a simple skewed coordinate system defined by $x(u, v) = u + v$ and $y(u, v) = v$, with curvilinear coordinates $u, v \\in [0, 2]\\times [0, 2]$, such that the position vector is\n\n$$\n\\mathbf{r}(u, v) = (u+v) \\mathbf{i} + v \\mathbf{j},\n$$\n\nwhere $\\mathbf{i}$ and $\\mathbf{j}$ are the Cartesian unit basis vectors. The coordinate curves are straight lines, but they are not orthogonal to each other. The covariant basis vectors are $\\mathbf{b}_u = \\frac{\\partial \\mathbf{r}}{\\partial u} = \\mathbf{i}$ and $\\mathbf{b}_v = \\frac{\\partial \\mathbf{r}}{ \\partial v} = \\mathbf{i} + \\mathbf{j}$, and the contravariant basis vectors are $\\mathbf{b}^u = \\mathbf{i} - \\mathbf{j}$ and $\\mathbf{b}^v = \\mathbf{j}$. The basis vectors are illustrated in the figure below. Note that the covariant base vectors align with the constant gridlines (the coordinate curves of $u$ and $v$) and the contravariant base vectors are orthogonal to the gridlines. The contravariant vectors are as such the vectors that point orthogonally out from the physical domain $\\Omega$. That is, $\\mathbf{b}^{u}$ points out of the domain below defined by the curveline drawn at constant $v=2$, i.e., $u = x - 2$.\n\"\"\")", "code_hash": "c94c6fead69b7989d03bfb747847ac3f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "from jaxfun.utils import lambdify\nimport matplotlib.pyplot as plt\n\ndef plot():\n    u, v = sp.symbols(\"u, v\", real=True, positive=True)\n    P = get_CoordSys(\"P\", sp.Lambda((u, v), (u + v, v)))\n    u, v = P.base_scalars()\n    rv = P.position_vector(False)\n    assert isinstance(rv, sp.Tuple)\n\n    b = P.get_covariant_basis()\n    bt = P.get_contravariant_basis()\n\n    r0 = 2.0\n    t0 = 1.0\n    pos = np.array(\n        [lambdify((u, v), rv[0])(r0, t0), lambdify((u, v), rv[1])(r0, t0)]\n    )\n\n    b_num = np.array(\n        [[lambdify((u, v), b[i, j])(r0, t0) for j in range(2)] for i in range(2)],\n        dtype=float,\n    )\n    bt_num = np.array(\n        [[lambdify((u, v), bt[i, j])(r0, t0) for j in range(2)] for i in range(2)],\n        dtype=float,\n    )\n\n    fig, ax = plt.subplots(figsize=(5, 5))\n    ax.set_aspect(\"equal\")\n    ax.set_title(\"Gridlines and basis vectors\")\n\n    u_grid = np.linspace(0.0, 2.0, 7)\n    v_grid = np.linspace(0.0, 2.0, 7)\n    v_line = np.linspace(0.0, 2.0, 100)\n    u_line = np.linspace(0.0, 2.0, 100)\n\n    for u0 in u_grid:\n        x_line = lambdify((u, v), rv[0])(u0, v_line)\n        y_line = lambdify((u, v), rv[1])(u0, v_line)\n        ax.plot(x_line, y_line, color=\"0.85\", linewidth=1)\n\n    for v0 in v_grid:\n        x_line = np.atleast_1d(lambdify((u, v), rv[0])(u_line, v0))\n        y_line = np.atleast_1d(lambdify((u, v), rv[1])(u_line, v0))\n        if y_line.shape[0] == 1:\n            y_line = np.full_like(x_line, y_line.item())\n        ax.plot(x_line, y_line, color=\"0.85\", linewidth=1)\n\n    ax.quiver(\n        *pos,\n        *b_num[0],\n        color=\"tab:blue\",\n        angles=\"xy\",\n        scale_units=\"xy\",\n        scale=1,\n        label=r\"$\\mathbf{b}_u$\",\n    )\n    ax.quiver(\n        *pos,\n        *b_num[1],\n        color=\"tab:blue\",\n        angles=\"xy\",\n        scale_units=\"xy\",\n        scale=1,\n        alpha=0.5,\n        label=r\"$\\mathbf{b}_v$\",\n    )\n    ax.quiver(\n        *pos,\n        *bt_num[0],\n        color=\"tab:orange\",\n        angles=\"xy\",\n        scale_units=\"xy\",\n        scale=1,\n        label=r\"$\\mathbf{b}^u$\",\n    )\n    ax.quiver(\n        *pos,\n        *bt_num[1],\n        color=\"tab:orange\",\n        angles=\"xy\",\n        scale_units=\"xy\",\n        scale=1,\n        alpha=0.5,\n        label=r\"$\\mathbf{b}^v$\",\n    )\n\n    ax.set_xlim(-0.2, 4.2)\n    ax.set_ylim(-0.2, 2.2)\n    ax.legend(loc=\"upper left\")\n    plt.show()\n\nplot()", "code_hash": "04fff1599c4e9d7eae55d048f678989c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Cylindrical coordinate system\n\nWe will illustrate further by creating an orthogonal cylindrical coordinate system, defined from the position vector\n\n$$\n\\mathbf{r}(r, \\theta, z) = r \\cos \\theta \\mathbf{i} + r \\sin \\theta \\mathbf{j} + z \\mathbf{k}\n$$\n\nwhere $r \\in [0, 1]$ and $\\theta \\in (0, 2 \\pi]$\n\"\"\")", "code_hash": "404bc6a0b7ef563bff4bdede7b550358", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "from IPython.display import display\nfrom jaxfun.operators import Dot, dot\nfrom jaxfun.coordinates import get_CoordSys\nimport sympy as sp\n\nr, theta, z = sp.symbols(\"r,theta,z\", real=True, positive=True)\nC = get_CoordSys(\n    \"C\", sp.Lambda((r, theta, z), (r * sp.cos(theta), r * sp.sin(theta), z))\n)\nr, theta, z = C.base_scalars()", "code_hash": "48dbf284d383d2d206a71d4f0ba09a53", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote that the curvilinear coordinate system is created from only the forward map $\\mathbf{x}(\\mathbf{X})$ and we do not need to provide the reverse map $\\mathbf{X}(\\mathbf{x})$, which for the cylinder coordinates would be\n\n$$\nr = \\sqrt{x^2+y^2}, \\quad \\theta = \\tan^{-1}(y/x), \\quad z = z.\n$$\n\nThis is because Jaxfun is using the covariant basis vectors computed from the forward map, and the contravariant basis vector may then be computed simply from the $\\mathbf{b}^i = g^{ij} \\mathbf{b}_j$, where $[g^{ij}] = [g_{ij}]^{-1}$. So the reverse map is not explicitly used and as such it does not have to be provided by the user.\n\nNote that on the last line in the code section above we overwrite the sympy symbols `r`, `theta`, `z` with objects of type `BaseScalar`.\n\nAs a first example create two contravariant vectors and take the dot product:\n\"\"\")", "code_hash": "e061aebb428df85e2a9a646ebd7b190b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "u = 4 * C.b_r + 3 * C.b_theta + 2 * C.b_z\nv = C.b_r\nd = Dot(u, v)\ndisplay(d)\ndisplay(d.doit())", "code_hash": "22ff783809549742ae47d7f5c1166056", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote that `Dot` represents an unevaluated dot product. It is evaluated by calling `doit()`. Under the hood this invokes the `dot` function. We could alternatively just use the `dot`function:\n\"\"\")", "code_hash": "ba6e83034f46b59382b1280821c1ce48", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "dot(u, v)", "code_hash": "2cd2b3194ebc043abafa12027ecea1fc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe covariant metric tensor is given for cylindrical coordinates as:\n\"\"\")", "code_hash": "83ffc0ea07407270206af0f40ac59da3", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "print(C.get_covariant_metric_tensor())", "code_hash": "99bd5fb4e88b4140a57c2fd49873a2c9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe metric tensor is diagonal since the cylindrical coordinates are orthogonal.\n\nWe can also create vectors in Cartesian Coordinates and transform them into the curvilinear system. For example, the position vector in Cartesian coordinates is\n\"\"\")", "code_hash": "d4ab280ea56aa99802bec2aa7e2e2bd6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "R = C._parent  # The Cartesian coordinate system\np = R.x * R.i + R.y * R.j + R.z * R.k\ndisplay(p)", "code_hash": "2a58b2ffd5216cc731e07afb2b1a44d3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"\nRunning `doit` on this vector transforms the components into computational coordinates, but does not change basis\n\"\"\")", "code_hash": "5269b2af5c6528beeb95d73d8c2c9aa3", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "display(p.doit())", "code_hash": "7a93332ecf0dd4a7d9f64ddedbe823f2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe can get this vector $\\mathbf{p}$ as fully contravariant by computing\n\n$$\n\\boldsymbol{p} = (\\boldsymbol{p} \\cdot \\boldsymbol{b}_r) \\boldsymbol{b}_r + (\\boldsymbol{p} \\cdot \\boldsymbol{b}_{\\theta}) \\boldsymbol{b}_{\\theta} + (\\boldsymbol{p} \\cdot \\boldsymbol{b}_{z}) \\boldsymbol{b}_{z} = r \\boldsymbol{b}_r + z \\mathbf{b}_z\n$$\n\nThis is called a projection of the vector $\\boldsymbol{p}$ onto the covariant cylinder basis. The projection can be computed with method `from_cartesian`:\n\"\"\")", "code_hash": "0d718e2f5e49eb59dbea8af5820dbe1d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "display(C.from_cartesian(p))", "code_hash": "371903daae1784b7c9be01c142c25f75", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe can also go the other way and compute a Cartesian vector from a contravariant:\n\"\"\")", "code_hash": "770a3358f702505b0541b1c30882745f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "C.to_cartesian(C.b_theta)", "code_hash": "6238c5652aa6872d150813c2c5559406", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(r\"\"\"\nAnd we can look at the contravariant basis vectors in terms of Cartesian coordinates\n\"\"\")", "code_hash": "26d84db0b1bab8da0ffe8883dbdc5f53", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZBYS", "name": "_"}, {"code": "C.get_contravariant_basis(True)", "code_hash": "3b4cbb00ac1c201f69a9d200616c4145", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe point is that a vector $\\mathbf{v}$ can be formulated using several different basis vectors and there may be advantages or disadvantages to all of them.\n\"\"\")", "code_hash": "714bc9104b39e0ad61d1993f9b1edb05", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"\n### Cross product\n\nThe cross product between two vectors can be obtained as\n\n$$\n\\mathbf{u} \\times \\mathbf{v} = \\varepsilon_{ijk} \\sqrt{g} {u}^j {v}^k \\mathbf{b}^{i} = \\varepsilon_{ijk} \\sqrt{g} {u}^j {v}^k g^{il}\\mathbf{b}_l\n$$\n\"\"\")", "code_hash": "f0010654e6e5e5886cd1b1a02c1983b3", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xXTn", "name": "_"}, {"code": "from jaxfun.operators import Cross\n\ncr = Cross(C.b_r, C.b_theta)\ndisplay(cr)\ndisplay(cr.doit())", "code_hash": "fc7e18af96ea088734c3737b93366cdf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Dyadics\n\nThe tensor product (or outer product) of two vectors is written\n\n$$\n\\mathbf{A} = \\mathbf{u} \\otimes \\mathbf{v}\n$$\n\nThe second order tensor $\\mathbf{A}$ is called a dyad. There are four possible basis configurations for dyads\n\n$$\n\\begin{align*}\n\\mathbf{b}^{i} \u0026\\otimes \\mathbf{b}^{j} \\\\\n\\mathbf{b}^{i} \u0026\\otimes \\mathbf{b}_{j} \\\\\n\\mathbf{b}_{i} \u0026\\otimes \\mathbf{b}^{j} \\\\\n\\mathbf{b}_{i} \u0026\\otimes \\mathbf{b}_{j} \\\\\n\\end{align*}\n$$\n\nIn Jaxfun we use the last one, with two covariant base vectors $\\mathbf{b}_{i} \\otimes \\mathbf{b}_{j}$. In this case\n\n$$\n\\mathbf{A} = A^{ij} \\mathbf{b}_i \\otimes \\mathbf{b}_j.\n$$\n\nwhere $A^{ij}$ are called the contravariant components.\n\nThe outer product of two vectors is computed as\n\n$$\n\\mathbf{u} \\otimes \\mathbf{v} = {u}^{i} \\mathbf{b}_{i} \\otimes {v}^{j} \\mathbf{b}_{j} = {u}^{i} {v}^{j} \\mathbf{b}_{i} \\otimes \\mathbf{b}_{j}\n$$\n\nDyads are actually defined by how they contract with vectors\n\n$$\n\\begin{align*}\n(\\mathbf{u} \\otimes \\mathbf{v}) \\cdot \\mathbf{w} \u0026= (\\mathbf{v} \\cdot \\mathbf{w}) \\mathbf{u}\\\\\n\\mathbf{w} \\cdot (\\mathbf{u} \\otimes \\mathbf{v}) \u0026= (\\mathbf{w} \\cdot \\mathbf{u}) \\mathbf{v}\n\\end{align*}\n$$\n\nNote that some authors do not use a dot for the contraction of a dyad with a vector and would write instead $(\\mathbf{u} \\otimes \\mathbf{v}) \\mathbf{w}$. Since we use the `Dot/dot` in Jaxfun to represent the contraction of both dyadics and vectors, we find it more appropriate to include the dot also for contraction of higher order tensors.\n\nA linear combination of dyads is called a dyadic. For example $\\mathbf{A} = 2(\\mathbf{u} \\otimes \\mathbf{v}) + 3 (\\mathbf{w} \\otimes \\mathbf{z})$. Note that even though a dyad is a second order tensor, not all second order tensors are dyads. That is, we cannot always write the tensor $\\mathbf{A}$ as the tensor product of two vectors $\\mathbf{u} \\otimes \\mathbf{v}$.\n\nThe contraction of two dyads leads to a dyad\n\n$$\n(\\mathbf{u} \\otimes \\mathbf{v}) \\cdot (\\mathbf{w} \\otimes \\mathbf{z}) = (\\mathbf{v} \\cdot \\mathbf{w}) (\\mathbf{u} \\otimes \\mathbf{z})\n$$\n\nLet create some dyadics in Jaxfun and illustrate. First, the 9 dyad base vectors can be obtained as\n\"\"\")", "code_hash": "57e48423c727ecd3827edb3c9d46f3b6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "pHFh", "name": "_"}, {"code": "bb = C.base_dyadics()\ndisplay(bb)", "code_hash": "8090d28cc1bb329d348385752ee98a9f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "NCOB", "name": "_"}, {"code": "import numpy as np\n\nbv = np.array(bb, dtype=object).reshape((3, 3))\nA = 2 * bv[0, 1] + 3 * bv[1, 2]\nB = r * bv[1, 1] + theta * bv[2, 2]\ndisplay(A)\ndisplay(B)", "code_hash": "265c094d8b7d0c2d132866789933c0b3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "mo.md(r\"\"\"\nContract `A` with `B`\n\"\"\")", "code_hash": "c12514b2afbd4cbfddef68807f5dc30f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "H = Dot(A, B)\ndisplay(H)\ndisplay(H.doit())", "code_hash": "32b6c0273518e0424207cd82b241d1e6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Operators in curvilinear coordinates\n\n### Vector operations\n\nThe gradient of a scalar field $f(\\mathbf{x}) (=F(\\mathbf{X}))$ is termed $\\text{grad}(f)$ and equals\n\n\\begin{equation}\n\\text{grad}(f) = \\nabla f = \\frac{\\partial {F}}{\\partial X^{i}}\\,\\mathbf{b}^{i} = \\frac{\\partial {F}}{\\partial X^{i}} g^{ij} \\,\\mathbf{b}_{j}. \\tag{15}\n\\end{equation}\n\nNote that the computation in curvilinear coordinates is simply using a change of variables and the chain rule\n\n$$\n\\nabla f = \\frac{\\partial f(\\mathbf{x})}{\\partial x_i} \\mathbf{i}_{i} = \\frac{\\partial F(\\mathbf{X})}{\\partial X^j} \\frac{\\partial X^j}{\\partial x_i} \\mathbf{i}_{i} = \\frac{\\partial F}{\\partial X^j} \\mathbf{b}^j.\n$$\n\nThe divergence of a vector $\\mathbf{v}$, in terms of its contravariant components, is given as\n\n\\begin{equation}\n\\text{div}(\\mathbf{v}) = \\nabla \\cdot \\mathbf{v} = \\frac{\\partial \\mathbf{v}}{\\partial X^j} \\cdot \\mathbf{b}^j = \\frac{1}{\\sqrt{g}} \\frac{\\partial {v}^{i} \\sqrt{g}}{\\partial X^{i}},\\tag{16}\n\\end{equation}\n\nand the Laplacian of the scalar field $f$ can be written as\n\n\\begin{equation}\n\\text{div}(\\text{grad}(f)) = \\nabla^2 f  = \\frac{1}{\\sqrt{g}}\\frac{\\partial}{\\partial X^{i}}\\left( g^{ij} \\sqrt{g} \\frac{\\partial {F}}{\\partial X^{j}}\\right). \\tag{17}\n\\end{equation}\n\nNote that $g^{ij}$ and $\\sqrt{g}$ will act as variable coefficients when the operators are used in differential equations.\n\nThe curl of a vector is defined as\n\n$$\n\\text{curl}(\\mathbf{v}) = \\nabla \\times \\mathbf{v} = \\mathbf{b}^{j} \\times \\frac{\\partial \\mathbf{v}}{\\partial X^j} = \\frac{\\varepsilon_{ijk}}{\\sqrt{g}} \\frac{\\partial {v}_k}{\\partial X^j} \\mathbf{b}_i \\tag{18}\n$$\n\nThe partial derivative $\\frac{\\partial \\mathbf{v}}{\\partial X^j}$ is implemented in Jaxfun as the `diff` operator working on vectors. The partial derivative can be computed as\n\n$$\n\\frac{\\partial \\mathbf{v}}{\\partial X^j} = \\left(\\frac{\\partial {v}^{i}}{\\partial X^j} + \\Gamma^{i}_{kj} {v}^k\\right) \\mathbf{b}_i \\tag{19}\n$$\n\nwhere $\\Gamma^{i}_{kj}$ is the Christoffel symbol of the second kind\n\n$$\n\\Gamma^{k}_{ji} = \\frac{\\partial \\mathbf{b}_{i}}{\\partial X^j} \\cdot \\mathbf{b}^k \\tag{20}\n$$\n\navailable in Jaxfun as method `get_christoffel_second`.\n\nThe term $\\frac{\\partial {v}^{i}}{\\partial X^j} + \\Gamma^{i}_{kj} {v}^k$ is called the covariant derivative of vector components.\n\nThe Christoffel symbol falls out of the last identity for the curl due to the symmetry $\\Gamma^{k}_{ji} = \\Gamma^k_{ij}$.\n\"\"\")", "code_hash": "71acd4cda0ab2d72d24e8f9da3e162f0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dNNg", "name": "_"}, {"code": "mo.md(r\"\"\"\n### Tensor operations\n\nThe gradient of a vector is a second order tensor\n\n$$\n\\text{grad}(\\mathbf{v}) = \\frac{\\partial \\mathbf{v}}{\\partial X^j} \\otimes \\mathbf{b}^j \\tag{21}\n$$\n\nNote that if $\\nabla$ is interpreted as a vector, then this corresponds to $(\\nabla \\otimes \\mathbf{v})^T$. However, in Jaxfun printing we interpret $\\nabla$ as an operator and as such $\\text{grad}(\\mathbf{v})$ is printed as $\\nabla \\mathbf{v}$.\n\nThe divergence of a second order tensor $\\mathbf{A}$ is\n\n$$\n\\text{div}(\\mathbf{A}) = \\frac{\\partial \\mathbf{A}}{\\partial X^j} \\cdot \\mathbf{b}^j \\tag{22}\n$$\n\nAgain, if $\\nabla$ is interpreted as a vector, then $\\text{div}(\\mathbf{A}) = \\nabla \\cdot \\mathbf{A}^T$. But in Jaxfun's printing $\\nabla$ is an operator acting over the last axis of its input tensor. Hence the divergence of a tensor is printed as $\\nabla \\cdot \\mathbf{A}$.\n\"\"\")", "code_hash": "2e9f5c8abf6a852b54d5a2d54366d489", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "from jaxfun.operators import Grad, Div\n\nw = r * C.b_r + theta * C.b_z\ng = Grad(w)\ndisplay(g)\ndisplay(g.doit())", "code_hash": "ba194248230a87df16ef358769845def", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wlCL", "name": "_"}, {"code": "D = r * bv[0, 0] + z * bv[1, 2]\nq = Div(D)\ndisplay(q)\ndisplay(q.doit())", "code_hash": "3225d51f35c363b26bb06bd5c6cafbda", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kqZH", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Curvilinear equations\n\nLets consider the Laplace operator in curvilinear coordinates. For this we use a `ScalarFunction` and Jaxfun operators:\n\"\"\")", "code_hash": "26bdb3f73d6dfc73a244a56191bb420b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wAgl", "name": "_"}, {"code": "from jaxfun.galerkin.arguments import ScalarFunction\n\nu_ = ScalarFunction(name=\"u\", system=C)\nLu = Div(Grad(u_))\ndisplay(Lu)", "code_hash": "6be3d7142aa0dddb86394625b77babac", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe Laplace operator is displayed in Cartesian coordinates. When evaluated, we get the operator in cylinder coordinates:\n\"\"\")", "code_hash": "156bf6bae3e7bdc212405cf58e5f5d91", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dGlV", "name": "_"}, {"code": "display(Lu.doit())", "code_hash": "13f84c3bf706fa28c78a9706637fd706", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SdmI", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote the map from Cartesian function $u(x, y, z)$ for the generic (unevaluated) operator to computational $U(r, \\theta, z)$ in the evaluated domain.\n\nWe can also look at the gradient\n\"\"\")", "code_hash": "82bccd6ef57f3faa8adfceb901636e66", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lgWD", "name": "_"}, {"code": "display(Grad(u_))", "code_hash": "39fb97d982e17affa3c270983acae76e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yOPj", "name": "_"}, {"code": "display(Grad(u_).doit())", "code_hash": "854cc0a0d7d81b3253657b71d4d28656", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fwwy", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote the small difference here from most textbooks that present the gradient as (see, e.g., [wikipedia](https://en.wikipedia.org/wiki/Gradient))\n\n$$\n\\nabla u = \\frac{\\partial U}{\\partial r} \\hat{\\mathbf{b}}_r + \\frac{1}{r}\\frac{\\partial U}{\\partial \\theta} \\hat{\\mathbf{b}}_{\\theta} + \\frac{\\partial U}{\\partial z}\\hat{\\mathbf{b}}_z\n$$\n\nusing normalized (unit) basis vectors $\\hat{\\mathbf{b}}_r = {\\mathbf{b}}_r, \\hat{\\mathbf{b}}_{\\theta} = \\mathbf{b}_{\\theta} / r$ and $\\hat{\\mathbf{b}}_z = \\mathbf{b}_z$. Replacing the hat vectors above with the covariant basis vectors leads to the same result.\n\"\"\")", "code_hash": "be2e5ab71bc39731ea98281632e988eb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "LJZf", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe curl of a gradient should be zero. Lets verify:\n\"\"\")", "code_hash": "c9b8e8c6dec2a1589c72cc21abd8e084", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "urSm", "name": "_"}, {"code": "from jaxfun.operators import Curl\n\ndisplay(Curl(Grad(u_)))", "code_hash": "d3363ea01c77282a3782f20cd26edeef", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jxvo", "name": "_"}, {"code": "display(Curl(Grad(u_)).doit())", "code_hash": "4202f7361e6b80b87abf622e9df6e37a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mWxS", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Inner products\n\nThe weighted $L_{\\omega}^2(\\Omega^m)$ inner product is defined as\n\n$$\n(u(\\mathbf{x}), v(\\mathbf{x}))_{L_{\\omega}^2(\\Omega^m)} = \\int_{\\Omega^m}u(\\mathbf{x}) \\overline{v}(\\mathbf{x}) \\omega(\\mathbf{x}) d\\lambda^m \\tag{23}\n$$\n\nwhere as before $m$= 1, 2 or 3 represents a curve, surface or volume, and  $d\\lambda^m$ represents an infinitesimal line, surface or volume element. The overline on $\\overline{v}$ represents a complex conjugate.\n\nThe computational domain is a hypercube, with $\\mathbb{I}^2 = \\text{I}^0 \\times \\text{I}^1$ and $\\mathbb{I}^3 = \\text{I}^0 \\times \\text{I}^1 \\times \\text{I}^2$, where $\\text{I}^m$ is the interval used for computational dimension $m$. When computing the inner product, we first transform the integral to computational coordinates. We use the following mapped tensor product function approximations\n\n$$\nu(\\mathbf{x}) = U(X^0) = \\sum_{k=0}^{N-1} \\hat{u}_k \\phi_k(X^0),\n$$\n\n$$\nu(\\mathbf{x}) = U(X^0, X^1) = \\sum_{k=0}^{N_0-1}\\sum_{j=0}^{N_1-1} \\hat{u}_{kj} \\phi_k(X^0) \\psi_j(X^1),\n$$\n\n$$\nu(\\mathbf{x}) = U(X^0, X^1, X^2) = \\sum_{k=0}^{N_0-1}\\sum_{j=0}^{N_1-1} \\sum_{i=0}^{N_2-1}\\hat{u}_{kji} \\phi_k(X^0) \\psi_j(X^1) \\gamma_i(X^2),\n$$\n\nfor curves, surfaces or volumes.\n\nConsider a differential equation of the form\n\n\\begin{equation}\n    L u(\\mathbf{x}) = f(\\mathbf{x}), \\quad \\text{for } \\mathbf{x} \\in \\Omega^m, \\tag{24}\n\\end{equation}\n\nwhere $L$ is a linear operator, $f(\\mathbf{x}) \\in L^2_{\\omega}(\\Omega^m)$, and $u(\\mathbf{x}) \\in \\text{V}(\\Omega^m)$. The weighted variational forms obtained by multiplying the differential equation by a test function and integrating over the domain are\n\n\\begin{align}\n    a(u, v)_{{L_{\\omega}^2(\\Omega^m)}} \u0026= \\int_{\\Omega^m} L u(\\mathbf{x}) \\,\\overline{v}(\\mathbf{x}) \\, \\omega(\\mathbf{x}) \\, d\\lambda^m, \\tag{25} \\\\\n    (f, v)_{L_{\\omega}^2(\\Omega^m)} \u0026= \\int_{\\Omega^m} f(\\mathbf{x}) \\,\\overline{v}(\\mathbf{x}) \\, \\omega(\\mathbf{x}) \\, d\\lambda^m, \\tag{26}\n\\end{align}\n\nand the weighted Galerkin method is to find $u \\in \\text{V}(\\Omega^m)$ such that\n\n\\begin{equation}\n    a(u, v)_{L_{\\omega}^2(\\Omega^m)} = (f, v)_{L_{\\omega}^2(\\Omega^m)}, \\quad \\forall \\, v \\in \\text{V}(\\Omega^m). \\tag{27}\n\\end{equation}\n\nFor either curves, surfaces or volumes, the integrals are transformed to\n\n\\begin{align}\n    a(u, v)_{L_{\\omega}^2(\\Omega^m)} \u0026=  \\int_{\\mathbb{I}^m} {L} U \\, \\overline{V} \\, W \\, \\sqrt{g} d{X}, \\tag{28}\\\\\n    (f, v)_{L_{\\omega}^2(\\Omega^m)} \u0026= \\int_{\\mathbb{I}^m} F \\,\\overline{V} \\, W \\, \\sqrt{g} d{X}, \\tag{29}\n\\end{align}\n\nwhere $d{X}=\\prod_{i\\in \\mathcal{I}^m} dX^{i}$ and ${L}U$ is an operator transformed to computational space, like Eqs. (17). The computational weights $W(\\mathbf{X})$ are determined by the choice of basis functions. Note that the transformation makes use of $d\\lambda^m = \\sqrt{g}d{X}$ for all $m \\le n$.\n\nAn example solving Helmholtz equation on an annulus is given in the following  [notebook](https://spectraldns.github.io/jaxfun/annulus.html).\n\"\"\")", "code_hash": "e5a2da96b87d4dd5695b1f2ce8086fba", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "CcZR", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "YWSi", "name": "_"}], "metadata": {"marimo_version": "0.19.11"}, "version": "1"},
            "session": {"cells": [{"code_hash": "73cf3df9faa94c25d8de751fb289f38b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"curvilinear-coordinates-in-jaxfun\"\u003ECurvilinear coordinates in Jaxfun\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EJaxfun is developed to work with any curvilinear coordinate system and not just the regular Cartesian. A user should describe equations for a generic coordinate system using operators like \u003Ccode\u003Ediv\u003C/code\u003E, \u003Ccode\u003Egrad\u003C/code\u003E, \u003Ccode\u003Edot\u003C/code\u003E, \u003Ccode\u003Eouter\u003C/code\u003E, \u003Ccode\u003Ecross\u003C/code\u003E and \u003Ccode\u003Ecurl\u003C/code\u003E. The correct equations in curvilinear coordinates should then be automatically derived by Jaxfun under the hood. What goes on under the hood is described in more detail in this article.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThere is not really enough time or space to go through all details regarding curvilinear coordinates here, so the interested reader is referred to the excellent online textbook by Kelly, PA. Mechanics Lecture Notes: An introduction to Solid Mechanics.  Available from \u003Ca href=\"http://homepages.engineering.auckland.ac.nz/~pkel015/SolidMechanicsBooks/index.html\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ehere\u003C/a\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIn the following we will consider two coordinate systems, the Cartesian with coordinates\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{x} = \\{x^{i}\\}_{i\\in\\mathcal{I}^n},\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eand the computational, with coordinates\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{X} = \\{X^{i}\\}_{i\\in\\mathcal{I}^m}.\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EHere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathcal{I}^m||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathcal{I}^n||)\u003C/marimo-tex\u003E are two index sets for the number of computational coordinates, and the dimension of the physical space, respectively, and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m\\leq n||)\u003C/marimo-tex\u003E. Throughout this article an index set will be denoted as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathcal{I}^{N}=\\{0, 1, \\ldots, N-1\\}||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(N\\in \\mathbb{Z}^+||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe physical domain will be denoted as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\Omega^m \\subseteq \\mathbb{R}^n||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m=1,2||)\u003C/marimo-tex\u003E and 3 represents curves, surfaces and volumes, respectively. Likewise, the computational domain will be denoted as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{I}^m \\subseteq \\mathbb{R}^m||)\u003C/marimo-tex\u003E. The computational domain is a hypercube, with \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{I}^2 = \\text{I}^0 \\times \\text{I}^1||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{I}^3 = \\text{I}^0 \\times \\text{I}^1 \\times \\text{I}^2||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\text{I}^m||)\u003C/marimo-tex\u003E is the interval used for computational dimension \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m||)\u003C/marimo-tex\u003E. Hence, computations are always performed on hypercubes.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4b15a72329e9919142c761ef0f1ad4e0", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe coordinate curves \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X^{i}||)\u003C/marimo-tex\u003E are functions of the Cartesian coordinates\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n X^{i} = X^{i}(\\mathbf{x}), \\quad \\text{for } i \\in \\mathcal{I}^m, \\tag{3}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eand we get the Cartesian coordinates through the inverse maps\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\nx^i=x^i(\\mathbf{X}), \\quad \\text{for } i \\in \\mathcal{I}^n.\\tag{4}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EUsing these generic maps a function \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u : \\Omega^m \\rightarrow \\mathbb{K}||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{K}||)\u003C/marimo-tex\u003E may be either \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{R}||)\u003C/marimo-tex\u003E or \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{C}||)\u003C/marimo-tex\u003E, may now be transformed from physical to computational space through a change of variables as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\nu(\\mathbf{x}) = u(\\mathbf{x}(\\mathbf{X})) = U(\\mathbf{X}),\\tag{5}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EA simple and well known example is for polar coordinates, where the Cartesian coordinates \u003Cmarimo-tex class=\"arithmatex\"\u003E||(x||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(y||)\u003C/marimo-tex\u003E are mapped to the polar coordinates \u003Cmarimo-tex class=\"arithmatex\"\u003E||(r||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\theta||)\u003C/marimo-tex\u003E as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nx(r, \\theta) = r \\cos \\theta \\quad \\text{and} \\quad  y(r, \\theta) = r \\sin \\theta\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EA Cartesian function for a circle of radius one is \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u(x, y) = \\sqrt{x^2 + y^2} -1||)\u003C/marimo-tex\u003E. Inserting for the polar maps we get \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u(x(r, \\theta), y(r, \\theta)) = \\sqrt{(r \\cos \\theta)^2 + (r \\sin \\theta)^2} - 1 = r - 1 = U(r, \\theta)||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b4c1c463791a9a112b03b0788cf5b78d", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe transformation for any curvilinear coordinate system will be defined through the use of a position vector, which can be written as a function of the new coordinates\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{r}(\\mathbf{X}) = x^i(\\mathbf{X}) \\,\\mathbf{i}_i,\\tag{6}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere there is here, and throughout this article, summation implied by repeating indices. The Cartesian unit basis vectors are denoted as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{i}_i\\in\\mathbb{R}^n||)\u003C/marimo-tex\u003E for \u003Cmarimo-tex class=\"arithmatex\"\u003E||(i\\in \\mathcal{I}^n||)\u003C/marimo-tex\u003E. The position vector can describe any point in the physical domain \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\Omega^m||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "32d456cc4fb3f566e3c9cf09f71d418c", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EA curvilinear coordinate system can be described using two different sets of basis vectors, the co- or contravariant basis vectors.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe covariant basis vectors are defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{b}_i(\\mathbf{X}) = \\frac{\\partial \\mathbf{r}}{\\partial X^{i}}, \\quad \\text{for } i \\, \\in \\mathcal{I}^m,\\tag{8}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe covariant basis vectors \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}_i||)\u003C/marimo-tex\u003E are tangent to the \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m||)\u003C/marimo-tex\u003E coordinate curves \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X^i(\\mathbf{x})||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe contravariant basis vectors are defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{b}^{i}(\\mathbf{X}) =  \\mathbf{i}_j\\frac{\\partial X^{i}}{\\partial x^j}, \\quad \\text{for } i \\, \\in \\mathcal{I}^m.\\tag{9}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe contravariant basis vectors are orthogonal to the covariant basis vectors\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{b}^{i} \\cdot \\mathbf{b}_{j} = \\delta_{j}^{i}, \\quad \\text{for } i, j \\, \\in \\mathcal{I}^{m \\times m}.\\tag{10}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EAny vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v}(\\mathbf{X})||)\u003C/marimo-tex\u003E (boldface lower case letter) can be given with either co- or contravariant basis functions in the computational domain and we write them as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    \\mathbf{v} = {v}^{i} \\mathbf{b}_i = {v}_i \\mathbf{b}^{i},\\tag{11}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||({v}_{i}(\\mathbf{X})||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||({v}^{i}(\\mathbf{X})||)\u003C/marimo-tex\u003E are co- and contravariant vector components, respectively. The sub- or superscript of the coefficient are used to recognise which basis functions are used. The vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v}||)\u003C/marimo-tex\u003E can also be given in Cartesian basis vectors, but since both sub- and superscripts are taken, we must make use of an alternative notation that includes the Cartesian variables \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v}(\\mathbf{x}) = v^{i}(\\mathbf{x}) \\mathbf{i}_i||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWhen a vector is written with contravariant vector components \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v} = {v}^{i} \\mathbf{b}_i||)\u003C/marimo-tex\u003E, the vector is called a contravariant vector. This is the default used by Jaxfun. When the vector is written with covariant components \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v} = {v}_i \\mathbf{b}^{i}||)\u003C/marimo-tex\u003E it is called a covariant vector. This is a bit confusing since a contravariant vector is using covariant basis vectors and vice versa!\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f665154f375ab0bb75234227687c681f", "console": [], "id": "lEQa", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EIn Jaxfun we work by default in the covariant basis with contravariant vector components. However, we can obtain the covariant components \u003Cmarimo-tex class=\"arithmatex\"\u003E||({v}_{i}||)\u003C/marimo-tex\u003E as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n{v}_{i} = {v}^j \\mathbf{b}_j \\cdot \\mathbf{b}_i = {v}^j g_{ji}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe co- and contravariant metric tensors are defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{align}\ng_{ij}(\\mathbf{X}) \u0026amp;= \\mathbf{b}_i \\cdot \\mathbf{b}_j \\quad \\text{for } i, j \\in \\mathcal{I}^{m \\times m}, \\tag{12} \\\\\ng^{ij}(\\mathbf{X}) \u0026amp;= \\mathbf{b}^{i} \\cdot \\mathbf{b}^{j} \\quad \\text{for } i, j \\in \\mathcal{I}^{m \\times m}, \\tag{13}\n\\end{align}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Erespectively. Finally, the determinant of the covariant metric tensor is given as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    g(\\mathbf{X}) = \\det([g_{ij}]),\\tag{14}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||([g_{ij}]||)\u003C/marimo-tex\u003E represents the tensor with components \u003Cmarimo-tex class=\"arithmatex\"\u003E||(g_{ij}||)\u003C/marimo-tex\u003E.\nNote that if \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m=n||)\u003C/marimo-tex\u003E, then \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\sqrt{g}||)\u003C/marimo-tex\u003E is equal to the determinant of the Jacobian matrix. Also note that if the basis vectors are orthogonal, then \u003Cmarimo-tex class=\"arithmatex\"\u003E||([g_{ij}]||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||([g^{ij}]||)\u003C/marimo-tex\u003E are diagonal matrices and the co- and contravariant basis vectors  \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}_{i}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}^{i}||)\u003C/marimo-tex\u003E are parallel.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can get the contravariant basis vectors from the covariant and vice versa using\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\begin{align*}\n\\mathbf{b}^{i} \u0026amp;= g^{ij} \\mathbf{b}_{j} \\\\\n\\mathbf{b}_{i} \u0026amp;= g_{ij} \\mathbf{b}^{j}\n\\end{align*}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe metric tensors are available in Jaxfun using methods \u003Ccode\u003Eget_covariant_metric_tensor\u003C/code\u003E and \u003Ccode\u003Eget_contravariant_metric_tensor\u003C/code\u003E on the given curvilinear coordinate system.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6b6712e9bcb2857b8cd749595d134c85", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe vector dot product can be defined for curvilinear coordinates as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{u} \\cdot \\mathbf{v} = {u}^{i}\\mathbf{b}_i \\cdot {v}_j \\mathbf{b}^{j} = {u}^{i} {v}_i\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ebecause of Eq. (10).\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe dot product between two vectors both expressed in a covariant basis can be computed as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n{u}^{i}\\mathbf{b}_i \\cdot {v}^{j} \\mathbf{b}_{j} = {u}^{i} {v}^{j} g_{ij}\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c94c6fead69b7989d03bfb747847ac3f", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe illustrate first with a simple example. Consider a simple skewed coordinate system defined by \u003Cmarimo-tex class=\"arithmatex\"\u003E||(x(u, v) = u + v||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(y(u, v) = v||)\u003C/marimo-tex\u003E, with curvilinear coordinates \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u, v \\in [0, 2]\\times [0, 2]||)\u003C/marimo-tex\u003E, such that the position vector is\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{r}(u, v) = (u+v) \\mathbf{i} + v \\mathbf{j},\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{i}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{j}||)\u003C/marimo-tex\u003E are the Cartesian unit basis vectors. The coordinate curves are straight lines, but they are not orthogonal to each other. The covariant basis vectors are \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}_u = \\frac{\\partial \\mathbf{r}}{\\partial u} = \\mathbf{i}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}_v = \\frac{\\partial \\mathbf{r}}{ \\partial v} = \\mathbf{i} + \\mathbf{j}||)\u003C/marimo-tex\u003E, and the contravariant basis vectors are \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}^u = \\mathbf{i} - \\mathbf{j}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}^v = \\mathbf{j}||)\u003C/marimo-tex\u003E. The basis vectors are illustrated in the figure below. Note that the covariant base vectors align with the constant gridlines (the coordinate curves of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v||)\u003C/marimo-tex\u003E) and the contravariant base vectors are orthogonal to the gridlines. The contravariant vectors are as such the vectors that point orthogonally out from the physical domain \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\Omega||)\u003C/marimo-tex\u003E. That is, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}^{u}||)\u003C/marimo-tex\u003E points out of the domain below defined by the curveline drawn at constant \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v=2||)\u003C/marimo-tex\u003E, i.e., \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u = x - 2||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "04fff1599c4e9d7eae55d048f678989c", "console": [{"data": "{\"image/png\": \"data:image/png;base64,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54ltx92f9YkTJ1a7vTv/3XjjjW6tZ1fuuOMOez5//vOf3fqePXv22GMLCwuzdu3a5XK6jIwM68orr6x2/LGxsdZHH33k1rJnzJjh9v+D1157zf6+m2++2e3/b5X9f/niiy+sVq1aVfv9N9xwg5WdnV3l8zjx56ey/9/Dhw+3v6ewsNAaO3as28/jkUcecWudAibiUEkgiJXdC9WxY0clJSX5ZLn33nuvXn/9dUlSjx491KtXL9WrV08bN25UWFjNd/Tv2LFDF154ofbu3Wvfd+qpp9oXVvn111/122+/6b///a9iYmI89jxqqqioSFdeeaW+++47RUZG6pxzzlGnTp2Ul5enH3/8UTt37pQkzZ49W3/5y1/02muvVTqv7OxsDRo0SAsXLrTv69Spk3r37q2mTZsqIyNDCxcu1J49e5Sbm6u7775bmZmZ+utf/1phXmlpaRo0aJCOHTsmSapXr56SkpLUuXNnxcTEKDs7W9u3b9eqVauUmZnpkXVx4MAB5efnS5ISEhLUvXt3tWrVSjExMcrKytK6dev066+/yrIsrVq1Suedd55Wrlyp5s2bVztvT67n5cuXa/DgwcrKyrLvO+uss9SjRw8VFBRoyZIl2rJliyZOnKimTZvWca1UrrCwUCNGjNDPP/+s8PBwDRgwQJ06ddKxY8e0YMEC7d+/X5L0xRdfaOjQoZozZ44iIlz/CXc+/4iICHXv3l2nnHKKYmNjFR4ergMHDuiXX37R7t27ZVmW/vnPfyo/P1//+c9/XM7Ll9vOyy+/rMcff9z+ukWLFurbt69at24th8OhjIwMrV+/XuvWrVNxcXGdlnXTTTfZ28WHH36ol19+udL16TR9+nR7ucnJyWrbtm2Fafbt26cLLrhA69ats+879dRT1atXLzVs2FAHDhzQjz/+qEOHDunIkSO65ppr9M477+jGG2+sdLkvvPCCJkyYYO9Bdjgc6tmzp0499VQ1bNhQGRkZWrNmjTZs2CCpdM+c00UXXaSGDRtq/fr19kWmunbtqgsvvLDCck455ZQK933wwQe68cYb7ecdHh6uc889V507d1ZWVpZ+/PFHe4//e++9p23btun7779XVFRUletSkp577jn7/3enTp3Up08fxcTEaPv27apXr5493YQJEzR58mT767Zt26pPnz6Ki4tTSUmJDh06pLVr19rPHwhqfg5HAF7UsWNH+13I6667zmvLKbvHzfnuabt27awffvihwrR5eXn2bXffhb/wwgvt6Zo0aWJ98cUXFab56quvrKZNm1qSrHr16tnT+3KPm3MP0+DBgyu8G19YWGjdf//95fZ2VDY2y7KskSNH2tMmJia6HGNRUZH1n//8x15ueHi4tWjRogrTjR8/3p7XgAEDrN27d7tcZmFhoTV//nzrxhtvrHYvTHU+//xz66mnnrI2bdpU6TRbt261Bg0aZI/t1ltvrXRab6zn/Px8q1u3bva07dq1c7n+3nrrLat+/fpWZGRkhT0GdVH2OTnnfeaZZ1obN24sN11RUZH1j3/8o9yyn3zyyUrn+9BDD1kffvihdfToUZePl5SUWJ9//rkVFxdnz+/HH390Oa2ntp3qftYLCwutFi1a2NM89dRTVkFBgctlHTp0yHrjjTesZ555ppI14J6TTz7ZXp6r3yknOvPMM+3p33zzzQqPFxcXW8nJyfY0ffr0sX799dcK0+Xm5lqTJk2yHA6HJclq0KBBpXucZ82aZU8nybrgggustWvXupx269at1t/+9jcrNTW1wmMn7t11x+bNm62GDRuWez4n/jwXFxdbL7zwghUWFmZPd/fdd1c6z7LbcEREhNWkSRPr008/rTCd8+9Eenq6FRERYf9+S01NtUpKSlzOe8+ePdYrr7xiTZkyxa3nB5iIcAOCmPMPniT7UC9vKBtukqyYmBhrw4YN1X6fO+E2Z86cci/Cv//++0rn98MPP5R7kePrcHO+uK3sMMOSkhIrKSnJnvbpp5+u9Hk4p+nUqZN18ODBSp/ziWO45JJLKjzeu3dv+/GqQsofCgoKrJ49e1qSrKioKCsjI8PldN5Yz5MnT7aniYqKstatW1fpON99990Kh2TV1YnPqW3btlZ6enql0z/66KP2tA0aNKg0zNy1ZMkSe37XXHONy2k8te1U97O+Zs0a+/H+/fvXejk18dhjj7n9xta6devsaaOjo63MzMwK07z99tv2NH379q32MN2yv19uv/32Co8XFhZaJ510kj3NkCFDan0Ic23CreybR507d7aOHDlS6bQvvviiPW1YWFilIVp2ew8LC7MWLFhQ5Ri++OILe/q6HBoLBAsuTgIEqczMTPsDtCUpNja22u/56quvdNddd1X5LyMjo9r53HXXXUpMTKzL8G1Tpkyxb1911VVKTk6udNoBAwbo+uuv98hya+uf//xnpYdcnXiRgKVLl7qc7sUXX7Rvv/DCC2rRokWVyxw1apS6du0qSfrmm2906NChco+XPYQtLi6u6ifgY/Xq1bMPE8vLy9NPP/3k1vd5Yj2X3bbuvvtuex26cuONN+qcc85xa2y19fe//73KQ0UfffRRtW7dWlLpobTvv/9+nZZ39tlnq1u3bpJkH0Z3Il9tO/7YRm+66Sb79ueff24fDurKu+++a98ePny4GjVqVGGasj+3//3vfxUdHV3l8h966CH79/L7779f4SI9M2bM0Pbt2yVJDRo00Jtvvlnt4ZyecuTIEX3wwQf2188++6yaNGlS6fT33HOPffGqkpKScoc2Vuaqq67SeeedV+U0gfy7C/AHznEDgtSJL0IaNGhQ7fcsXbpU//73v6uc5v7771ezZs2qnOa6666rfoBuKnue3siRI6ud/uabb9Z7773nseXXxMknn6wzzzyzymnOOOMM+7bzRVlZRUVFmjt3riSpcePGGjJkiFvLTk5O1vr162VZlhYuXKhhw4bZj7Vr187+KIf//ve/evDBB92ap6ccOXJES5Ys0e+//65Dhw4pKyur3IvU9evX27dXrlypoUOHVjk/T6znY8eOadmyZfbX7m5bixYtqna62qhfv76uueaaaqe57rrr9NJLL0kq/dkYN25cld+zceNGLVu2TFu2bNHRo0eVn59f7mqbR48elSQdOnRIaWlpateuXbnv99W2U3a58+bN08aNGz325k9lTjnlFPXp00dLly5VTk6OPv3000q3g7K/U8oGn9PevXvtj13p3r27evXqVe3yo6Ki1K9fP3399dc6evSofvvtN/Xs2dN+fPbs2fbt66+/vto3cDxp0aJF9jmqLVq0qPZnMiwsTLfccovuu+8+SXLrKr/u/J0ou1188sknevjhhxUfH1/t9wHBinADgtSJ7wj76hLJ9erV89iHde/evVsHDx60v+7bt2+139O3b185HI4aX3LfE9x53mX3qLi6mMPq1avt/1f16tXTPffc49ayf/nlF/t2WlpauceuueYaff/995JK3+WfO3eubrzxRvuS896ya9cuPfTQQ/r444/tF4HVSU9Pr3YaT61nZzw2atSo0o+6KKtfv37VTlNbPXr0UMOGDd0agzPcVqxYUel0s2bN0t/+9rcqpzlRenp6hXDz1bbTrl079e3bV0uWLNHRo0fVu3dv/elPf9KIESPUv39/r1106KabbrL3yL777rsuw23hwoXatm2bpNK9PoMGDaowTdmPFMjNzdVdd93l1vK3bNli305LSysXbkuWLLFvV3WkgTeU3W769Onj1p6+/v37l/t+y7LKXfb/RL179652nn379lW7du2UlpamnTt36tRTT9Xo0aM1dOhQnX322YqMjKx2HkAwIdyAINW4cWNFRETYh0seOXKk2u+ZNGlShc8r2759uzp27Oj2cp2fr+MJZaMtJibGrXecGzdurCZNmrj1fD2tqkOJnMpeLa2wsLDC42U/k+3QoUPV7gF15cTPhxozZoxmz56tzz77TFLpYXHOQ+Pat2+vAQMGKDk5WcOHD/fYu/orVqzQhRdeWOPPqqrqcDUnT6znsttWu3btqnyB6dS+fftqp6ktd+dddrqyz6GsSZMmlbs6o7tcrXtfbjtTp07VBRdcoP379ysrK0uvvfaaXnvtNUVEROj000/Xeeedp0GDBunCCy9UeHh4nZbldN111+kvf/mLioqK9P3332vfvn1q1apVuWmmTZtWbnpXv9/K/txu27bNIz+3ziuJSqV7mX2p7LbVoUMHt76n7Gd4FhQU6NixY2rcuHGl07tz6GO9evX0zjvvaMiQIcrKylJ6erqee+45Pffcc4qKitJZZ52l8847T5deeqnOOecct36OAZNxjhsQxMq+yKvJh+3WRXXnddRE2Uu01+Qdd3cOC/UGT7xocB66Vhdlz22USi/h/cknn2jKlCnq3r17ucd27typadOmacyYMWrTpo3GjBnj1nmMVcnPz9eVV15pvxCNi4vTo48+qnnz5iktLU3Z2dkqKSmRVXqBLL355pv297rzYdyeWM+12ba8uV3VZgyuQmvu3Lnloq1fv36aPHmyVqxYofT0dOXl5dnr3bIsDRw40J7W1br35bbTvXt3rVq1SnfffXe5OC8qKtKyZcv04osvatCgQerQoUO58xProuwetOLi4grnDRYWFurDDz+0v/7Tn/7kcj7e+Lkt+//Xnb2xnlT258Pd7f7E6ap7E8bdvxUDBw7UqlWrNHLkyHLf4zwn9sknn9S5556rrl272m8wAMGKcAOC2IABA+zblV2gIZCVfbGSk5Pj9vf56rBQbyj74qdnz57lXmS7++/EvaZSaezceuut+v33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+HCtWrVKlmXpww8/1Icffqi4uDj17t1bLVq0UMOGDZWdna1du3Zp9erVFd7tTE5OLvfOra9MnTpV/fr10/79+3X48GFddtllOu2003TmmWfK4XBoxYoVWr16tSTpL3/5i2bMmOGXC1540uuvv669e/dqzpw5Kigo0F//+lf97//+r84++2y1b99e9evX15EjR7Rlyxb99ttv9gdcu/pQ29zcXE2ePFmTJ09Wo0aNdPrpp6tDhw5q0KCB0tPTtX79ev3+++/29HFxcS6vTOmulJQUnXfeefrhhx9kWZbuv/9+/fvf/9aZZ56pJk2aaNOmTVq0aJGKi4vVtm1b3XPPPXrggQdqvbzaql+/vt555x0lJycrOztbO3fuVN++fdWnTx+ddtppKigo0JIlS+zzDF955RWPXcnwRFdddZU2b96spUuXqmvXrhowYIA6deqkY8eO6YcfftDevXvtac8777xye3fKevTRR/XZZ58pNzdX27dvV9++fdWvXz8lJiaqoKBAixcvti90cdttt2njxo1V7pnz5bazZcsWTZgwQRMmTFD79u3Vs2dP+w2nffv2acmSJeU+buDGG2/UOeecU6tluXLTTTfp+eefl6Ryh5Rfdtllatq0abXfHx4erg8//FAXX3yxVqxYoczMTN1+++164IEH1K9fP7Vt21bh4eE6fPiwNmzYoHXr1tl70K688kqX8xwyZIieeuopPfTQQ5JKz3Xr3r27evXqpVNPPVUNGzZURkaGVq9erQ0bNkiS/QHtZbVq1UrnnHOOFi1apLy8PPXq1UuXXHKJWrdubR9i26lTJ91xxx3293Tq1ElTpkzRjTfeqOLiYi1evFhdunSxt82srCz9+OOP5fbg9e3bV88++2y166omVq1apT//+c+688471alTJ5122mlq0aKFCgsLtXfvXi1atKjcm1oPPfRQhQ+SB4KGBSBkZGdnW0899ZTVokULS5Jb/xwOhzVgwADrs88+q3S+27Zts6fv0KGD2+OZN2+e/X0DBw6sctrffvvNOuWUU6oc62233WYVFBRYHTp0sO/btm2by/kNHDjQnmbevHkup5k4caI9zcSJE11O8+abb9rT3HzzzdU+55qsq6KiIutvf/ubFRMT49b/q3r16ll33nlnhfk0bNjQ7f/fvXr1statW1ft86jOvn37rDPPPLPKZXXv3t36/fff3VqH3lzPCxYssFq1alXpOMPCwuz//2Xvr6sTn9Pu3butvn37VrnOLrvsMuvYsWNVzvezzz6rdpsZO3aslZeXV+3Pgae2nep+1j/66CPL4XC4tZywsDDrz3/+s1VQUFCb1V6l0047rcLyZsyYUaN55OTkWLfffrsVERHh1vOJjo62nnzyySrnOX36dKtly5ZuzW/y5Mku5/HLL79YjRo1qvT7Kvsd/MUXX7i17Ouvv97Kzs6u8nnU9Ofn+eefd3v7i4yMtB5//HG35guYij1uQAiJiYnRQw89pLvvvluzZ8/Wd999p59//lkHDhzQoUOHVFJSotjYWMXFxen0009XUlKShgwZUu6cJX859dRTtXr1ak2ePFkffPCB1q9fr5ycHLVu3VpJSUkaM2aMLr74Yn8P06PCw8P197//XXfffbfefvttffvtt/aVAAsLC9W4cWN16NBBPXr0UHJysi699NJyV+F0OnTokH744QctWLBAv/zyizZt2qT9+/crLy9PMTExSkhIUO/evXXllVdq2LBh5S5yUVstW7bUokWLNGXKFE2fPl2//fabcnJyFB8fry5duujaa6/VjTfeqJiYGL9/TMV5552ndevW6d///rc++eQTbdmyRYWFhWrTpo3OO+88jRs3Tn369PH6ONq0aaMFCxbo3Xff1bRp07R+/Xqlp6erefPmSkpK0ujRo3X55ZdXO5/hw4frt99+04svvqg5c+Zo586dioiIUJs2bdS/f3+NGjVK5513nltj8tW2c9VVV9l7mBcuXKhVq1Zp69atOnLkiCSpSZMmSkxM1LnnnquRI0dW+DBwT/nTn/5Ubm9mbGysLrvsshrNIzo6Wq+99poefPBBvfvuu/r++++1ceNG+3dskyZNdPLJJ6tXr1668MILdckll1Q47PVE1157rYYMGaK3335bX3/9tVatWqWDBw+quLhYTZs2VZcuXXTuuefqqquuKndOc1lnnXWWVq9erVdffVXz5s3T1q1blZWVVe0VI4cMGaLNmzfrjTfe0Jdffqnff/9d6enpio6OVps2bZScnKyRI0eWu7Kmp9x333268sorNXfuXC1atEhr1qzR9u3blZmZqbCwMMXGxqpbt2664IILNHLkSPucQCBYOSzL4OtmAwAAAEAI4OIkAAAAABDgCDcAAAAACHCEGwAAAAAEOMINAAAAAAIc4QYAAAAAAY5wAwAAAIAAR7gBAAAAQIAj3AAAAAAgwBFuAAAAABDgCDcAAAAACHCEGwAAAAAEOMINAAAAAAIc4QYAAAAAAS7C3wMIFnl5eVqzZo0kKS4uThERrFoAAAAgFBUVFengwYOSpB49eigqKqrO86QuPGTNmjXq06ePv4cBAAAAIIAsXbpUSUlJdZ4Ph0oCAAAAQIBjj5uHxMXF2beXLl2q1q1b+3E0AAAAAPxl79699tF4ZTuhLgg3Dyl7Tlvr1q2VkJDgx9EAAAAACASeuvYFh0oCAAAAQIAj3AAAAAAgwBFuAAAAABDgCDcAAAAACHCEGwAAAAAEOMINAAAAAAIc4QYAAAAAAY5wAwAAAIAAR7gBAAAAQIAj3AAAAAAgwEX4ewD4g2VZys7OVmZmpvLy8lRcXOzvIcGHwsLCFBkZqQYNGqhhw4aKjIz095AAAAAQIAi3AFFSUqKdO3cqNzfX30OBHxUUFCgrK0v79+9XXFycmjdvLofD4e9hAQAAwM8ItwBgWVaFaHM4HAoPD/fjqOBrxcXFsizL/vrgwYMqKChQmzZt/DgqAAAABALCLQBkZ2fb0RYeHq5WrVqpYcOGCgvjFMRQYlmW8vPzlZmZqUOHDkmSjh49qubNm6t+/fp+Hh0AAAD8iTIIAJmZmfbtVq1aqXHjxkRbCHI4HIqKilJ8fLzi4+Pt+w8fPuzHUQEAACAQUAcBIC8vT1LpC/eGDRv6eTQIBLGxsfbtnJwc/w0EAAAAAYFwCwDOq0eGh4ezpw2SSrcF5zmOXF0UAAAAVAIQoLiaJAAAAJwINwAAAAAIcIQbAAAAAAQ4wg0AAAAAAhzhBgAAAAABjnADAAAAgADn1XBbtmyZ/v73vyslJUUJCQmqX7++GjZsqMTERI0ePVo//fSTx5f5/vvvKyUlRa1atVJUVJQ6dOigm266SYsXL/b4sgAAAADAF7wWbuedd56SkpI0ceJEzZ07V7t371ZBQYGys7O1adMmpaamasCAAbr55ptVUFBQ5+Xl5ubqsssu0w033KC5c+dq//79ys/P186dOzVt2jSde+65evzxxz3wzBAMRo0aJYfDUe7f/Pnz/T0sAAAAwCWvhduePXskSW3atNE999yjjz/+WEuXLtXixYv14osvqm3btpKkt99+W6NGjarz8m655RZ99dVXkqTk5GR99tlnWrp0qaZOnapOnTqppKREkyZN0uTJk+u8LAAAAADwpQhvzbhr16568skndeWVVyo8PLzcY3379tWf/vQn9e/fXxs3btT777+v22+/Xeedd16tlvX9999r+vTpkqShQ4fq008/tZeZlJSkYcOGqXfv3tq5c6cefPBBXX311WratGndnqAfnfTQLH8PwWu2P32Zv4cAAAAABByv7XH78ssvdc0111SINqcWLVrohRdesL/++OOPa72s559/XpIUERGh//znPxWW2aJFCz3zzDOSpCNHjmjKlCm1XhYAAAAA+JpfryqZnJxs396yZUut5nHs2DF99913kqSLLrpICQkJLqe74oor1LhxY0nSp59+WqtlAQAAAIA/+DXc8vPz7duV7Zmrzi+//GJf3GTgwIGVThcZGam+ffva31NYWFir5QEAAACAr/k13BYsWGDf7tatW63msXbtWvt2165dq5zW+XhRUZE2bdpUo+Xs2rWryn979+6t+eARkD766COlpKQoPj5e0dHRSkxM1IQJE5Senu7voQEwQH5+vvbt26eSkhJ/D8Xrjh49qsOHD/t7GF5nWZb279+v3Nxcfw/F6woLC7Vnzx4VFxf7eyhel52drYMHD8qyLH8Pxassy1J6erqysrL8PRSvKykp0d69e4N2B43XLk5SnZKSEj399NP219dcc02t5rNr1y77dmWHSTq1a9fOvp2Wlqbu3bu7vZyy34vgVFhYqKuvvrrC+ZabNm3S888/r9TUVM2ePVu9e/f20wgBBLr8/Hzt2LFDUumh/GFhYXI4HH4elXeUlJTYcXro0CGFhfn1vWCvKi4ulmVZOnr0qMLDw4P2/6llWXawZWVlBfVzLbv9HjlypNZHfpnAuf1KUlhYWND+rJbdfo8dO6bIyEiddNJJ/h2Uh/kt3F566SUtXbpUUun5Z7V9MXzs2DH7dsOGDauctkGDBvbtUHjXATUzfvz4cntwT5Senq6UlBStWbNGbdq08eHIAJggPz+/3JuJZV9EBLuyL4KDXaj8P5VC57lalqWioiJ/D8Mn+Fk1m1/CbcGCBXrooYckSfHx8XrttddqPa+8vDz7dmRkZJXT1q9f375d08Md0tLSqnx879696tOnT43micCydu1aORwOpaSk6OSTT9batWvLHc4rSRkZGbr33nv1wQcf+GmUAAKRM9rKvlAI1r0VJ77wczgcQbu3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AACAAMceNwAAAAAIcIQbAAAAAAQ4wg0AAAAAAhzhBgAAAAABjnADAAAAgABHuAEAAABAgCPcAAAAACDAEW4AAAAAEOAINwAAAAAIcIQbAAAAAAQ4wi2A7dixQ/fdd5+6du2qBg0aqFmzZkpKStJzzz2nnJwcjy3n66+/1ogRI5SQkKD69esrISFBI0aM0Ndff+2xZQQib67f1NRUORwOt/6lpqZ65gkFgAMHDujLL7/UY489psGDB6tFixb28xw1apRXlvn+++8rJSVFrVq1UlRUlDp06KCbbrpJixcv9sry/MlX63fSpElub7/z58/32HL9bdmyZfr73/+ulJQU+/dhw4YNlZiYqNGjR+unn37y+DJDafv11foNxe03MzNT06dP13333aeBAweqc+fOatKkiSIjIxUfH6/zzz9fzz77rA4dOuSxZYbaawdfreNQff1QlQcffNArP7dG/v61EJA+//xzq3HjxpYkl/8SExOtTZs21WkZxcXF1q233lrpMiRZY8aMsYqLiz30rAKHt9fvm2++WeV6LfvvzTff9NwT87OqnufNN9/s0WXl5ORYl156aaXLCwsLsyZNmuTRZfqbr9bvxIkT3d5+582b57Hl+tOAAQPcer4jR4608vPz67y8UNt+fbl+Q3H7nTt3rlvPt0WLFtbs2bPrtKxQfe3gq3Ucqq8fKrNixQorIiLCoz+3Jv/+jRACzooVK3TttdcqNzdXDRs21MMPP6zk5GTl5uZq+vTp+r//+z9t3LhRl112mZYtW6ZGjRrVajmPPPKIpk6dKkk644wz9MADD6hTp07asmWLnn32Wa1YsUJTpkxRXFycnnzySU8+Rb/y1fp1+uabb9SmTZtKH09ISKjT/ANV+/bt1bVrV82ZM8cr87/lllv01VdfSZKSk5N1zz33qE2bNlqzZo2efPJJbdmyRZMmTVLr1q01duxYr4zBn7y9fp3WrFlT5eMdO3b06vJ9Zc+ePZKkNm3a6Oqrr9aAAQPUvn17FRcXa/HixXrhhRe0e/duvf322yosLNR7771Xp+WF2vbr6/XrFCrbryS1a9dOycnJ6t27t9q1a6fWrVurpKREu3bt0scff6xPPvlE6enpGjZsmJYuXapevXrVajmh+tpB8t06dgrV1w9OJSUlGjt2rIqKihQfH68DBw54ZL5G//71dzmiIuc7kxEREdaiRYsqPP7ss8/a7wpMnDixVsvYsGGD/Q7GWWedZeXk5JR7PDs72zrrrLPscdR1714g8cX6LfuO2bZt2+o2YIM89thj1hdffGHt27fPsizL2rZtm1f2CH333Xf2fIcOHWoVFRWVe/zgwYNW+/btLUlWbGyslZGR4bFl+5Ov1m/ZPRah4rLLLrM++OCDCtuS08GDB63ExER7vSxYsKDWywrF7deX6zcUt9/K1mtZn376qb1eRowYUavlhPJrB1+t41B9/eDKSy+9ZEmyunbtaj388MMe2eNm+u/f0PmtZoiff/7Z3qDGjRvncpri4mKrW7du9kZVUFBQ4+Xccccd9nIWL17scprFixfb0/z5z3+u8TICka/WL794S3krLAYPHmy/MEhLS3M5zfvvv28v+9lnn/XYsgMJ4eZbX3zxhb1e7r777lrPh+3XNU+tX7bfynXp0sU+nK82QvW1Q03UdR3z+qHUjh07rIYNG1qSrPnz55f7ua5LuJn++5eLkwSYzz77zL49evRol9OEhYVp5MiRkqQjR45o3rx5NVqGZVmaOXOmJKlr167q27evy+n69u2rLl26SJJmzpwpy7JqtJxA5Iv1C+86duyYvvvuO0nSRRddVOmhIldccYUaN24sSfr00099Nj4Er+TkZPv2li1bajUPtt/KeWL9omrOQ//z8vJq/L2h/NqhJuqyjvGHO++8U1lZWbr55ps1cOBAj8wzGH7/Em4BxnlVrQYNGqh3796VTld2I164cGGNlrFt2zb7fIPqfhicj+/evVvbt2+v0XICkS/WL7zrl19+UUFBgaSqt9/IyEj7hcUvv/yiwsJCn4wPwSs/P9++HR4eXqt5sP1WzhPrF5XbsGGDVq5cKak0vGoqlF87uKuu6xilPvzwQ3355Zdq1qyZnn/+eY/NNxh+/xJuAWbdunWSpM6dOysiovJrx5T9heD8HnetXbvW5Xw8vZxA5Iv1e6LRo0erTZs2ioyMVIsWLdS3b189+uij2r17d53mG6pqs/0WFRVp06ZNXh1XsEpJSVF8fHy5S14//fTTOnz4sL+H5nMLFiywb3fr1q1W82D7rZwn1u+JQn37zcnJ0aZNm/Tiiy9q4MCBKioqkiSNHz++xvMK5dcOVfHkOj5RKL5+OHLkiO655x5J0jPPPKMWLVp4bN7B8PuXcAsgeXl5Sk9Pl1T9lYKaNm2qBg0aSJLS0tJqtJxdu3bZt6tbTrt27ezbNV1OoPHV+j3R/PnztXfvXhUWFurQoUP6+eef9cQTT6hz5856/fXX6zTvUBSq26+/zJ07VwcPHlRhYaEOHjyoBQsW6OGHH9bJJ59sHzYVCkpKSvT000/bX19zzTW1mg/br2ueWr8nCsXtt+zngDVo0ECJiYm67777tH//fknSQw89pBtuuKHG82Xb/YO31vGJQvH1wwMPPKB9+/apf//+uvXWWz0672DYhvk4gABy7Ngx+3bDhg2rnb5BgwbKzs5WVlaW15bjjBdJNV5OoPHV+nU6+eSTdcUVV6hfv372L4CtW7dqxowZ+vjjj5WXl6fbb79dDocj8C43G8BCdfv1tR49eujyyy9Xnz591KZNGxUWFmrDhg2aNm2a5syZoyNHjujKK6/UF198ocGDB/t7uF730ksvaenSpZJKz3+o6lDrqrD9uuap9evE9lvR6aefrsmTJyspKalW38+2W726rmOnUH398OOPP2rKlCmKiIjQf//7XzkcDo/OPxi2YcItgJQ9kTUyMrLa6evXry9Jys3N9dpynMuozXICja/WrySNGDFCN998c4VfOklJSbr22mv15Zdf6oorrlBhYaHuvfdeDRs2TK1atarxckJRqG6/vjR+/HhNmjSpwv1nn322Ro4cqddff1233367iouLNWbMGG3ZskVRUVG+H6iPLFiwQA899JAkKT4+Xq+99lqt58X2W5En16/E9nv55ZfrrLPOklS63WzZskUffvihPv30U11//fX65z//qSFDhtR4vmy7f/DWOpZC9/VDQUGBxo4dK8uydO+99+q0007z+DKCYRvmUMkAUvYPh/Pkyao4T+SOjo722nLKnixe0+UEGl+tX0lq0qRJle8UDRkyRI899pik0uPjnR9miuqF6vbrS7GxsVU+Pm7cOPsQlj179mjGjBk+GJV//P777xoxYoSKiooUFRWljz76SPHx8bWeH9tveZ5evxLbb2xsrE477TSddtppSkpK0nXXXadPPvlEb7/9trZu3arhw4crNTW1xvNl2/2Dt9axFLqvH5588kmtX79e7du318SJE72yjGDYhgm3AOK8hKzk3m7Z7OxsSe4d9lfb5TiXUZvlBBpfrV93jR071v7lXPakfFQtVLffQDNu3Dj7drBuv9u2bVNKSooOHz6s8PBwTZ8+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\", \"__metadata__\": {\"image/png\": {\"width\": 439, \"height\": 276}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "404bc6a0b7ef563bff4bdede7b550358", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"cylindrical-coordinate-system\"\u003ECylindrical coordinate system\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EWe will illustrate further by creating an orthogonal cylindrical coordinate system, defined from the position vector\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{r}(r, \\theta, z) = r \\cos \\theta \\mathbf{i} + r \\sin \\theta \\mathbf{j} + z \\mathbf{k}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(r \\in [0, 1]||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\theta \\in (0, 2 \\pi]||)\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "48dbf284d383d2d206a71d4f0ba09a53", "console": [], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e061aebb428df85e2a9a646ebd7b190b", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote that the curvilinear coordinate system is created from only the forward map \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{x}(\\mathbf{X})||)\u003C/marimo-tex\u003E and we do not need to provide the reverse map \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{X}(\\mathbf{x})||)\u003C/marimo-tex\u003E, which for the cylinder coordinates would be\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nr = \\sqrt{x^2+y^2}, \\quad \\theta = \\tan^{-1}(y/x), \\quad z = z.\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThis is because Jaxfun is using the covariant basis vectors computed from the forward map, and the contravariant basis vector may then be computed simply from the \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}^i = g^{ij} \\mathbf{b}_j||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||([g^{ij}] = [g_{ij}]^{-1}||)\u003C/marimo-tex\u003E. So the reverse map is not explicitly used and as such it does not have to be provided by the user.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ENote that on the last line in the code section above we overwrite the sympy symbols \u003Ccode\u003Er\u003C/code\u003E, \u003Ccode\u003Etheta\u003C/code\u003E, \u003Ccode\u003Ez\u003C/code\u003E with objects of type \u003Ccode\u003EBaseScalar\u003C/code\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EAs a first example create two contravariant vectors and take the dot product:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "22ff783809549742ae47d7f5c1166056", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\left(4\\right)\\mathbf{b_{r}} + \\left(3\\right)\\mathbf{b_{\\theta}} + \\left(2\\right)\\mathbf{b_{z}}\\right) \\cdot \\mathbf{b_{r}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[4||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "ba6e83034f46b59382b1280821c1ce48", "console": [], "id": "Hstk", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote that \u003Ccode\u003EDot\u003C/code\u003E represents an unevaluated dot product. It is evaluated by calling \u003Ccode\u003Edoit()\u003C/code\u003E. Under the hood this invokes the \u003Ccode\u003Edot\u003C/code\u003E function. We could alternatively just use the \u003Ccode\u003Edot\u003C/code\u003Efunction:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2cd2b3194ebc043abafa12027ecea1fc", "console": [], "id": "nWHF", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[4||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "83ffc0ea07407270206af0f40ac59da3", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe covariant metric tensor is given for cylindrical coordinates as:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "99bd5fb4e88b4140a57c2fd49873a2c9", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "[[1 0 0]\n [0 r**2 0]\n [0 0 1]]\n", "type": "stream"}], "id": "ZHCJ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d4ab280ea56aa99802bec2aa7e2e2bd6", "console": [], "id": "ROlb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe metric tensor is diagonal since the cylindrical coordinates are orthogonal.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can also create vectors in Cartesian Coordinates and transform them into the curvilinear system. For example, the position vector in Cartesian coordinates is\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2a58b2ffd5216cc731e07afb2b1a44d3", "console": [], "id": "qnkX", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(x\\right)\\mathbf{{i}} + \\left(y\\right)\\mathbf{{j}} + \\left(z\\right)\\mathbf{{k}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "5269b2af5c6528beeb95d73d8c2c9aa3", "console": [], "id": "TqIu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ERunning \u003Ccode\u003Edoit\u003C/code\u003E on this vector transforms the components into computational coordinates, but does not change basis\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "7a93332ecf0dd4a7d9f64ddedbe823f2", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r \\cos{\\left(\\theta \\right)}\\right)\\mathbf{{i}} + \\left(r \\sin{\\left(\\theta \\right)}\\right)\\mathbf{{j}} + \\left(z\\right)\\mathbf{{k}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "0d718e2f5e49eb59dbea8af5820dbe1d", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe can get this vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{p}||)\u003C/marimo-tex\u003E as fully contravariant by computing\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\boldsymbol{p} = (\\boldsymbol{p} \\cdot \\boldsymbol{b}_r) \\boldsymbol{b}_r + (\\boldsymbol{p} \\cdot \\boldsymbol{b}_{\\theta}) \\boldsymbol{b}_{\\theta} + (\\boldsymbol{p} \\cdot \\boldsymbol{b}_{z}) \\boldsymbol{b}_{z} = r \\boldsymbol{b}_r + z \\mathbf{b}_z\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThis is called a projection of the vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{p}||)\u003C/marimo-tex\u003E onto the covariant cylinder basis. The projection can be computed with method \u003Ccode\u003Efrom_cartesian\u003C/code\u003E:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "371903daae1784b7c9be01c142c25f75", "console": [], "id": "ulZA", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r\\right)\\mathbf{b_{r}} + \\left(z\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "770a3358f702505b0541b1c30882745f", "console": [], "id": "ecfG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe can also go the other way and compute a Cartesian vector from a contravariant:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6238c5652aa6872d150813c2c5559406", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(- r \\sin{\\left(\\theta \\right)}\\right)\\mathbf{{i}} + \\left(r \\cos{\\left(\\theta \\right)}\\right)\\mathbf{{j}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "26d84db0b1bab8da0ffe8883dbdc5f53", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EAnd we can look at the contravariant basis vectors in terms of Cartesian coordinates\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3b4cbb00ac1c201f69a9d200616c4145", "console": [], "id": "aLJB", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Earray([(cos(theta))*R.i + (sin(theta))*R.j,\n       (-sin(theta)/r)*R.i + (cos(theta)/r)*R.j, R.k], dtype=object)\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "714bc9104b39e0ad61d1993f9b1edb05", "console": [], "id": "nHfw", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe point is that a vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v}||)\u003C/marimo-tex\u003E can be formulated using several different basis vectors and there may be advantages or disadvantages to all of them.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f0010654e6e5e5886cd1b1a02c1983b3", "console": [], "id": "xXTn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"cross-product\"\u003ECross product\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EThe cross product between two vectors can be obtained as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{u} \\times \\mathbf{v} = \\varepsilon_{ijk} \\sqrt{g} {u}^j {v}^k \\mathbf{b}^{i} = \\varepsilon_{ijk} \\sqrt{g} {u}^j {v}^k g^{il}\\mathbf{b}_l\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "fc7e18af96ea088734c3737b93366cdf", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{b_{r}} \\times \\mathbf{b_{\\theta}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "57e48423c727ecd3827edb3c9d46f3b6", "console": [], "id": "pHFh", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"dyadics\"\u003EDyadics\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThe tensor product (or outer product) of two vectors is written\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{A} = \\mathbf{u} \\otimes \\mathbf{v}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe second order tensor \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{A}||)\u003C/marimo-tex\u003E is called a dyad. There are four possible basis configurations for dyads\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\begin{align*}\n\\mathbf{b}^{i} \u0026amp;\\otimes \\mathbf{b}^{j} \\\\\n\\mathbf{b}^{i} \u0026amp;\\otimes \\mathbf{b}_{j} \\\\\n\\mathbf{b}_{i} \u0026amp;\\otimes \\mathbf{b}^{j} \\\\\n\\mathbf{b}_{i} \u0026amp;\\otimes \\mathbf{b}_{j} \\\\\n\\end{align*}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EIn Jaxfun we use the last one, with two covariant base vectors \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{b}_{i} \\otimes \\mathbf{b}_{j}||)\u003C/marimo-tex\u003E. In this case\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{A} = A^{ij} \\mathbf{b}_i \\otimes \\mathbf{b}_j.\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(A^{ij}||)\u003C/marimo-tex\u003E are called the contravariant components.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe outer product of two vectors is computed as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\mathbf{u} \\otimes \\mathbf{v} = {u}^{i} \\mathbf{b}_{i} \\otimes {v}^{j} \\mathbf{b}_{j} = {u}^{i} {v}^{j} \\mathbf{b}_{i} \\otimes \\mathbf{b}_{j}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EDyads are actually defined by how they contract with vectors\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\begin{align*}\n(\\mathbf{u} \\otimes \\mathbf{v}) \\cdot \\mathbf{w} \u0026amp;= (\\mathbf{v} \\cdot \\mathbf{w}) \\mathbf{u}\\\\\n\\mathbf{w} \\cdot (\\mathbf{u} \\otimes \\mathbf{v}) \u0026amp;= (\\mathbf{w} \\cdot \\mathbf{u}) \\mathbf{v}\n\\end{align*}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003ENote that some authors do not use a dot for the contraction of a dyad with a vector and would write instead \u003Cmarimo-tex class=\"arithmatex\"\u003E||((\\mathbf{u} \\otimes \\mathbf{v}) \\mathbf{w}||)\u003C/marimo-tex\u003E. Since we use the \u003Ccode\u003EDot/dot\u003C/code\u003E in Jaxfun to represent the contraction of both dyadics and vectors, we find it more appropriate to include the dot also for contraction of higher order tensors.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EA linear combination of dyads is called a dyadic. For example \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{A} = 2(\\mathbf{u} \\otimes \\mathbf{v}) + 3 (\\mathbf{w} \\otimes \\mathbf{z})||)\u003C/marimo-tex\u003E. Note that even though a dyad is a second order tensor, not all second order tensors are dyads. That is, we cannot always write the tensor \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{A}||)\u003C/marimo-tex\u003E as the tensor product of two vectors \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{u} \\otimes \\mathbf{v}||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe contraction of two dyads leads to a dyad\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n(\\mathbf{u} \\otimes \\mathbf{v}) \\cdot (\\mathbf{w} \\otimes \\mathbf{z}) = (\\mathbf{v} \\cdot \\mathbf{w}) (\\mathbf{u} \\otimes \\mathbf{z})\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003ELet create some dyadics in Jaxfun and illustrate. First, the 9 dyad base vectors can be obtained as\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "8090d28cc1bb329d348385752ee98a9f", "console": [], "id": "NCOB", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left( \\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{r}}\\right), \\  \\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{\\theta}}\\right), \\  \\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{z}}\\right), \\  \\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{r}}\\right), \\  \\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{\\theta}}\\right), \\  \\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right), \\  \\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{r}}\\right), \\  \\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{\\theta}}\\right), \\  \\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{z}}\\right)\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "265c094d8b7d0c2d132866789933c0b3", "console": [], "id": "aqbW", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(2\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(3\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(\\theta\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{z}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "c12514b2afbd4cbfddef68807f5dc30f", "console": [], "id": "TRpd", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EContract \u003Ccode\u003EA\u003C/code\u003E with \u003Ccode\u003EB\u003C/code\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "32b6c0273518e0424207cd82b241d1e6", "console": [], "id": "TXez", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\left(2\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(3\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right)\\right) \\cdot \\left(\\left(r\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(\\theta\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{z}}\\right)\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(2 r^{3}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(3 \\theta\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "71acd4cda0ab2d72d24e8f9da3e162f0", "console": [], "id": "dNNg", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"operators-in-curvilinear-coordinates\"\u003EOperators in curvilinear coordinates\u003C/h2\u003E\n\u003Ch3 id=\"vector-operations\"\u003EVector operations\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EThe gradient of a scalar field \u003Cmarimo-tex class=\"arithmatex\"\u003E||(f(\\mathbf{x}) (=F(\\mathbf{X}))||)\u003C/marimo-tex\u003E is termed \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\text{grad}(f)||)\u003C/marimo-tex\u003E and equals\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n\\text{grad}(f) = \\nabla f = \\frac{\\partial {F}}{\\partial X^{i}}\\,\\mathbf{b}^{i} = \\frac{\\partial {F}}{\\partial X^{i}} g^{ij} \\,\\mathbf{b}_{j}. \\tag{15}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003ENote that the computation in curvilinear coordinates is simply using a change of variables and the chain rule\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\nabla f = \\frac{\\partial f(\\mathbf{x})}{\\partial x_i} \\mathbf{i}_{i} = \\frac{\\partial F(\\mathbf{X})}{\\partial X^j} \\frac{\\partial X^j}{\\partial x_i} \\mathbf{i}_{i} = \\frac{\\partial F}{\\partial X^j} \\mathbf{b}^j.\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe divergence of a vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{v}||)\u003C/marimo-tex\u003E, in terms of its contravariant components, is given as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n\\text{div}(\\mathbf{v}) = \\nabla \\cdot \\mathbf{v} = \\frac{\\partial \\mathbf{v}}{\\partial X^j} \\cdot \\mathbf{b}^j = \\frac{1}{\\sqrt{g}} \\frac{\\partial {v}^{i} \\sqrt{g}}{\\partial X^{i}},\\tag{16}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eand the Laplacian of the scalar field \u003Cmarimo-tex class=\"arithmatex\"\u003E||(f||)\u003C/marimo-tex\u003E can be written as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n\\text{div}(\\text{grad}(f)) = \\nabla^2 f  = \\frac{1}{\\sqrt{g}}\\frac{\\partial}{\\partial X^{i}}\\left( g^{ij} \\sqrt{g} \\frac{\\partial {F}}{\\partial X^{j}}\\right). \\tag{17}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003ENote that \u003Cmarimo-tex class=\"arithmatex\"\u003E||(g^{ij}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\sqrt{g}||)\u003C/marimo-tex\u003E will act as variable coefficients when the operators are used in differential equations.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe curl of a vector is defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\text{curl}(\\mathbf{v}) = \\nabla \\times \\mathbf{v} = \\mathbf{b}^{j} \\times \\frac{\\partial \\mathbf{v}}{\\partial X^j} = \\frac{\\varepsilon_{ijk}}{\\sqrt{g}} \\frac{\\partial {v}_k}{\\partial X^j} \\mathbf{b}_i \\tag{18}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe partial derivative \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\frac{\\partial \\mathbf{v}}{\\partial X^j}||)\u003C/marimo-tex\u003E is implemented in Jaxfun as the \u003Ccode\u003Ediff\u003C/code\u003E operator working on vectors. The partial derivative can be computed as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\frac{\\partial \\mathbf{v}}{\\partial X^j} = \\left(\\frac{\\partial {v}^{i}}{\\partial X^j} + \\Gamma^{i}_{kj} {v}^k\\right) \\mathbf{b}_i \\tag{19}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\Gamma^{i}_{kj}||)\u003C/marimo-tex\u003E is the Christoffel symbol of the second kind\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\Gamma^{k}_{ji} = \\frac{\\partial \\mathbf{b}_{i}}{\\partial X^j} \\cdot \\mathbf{b}^k \\tag{20}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eavailable in Jaxfun as method \u003Ccode\u003Eget_christoffel_second\u003C/code\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe term \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\frac{\\partial {v}^{i}}{\\partial X^j} + \\Gamma^{i}_{kj} {v}^k||)\u003C/marimo-tex\u003E is called the covariant derivative of vector components.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe Christoffel symbol falls out of the last identity for the curl due to the symmetry \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\Gamma^{k}_{ji} = \\Gamma^k_{ij}||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2e9f5c8abf6a852b54d5a2d54366d489", "console": [], "id": "yCnT", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"tensor-operations\"\u003ETensor operations\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EThe gradient of a vector is a second order tensor\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\text{grad}(\\mathbf{v}) = \\frac{\\partial \\mathbf{v}}{\\partial X^j} \\otimes \\mathbf{b}^j \\tag{21}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003ENote that if \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E is interpreted as a vector, then this corresponds to \u003Cmarimo-tex class=\"arithmatex\"\u003E||((\\nabla \\otimes \\mathbf{v})^T||)\u003C/marimo-tex\u003E. However, in Jaxfun printing we interpret \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E as an operator and as such \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\text{grad}(\\mathbf{v})||)\u003C/marimo-tex\u003E is printed as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla \\mathbf{v}||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe divergence of a second order tensor \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbf{A}||)\u003C/marimo-tex\u003E is\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\text{div}(\\mathbf{A}) = \\frac{\\partial \\mathbf{A}}{\\partial X^j} \\cdot \\mathbf{b}^j \\tag{22}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EAgain, if \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E is interpreted as a vector, then \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\text{div}(\\mathbf{A}) = \\nabla \\cdot \\mathbf{A}^T||)\u003C/marimo-tex\u003E. But in Jaxfun's printing \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E is an operator acting over the last axis of its input tensor. Hence the divergence of a tensor is printed as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla \\cdot \\mathbf{A}||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ba194248230a87df16ef358769845def", "console": [], "id": "wlCL", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\displaystyle \\nabla \\left(\\left(r\\right)\\mathbf{b_{r}} + \\left(\\theta\\right)\\mathbf{b_{z}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{r}}\\right) + \\left(\\frac{1}{r^{2}}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{\\theta}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "3225d51f35c363b26bb06bd5c6cafbda", "console": [], "id": "kqZH", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\nabla\\cdot \\left(\\left(r\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{r}}\\right) + \\left(z\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right)\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{b_{r}} + \\mathbf{b_{\\theta}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "26bdb3f73d6dfc73a244a56191bb420b", "console": [], "id": "wAgl", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"curvilinear-equations\"\u003ECurvilinear equations\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ELets consider the Laplace operator in curvilinear coordinates. For this we use a \u003Ccode\u003EScalarFunction\u003C/code\u003E and Jaxfun operators:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6be3d7142aa0dddb86394625b77babac", "console": [], "id": "rEll", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\nabla\\cdot \\displaystyle \\nabla \\left(u(x, y, z)\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "156bf6bae3e7bdc212405cf58e5f5d91", "console": [], "id": "dGlV", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe Laplace operator is displayed in Cartesian coordinates. When evaluated, we get the operator in cylinder coordinates:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "13f84c3bf706fa28c78a9706637fd706", "console": [], "id": "SdmI", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\frac{\\partial^{2}}{\\partial r^{2}} U{\\left(r,\\theta,z \\right)} + \\frac{\\partial^{2}}{\\partial z^{2}} U{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial r} U{\\left(r,\\theta,z \\right)}}{r} + \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} U{\\left(r,\\theta,z \\right)}}{r^{2}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "82bccd6ef57f3faa8adfceb901636e66", "console": [], "id": "lgWD", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote the map from Cartesian function \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u(x, y, z)||)\u003C/marimo-tex\u003E for the generic (unevaluated) operator to computational \u003Cmarimo-tex class=\"arithmatex\"\u003E||(U(r, \\theta, z)||)\u003C/marimo-tex\u003E in the evaluated domain.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can also look at the gradient\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "39fb97d982e17affa3c270983acae76e", "console": [], "id": "yOPj", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\displaystyle \\nabla \\left(u(x, y, z)\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "854cc0a0d7d81b3253657b71d4d28656", "console": [], "id": "fwwy", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\frac{\\partial}{\\partial r} U{\\left(r,\\theta,z \\right)}\\right)\\mathbf{b_{r}} + \\left(\\frac{\\frac{\\partial}{\\partial \\theta} U{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\mathbf{b_{\\theta}} + \\left(\\frac{\\partial}{\\partial z} U{\\left(r,\\theta,z \\right)}\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "be2e5ab71bc39731ea98281632e988eb", "console": [], "id": "LJZf", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote the small difference here from most textbooks that present the gradient as (see, e.g., \u003Ca href=\"https://en.wikipedia.org/wiki/Gradient\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ewikipedia\u003C/a\u003E)\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\nabla u = \\frac{\\partial U}{\\partial r} \\hat{\\mathbf{b}}_r + \\frac{1}{r}\\frac{\\partial U}{\\partial \\theta} \\hat{\\mathbf{b}}_{\\theta} + \\frac{\\partial U}{\\partial z}\\hat{\\mathbf{b}}_z\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eusing normalized (unit) basis vectors \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\hat{\\mathbf{b}}_r = {\\mathbf{b}}_r, \\hat{\\mathbf{b}}_{\\theta} = \\mathbf{b}_{\\theta} / r||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\hat{\\mathbf{b}}_z = \\mathbf{b}_z||)\u003C/marimo-tex\u003E. Replacing the hat vectors above with the covariant basis vectors leads to the same result.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c9b8e8c6dec2a1589c72cc21abd8e084", "console": [], "id": "urSm", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe curl of a gradient should be zero. Lets verify:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d3363ea01c77282a3782f20cd26edeef", "console": [], "id": "jxvo", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\nabla\\times \\displaystyle \\nabla \\left(u(x, y, z)\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "4202f7361e6b80b87abf622e9df6e37a", "console": [], "id": "mWxS", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{\\hat{0}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "e5a2da96b87d4dd5695b1f2ce8086fba", "console": [], "id": "CcZR", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"inner-products\"\u003EInner products\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThe weighted \u003Cmarimo-tex class=\"arithmatex\"\u003E||(L_{\\omega}^2(\\Omega^m)||)\u003C/marimo-tex\u003E inner product is defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n(u(\\mathbf{x}), v(\\mathbf{x}))_{L_{\\omega}^2(\\Omega^m)} = \\int_{\\Omega^m}u(\\mathbf{x}) \\overline{v}(\\mathbf{x}) \\omega(\\mathbf{x}) d\\lambda^m \\tag{23}\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere as before \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m||)\u003C/marimo-tex\u003E= 1, 2 or 3 represents a curve, surface or volume, and  \u003Cmarimo-tex class=\"arithmatex\"\u003E||(d\\lambda^m||)\u003C/marimo-tex\u003E represents an infinitesimal line, surface or volume element. The overline on \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\overline{v}||)\u003C/marimo-tex\u003E represents a complex conjugate.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe computational domain is a hypercube, with \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{I}^2 = \\text{I}^0 \\times \\text{I}^1||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mathbb{I}^3 = \\text{I}^0 \\times \\text{I}^1 \\times \\text{I}^2||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\text{I}^m||)\u003C/marimo-tex\u003E is the interval used for computational dimension \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m||)\u003C/marimo-tex\u003E. When computing the inner product, we first transform the integral to computational coordinates. We use the following mapped tensor product function approximations\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nu(\\mathbf{x}) = U(X^0) = \\sum_{k=0}^{N-1} \\hat{u}_k \\phi_k(X^0),\n||]\u003C/marimo-tex\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nu(\\mathbf{x}) = U(X^0, X^1) = \\sum_{k=0}^{N_0-1}\\sum_{j=0}^{N_1-1} \\hat{u}_{kj} \\phi_k(X^0) \\psi_j(X^1),\n||]\u003C/marimo-tex\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nu(\\mathbf{x}) = U(X^0, X^1, X^2) = \\sum_{k=0}^{N_0-1}\\sum_{j=0}^{N_1-1} \\sum_{i=0}^{N_2-1}\\hat{u}_{kji} \\phi_k(X^0) \\psi_j(X^1) \\gamma_i(X^2),\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Efor curves, surfaces or volumes.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EConsider a differential equation of the form\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    L u(\\mathbf{x}) = f(\\mathbf{x}), \\quad \\text{for } \\mathbf{x} \\in \\Omega^m, \\tag{24}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(L||)\u003C/marimo-tex\u003E is a linear operator, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(f(\\mathbf{x}) \\in L^2_{\\omega}(\\Omega^m)||)\u003C/marimo-tex\u003E, and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u(\\mathbf{x}) \\in \\text{V}(\\Omega^m)||)\u003C/marimo-tex\u003E. The weighted variational forms obtained by multiplying the differential equation by a test function and integrating over the domain are\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{align}\n    a(u, v)_{{L_{\\omega}^2(\\Omega^m)}} \u0026amp;= \\int_{\\Omega^m} L u(\\mathbf{x}) \\,\\overline{v}(\\mathbf{x}) \\, \\omega(\\mathbf{x}) \\, d\\lambda^m, \\tag{25} \\\\\n    (f, v)_{L_{\\omega}^2(\\Omega^m)} \u0026amp;= \\int_{\\Omega^m} f(\\mathbf{x}) \\,\\overline{v}(\\mathbf{x}) \\, \\omega(\\mathbf{x}) \\, d\\lambda^m, \\tag{26}\n\\end{align}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eand the weighted Galerkin method is to find \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u \\in \\text{V}(\\Omega^m)||)\u003C/marimo-tex\u003E such that\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n    a(u, v)_{L_{\\omega}^2(\\Omega^m)} = (f, v)_{L_{\\omega}^2(\\Omega^m)}, \\quad \\forall \\, v \\in \\text{V}(\\Omega^m). \\tag{27}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EFor either curves, surfaces or volumes, the integrals are transformed to\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{align}\n    a(u, v)_{L_{\\omega}^2(\\Omega^m)} \u0026amp;=  \\int_{\\mathbb{I}^m} {L} U \\, \\overline{V} \\, W \\, \\sqrt{g} d{X}, \\tag{28}\\\\\n    (f, v)_{L_{\\omega}^2(\\Omega^m)} \u0026amp;= \\int_{\\mathbb{I}^m} F \\,\\overline{V} \\, W \\, \\sqrt{g} d{X}, \\tag{29}\n\\end{align}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(d{X}=\\prod_{i\\in \\mathcal{I}^m} dX^{i}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||({L}U||)\u003C/marimo-tex\u003E is an operator transformed to computational space, like Eqs. (17). The computational weights \u003Cmarimo-tex class=\"arithmatex\"\u003E||(W(\\mathbf{X})||)\u003C/marimo-tex\u003E are determined by the choice of basis functions. Note that the transformation makes use of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(d\\lambda^m = \\sqrt{g}d{X}||)\u003C/marimo-tex\u003E for all \u003Cmarimo-tex class=\"arithmatex\"\u003E||(m \\le n||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EAn example solving Helmholtz equation on an annulus is given in the following  \u003Ca href=\"https://spectraldns.github.io/jaxfun/annulus.html\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Enotebook\u003C/a\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "YWSi", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.11"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.11%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Curvilinear%20coordinates%20in%20Jaxfun%0A%0A%20%20%20%20Jaxfun%20is%20developed%20to%20work%20with%20any%20curvilinear%20coordinate%20system%20and%20not%20just%20the%20regular%20Cartesian.%20A%20user%20should%20describe%20equations%20for%20a%20generic%20coordinate%20system%20using%20operators%20like%20%60div%60%2C%20%60grad%60%2C%20%60dot%60%2C%20%60outer%60%2C%20%60cross%60%20and%20%60curl%60.%20The%20correct%20equations%20in%20curvilinear%20coordinates%20should%20then%20be%20automatically%20derived%20by%20Jaxfun%20under%20the%20hood.%20What%20goes%20on%20under%20the%20hood%20is%20described%20in%20more%20detail%20in%20this%20article.%0A%0A%20%20%20%20There%20is%20not%20really%20enough%20time%20or%20space%20to%20go%20through%20all%20details%20regarding%20curvilinear%20coordinates%20here%2C%20so%20the%20interested%20reader%20is%20referred%20to%20the%20excellent%20online%20textbook%20by%20Kelly%2C%20PA.%20Mechanics%20Lecture%20Notes%3A%20An%20introduction%20to%20Solid%20Mechanics.%20%20Available%20from%20%5Bhere%5D(http%3A%2F%2Fhomepages.engineering.auckland.ac.nz%2F~pkel015%2FSolidMechanicsBooks%2Findex.html)%0A%0A%20%20%20%20In%20the%20following%20we%20will%20consider%20two%20coordinate%20systems%2C%20the%20Cartesian%20with%20coordinates%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7Bx%7D%20%3D%20%5C%7Bx%5E%7Bi%7D%5C%7D_%7Bi%5Cin%5Cmathcal%7BI%7D%5En%7D%2C%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20and%20the%20computational%2C%20with%20coordinates%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7BX%7D%20%3D%20%5C%7BX%5E%7Bi%7D%5C%7D_%7Bi%5Cin%5Cmathcal%7BI%7D%5Em%7D.%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20Here%20%24%5Cmathcal%7BI%7D%5Em%24%20and%20%24%5Cmathcal%7BI%7D%5En%24%20are%20two%20index%20sets%20for%20the%20number%20of%20computational%20coordinates%2C%20and%20the%20dimension%20of%20the%20physical%20space%2C%20respectively%2C%20and%20%24m%5Cleq%20n%24.%20Throughout%20this%20article%20an%20index%20set%20will%20be%20denoted%20as%20%24%5Cmathcal%7BI%7D%5E%7BN%7D%3D%5C%7B0%2C%201%2C%20%5Cldots%2C%20N-1%5C%7D%24%2C%20where%20%24N%5Cin%20%5Cmathbb%7BZ%7D%5E%2B%24.%0A%0A%20%20%20%20The%20physical%20domain%20will%20be%20denoted%20as%20%24%5COmega%5Em%20%5Csubseteq%20%5Cmathbb%7BR%7D%5En%24%2C%20where%20%24m%3D1%2C2%24%20and%203%20represents%20curves%2C%20surfaces%20and%20volumes%2C%20respectively.%20Likewise%2C%20the%20computational%20domain%20will%20be%20denoted%20as%20%24%5Cmathbb%7BI%7D%5Em%20%5Csubseteq%20%5Cmathbb%7BR%7D%5Em%24.%20The%20computational%20domain%20is%20a%20hypercube%2C%20with%20%24%5Cmathbb%7BI%7D%5E2%20%3D%20%5Ctext%7BI%7D%5E0%20%5Ctimes%20%5Ctext%7BI%7D%5E1%24%20and%20%24%5Cmathbb%7BI%7D%5E3%20%3D%20%5Ctext%7BI%7D%5E0%20%5Ctimes%20%5Ctext%7BI%7D%5E1%20%5Ctimes%20%5Ctext%7BI%7D%5E2%24%2C%20where%20%24%5Ctext%7BI%7D%5Em%24%20is%20the%20interval%20used%20for%20computational%20dimension%20%24m%24.%20Hence%2C%20computations%20are%20always%20performed%20on%20hypercubes.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20coordinate%20curves%20%24X%5E%7Bi%7D%24%20are%20functions%20of%20the%20Cartesian%20coordinates%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20X%5E%7Bi%7D%20%3D%20X%5E%7Bi%7D(%5Cmathbf%7Bx%7D)%2C%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%20%5Cin%20%5Cmathcal%7BI%7D%5Em%2C%20%5Ctag%7B3%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20and%20we%20get%20the%20Cartesian%20coordinates%20through%20the%20inverse%20maps%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20x%5Ei%3Dx%5Ei(%5Cmathbf%7BX%7D)%2C%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%20%5Cin%20%5Cmathcal%7BI%7D%5En.%5Ctag%7B4%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20Using%20these%20generic%20maps%20a%20function%20%24u%20%3A%20%5COmega%5Em%20%5Crightarrow%20%5Cmathbb%7BK%7D%24%2C%20where%20%24%5Cmathbb%7BK%7D%24%20may%20be%20either%20%24%5Cmathbb%7BR%7D%24%20or%20%24%5Cmathbb%7BC%7D%24%2C%20may%20now%20be%20transformed%20from%20physical%20to%20computational%20space%20through%20a%20change%20of%20variables%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20u(%5Cmathbf%7Bx%7D)%20%3D%20u(%5Cmathbf%7Bx%7D(%5Cmathbf%7BX%7D))%20%3D%20U(%5Cmathbf%7BX%7D)%2C%5Ctag%7B5%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20A%20simple%20and%20well%20known%20example%20is%20for%20polar%20coordinates%2C%20where%20the%20Cartesian%20coordinates%20%24x%24%20and%20%24y%24%20are%20mapped%20to%20the%20polar%20coordinates%20%24r%24%20and%20%24%5Ctheta%24%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20x(r%2C%20%5Ctheta)%20%3D%20r%20%5Ccos%20%5Ctheta%20%5Cquad%20%5Ctext%7Band%7D%20%5Cquad%20%20y(r%2C%20%5Ctheta)%20%3D%20r%20%5Csin%20%5Ctheta%0A%20%20%20%20%24%24%0A%0A%20%20%20%20A%20Cartesian%20function%20for%20a%20circle%20of%20radius%20one%20is%20%24u(x%2C%20y)%20%3D%20%5Csqrt%7Bx%5E2%20%2B%20y%5E2%7D%20-1%24.%20Inserting%20for%20the%20polar%20maps%20we%20get%20%24u(x(r%2C%20%5Ctheta)%2C%20y(r%2C%20%5Ctheta))%20%3D%20%5Csqrt%7B(r%20%5Ccos%20%5Ctheta)%5E2%20%2B%20(r%20%5Csin%20%5Ctheta)%5E2%7D%20-%201%20%3D%20r%20-%201%20%3D%20U(r%2C%20%5Ctheta)%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20transformation%20for%20any%20curvilinear%20coordinate%20system%20will%20be%20defined%20through%20the%20use%20of%20a%20position%20vector%2C%20which%20can%20be%20written%20as%20a%20function%20of%20the%20new%20coordinates%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7Br%7D(%5Cmathbf%7BX%7D)%20%3D%20x%5Ei(%5Cmathbf%7BX%7D)%20%5C%2C%5Cmathbf%7Bi%7D_i%2C%5Ctag%7B6%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20where%20there%20is%20here%2C%20and%20throughout%20this%20article%2C%20summation%20implied%20by%20repeating%20indices.%20The%20Cartesian%20unit%20basis%20vectors%20are%20denoted%20as%20%24%5Cmathbf%7Bi%7D_i%5Cin%5Cmathbb%7BR%7D%5En%24%20for%20%24i%5Cin%20%5Cmathcal%7BI%7D%5En%24.%20The%20position%20vector%20can%20describe%20any%20point%20in%20the%20physical%20domain%20%24%5COmega%5Em%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20A%20curvilinear%20coordinate%20system%20can%20be%20described%20using%20two%20different%20sets%20of%20basis%20vectors%2C%20the%20co-%20or%20contravariant%20basis%20vectors.%0A%0A%20%20%20%20The%20covariant%20basis%20vectors%20are%20defined%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7Bb%7D_i(%5Cmathbf%7BX%7D)%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Br%7D%7D%7B%5Cpartial%20X%5E%7Bi%7D%7D%2C%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%20%5C%2C%20%5Cin%20%5Cmathcal%7BI%7D%5Em%2C%5Ctag%7B8%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20The%20covariant%20basis%20vectors%20%24%5Cmathbf%7Bb%7D_i%24%20are%20tangent%20to%20the%20%24m%24%20coordinate%20curves%20%24X%5Ei(%5Cmathbf%7Bx%7D)%24.%0A%0A%20%20%20%20The%20contravariant%20basis%20vectors%20are%20defined%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7Bb%7D%5E%7Bi%7D(%5Cmathbf%7BX%7D)%20%3D%20%20%5Cmathbf%7Bi%7D_j%5Cfrac%7B%5Cpartial%20X%5E%7Bi%7D%7D%7B%5Cpartial%20x%5Ej%7D%2C%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%20%5C%2C%20%5Cin%20%5Cmathcal%7BI%7D%5Em.%5Ctag%7B9%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20The%20contravariant%20basis%20vectors%20are%20orthogonal%20to%20the%20covariant%20basis%20vectors%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%5Ccdot%20%5Cmathbf%7Bb%7D_%7Bj%7D%20%3D%20%5Cdelta_%7Bj%7D%5E%7Bi%7D%2C%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%2C%20j%20%5C%2C%20%5Cin%20%5Cmathcal%7BI%7D%5E%7Bm%20%5Ctimes%20m%7D.%5Ctag%7B10%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20Any%20vector%20%24%5Cmathbf%7Bv%7D(%5Cmathbf%7BX%7D)%24%20(boldface%20lower%20case%20letter)%20can%20be%20given%20with%20either%20co-%20or%20contravariant%20basis%20functions%20in%20the%20computational%20domain%20and%20we%20write%20them%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20%5Cmathbf%7Bv%7D%20%3D%20%7Bv%7D%5E%7Bi%7D%20%5Cmathbf%7Bb%7D_i%20%3D%20%7Bv%7D_i%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%2C%5Ctag%7B11%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20where%20%24%7Bv%7D_%7Bi%7D(%5Cmathbf%7BX%7D)%24%20and%20%24%7Bv%7D%5E%7Bi%7D(%5Cmathbf%7BX%7D)%24%20are%20co-%20and%20contravariant%20vector%20components%2C%20respectively.%20The%20sub-%20or%20superscript%20of%20the%20coefficient%20are%20used%20to%20recognise%20which%20basis%20functions%20are%20used.%20The%20vector%20%24%5Cmathbf%7Bv%7D%24%20can%20also%20be%20given%20in%20Cartesian%20basis%20vectors%2C%20but%20since%20both%20sub-%20and%20superscripts%20are%20taken%2C%20we%20must%20make%20use%20of%20an%20alternative%20notation%20that%20includes%20the%20Cartesian%20variables%20%24%5Cmathbf%7Bv%7D(%5Cmathbf%7Bx%7D)%20%3D%20v%5E%7Bi%7D(%5Cmathbf%7Bx%7D)%20%5Cmathbf%7Bi%7D_i%24.%0A%0A%20%20%20%20When%20a%20vector%20is%20written%20with%20contravariant%20vector%20components%20%24%5Cmathbf%7Bv%7D%20%3D%20%7Bv%7D%5E%7Bi%7D%20%5Cmathbf%7Bb%7D_i%24%2C%20the%20vector%20is%20called%20a%20contravariant%20vector.%20This%20is%20the%20default%20used%20by%20Jaxfun.%20When%20the%20vector%20is%20written%20with%20covariant%20components%20%24%5Cmathbf%7Bv%7D%20%3D%20%7Bv%7D_i%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%24%20it%20is%20called%20a%20covariant%20vector.%20This%20is%20a%20bit%20confusing%20since%20a%20contravariant%20vector%20is%20using%20covariant%20basis%20vectors%20and%20vice%20versa!%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20In%20Jaxfun%20we%20work%20by%20default%20in%20the%20covariant%20basis%20with%20contravariant%20vector%20components.%20However%2C%20we%20can%20obtain%20the%20covariant%20components%20%24%7Bv%7D_%7Bi%7D%24%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%7Bv%7D_%7Bi%7D%20%3D%20%7Bv%7D%5Ej%20%5Cmathbf%7Bb%7D_j%20%5Ccdot%20%5Cmathbf%7Bb%7D_i%20%3D%20%7Bv%7D%5Ej%20g_%7Bji%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20co-%20and%20contravariant%20metric%20tensors%20are%20defined%20as%0A%0A%20%20%20%20%5Cbegin%7Balign%7D%0A%20%20%20%20g_%7Bij%7D(%5Cmathbf%7BX%7D)%20%26%3D%20%5Cmathbf%7Bb%7D_i%20%5Ccdot%20%5Cmathbf%7Bb%7D_j%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%2C%20j%20%5Cin%20%5Cmathcal%7BI%7D%5E%7Bm%20%5Ctimes%20m%7D%2C%20%5Ctag%7B12%7D%20%5C%5C%0A%20%20%20%20g%5E%7Bij%7D(%5Cmathbf%7BX%7D)%20%26%3D%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%5Ccdot%20%5Cmathbf%7Bb%7D%5E%7Bj%7D%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%2C%20j%20%5Cin%20%5Cmathcal%7BI%7D%5E%7Bm%20%5Ctimes%20m%7D%2C%20%5Ctag%7B13%7D%0A%20%20%20%20%5Cend%7Balign%7D%0A%0A%20%20%20%20respectively.%20Finally%2C%20the%20determinant%20of%20the%20covariant%20metric%20tensor%20is%20given%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20g(%5Cmathbf%7BX%7D)%20%3D%20%5Cdet(%5Bg_%7Bij%7D%5D)%2C%5Ctag%7B14%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20where%20%24%5Bg_%7Bij%7D%5D%24%20represents%20the%20tensor%20with%20components%20%24g_%7Bij%7D%24.%0A%20%20%20%20Note%20that%20if%20%24m%3Dn%24%2C%20then%20%24%5Csqrt%7Bg%7D%24%20is%20equal%20to%20the%20determinant%20of%20the%20Jacobian%20matrix.%20Also%20note%20that%20if%20the%20basis%20vectors%20are%20orthogonal%2C%20then%20%24%5Bg_%7Bij%7D%5D%24%20and%20%24%5Bg%5E%7Bij%7D%5D%24%20are%20diagonal%20matrices%20and%20the%20co-%20and%20contravariant%20basis%20vectors%20%20%24%5Cmathbf%7Bb%7D_%7Bi%7D%24%20and%20%24%5Cmathbf%7Bb%7D%5E%7Bi%7D%24%20are%20parallel.%0A%0A%20%20%20%20We%20can%20get%20the%20contravariant%20basis%20vectors%20from%20the%20covariant%20and%20vice%20versa%20using%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%26%3D%20g%5E%7Bij%7D%20%5Cmathbf%7Bb%7D_%7Bj%7D%20%5C%5C%0A%20%20%20%20%5Cmathbf%7Bb%7D_%7Bi%7D%20%26%3D%20g_%7Bij%7D%20%5Cmathbf%7Bb%7D%5E%7Bj%7D%0A%20%20%20%20%5Cend%7Balign*%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20metric%20tensors%20are%20available%20in%20Jaxfun%20using%20methods%20%60get_covariant_metric_tensor%60%20and%20%60get_contravariant_metric_tensor%60%20on%20the%20given%20curvilinear%20coordinate%20system.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20vector%20dot%20product%20can%20be%20defined%20for%20curvilinear%20coordinates%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7Bu%7D%20%5Ccdot%20%5Cmathbf%7Bv%7D%20%3D%20%7Bu%7D%5E%7Bi%7D%5Cmathbf%7Bb%7D_i%20%5Ccdot%20%7Bv%7D_j%20%5Cmathbf%7Bb%7D%5E%7Bj%7D%20%3D%20%7Bu%7D%5E%7Bi%7D%20%7Bv%7D_i%0A%20%20%20%20%24%24%0A%0A%20%20%20%20because%20of%20Eq.%20(10).%0A%0A%20%20%20%20The%20dot%20product%20between%20two%20vectors%20both%20expressed%20in%20a%20covariant%20basis%20can%20be%20computed%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%7Bu%7D%5E%7Bi%7D%5Cmathbf%7Bb%7D_i%20%5Ccdot%20%7Bv%7D%5E%7Bj%7D%20%5Cmathbf%7Bb%7D_%7Bj%7D%20%3D%20%7Bu%7D%5E%7Bi%7D%20%7Bv%7D%5E%7Bj%7D%20g_%7Bij%7D%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20illustrate%20first%20with%20a%20simple%20example.%20Consider%20a%20simple%20skewed%20coordinate%20system%20defined%20by%20%24x(u%2C%20v)%20%3D%20u%20%2B%20v%24%20and%20%24y(u%2C%20v)%20%3D%20v%24%2C%20with%20curvilinear%20coordinates%20%24u%2C%20v%20%5Cin%20%5B0%2C%202%5D%5Ctimes%20%5B0%2C%202%5D%24%2C%20such%20that%20the%20position%20vector%20is%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7Br%7D(u%2C%20v)%20%3D%20(u%2Bv)%20%5Cmathbf%7Bi%7D%20%2B%20v%20%5Cmathbf%7Bj%7D%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24%5Cmathbf%7Bi%7D%24%20and%20%24%5Cmathbf%7Bj%7D%24%20are%20the%20Cartesian%20unit%20basis%20vectors.%20The%20coordinate%20curves%20are%20straight%20lines%2C%20but%20they%20are%20not%20orthogonal%20to%20each%20other.%20The%20covariant%20basis%20vectors%20are%20%24%5Cmathbf%7Bb%7D_u%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Br%7D%7D%7B%5Cpartial%20u%7D%20%3D%20%5Cmathbf%7Bi%7D%24%20and%20%24%5Cmathbf%7Bb%7D_v%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Br%7D%7D%7B%20%5Cpartial%20v%7D%20%3D%20%5Cmathbf%7Bi%7D%20%2B%20%5Cmathbf%7Bj%7D%24%2C%20and%20the%20contravariant%20basis%20vectors%20are%20%24%5Cmathbf%7Bb%7D%5Eu%20%3D%20%5Cmathbf%7Bi%7D%20-%20%5Cmathbf%7Bj%7D%24%20and%20%24%5Cmathbf%7Bb%7D%5Ev%20%3D%20%5Cmathbf%7Bj%7D%24.%20The%20basis%20vectors%20are%20illustrated%20in%20the%20figure%20below.%20Note%20that%20the%20covariant%20base%20vectors%20align%20with%20the%20constant%20gridlines%20(the%20coordinate%20curves%20of%20%24u%24%20and%20%24v%24)%20and%20the%20contravariant%20base%20vectors%20are%20orthogonal%20to%20the%20gridlines.%20The%20contravariant%20vectors%20are%20as%20such%20the%20vectors%20that%20point%20orthogonally%20out%20from%20the%20physical%20domain%20%24%5COmega%24.%20That%20is%2C%20%24%5Cmathbf%7Bb%7D%5E%7Bu%7D%24%20points%20out%20of%20the%20domain%20below%20defined%20by%20the%20curveline%20drawn%20at%20constant%20%24v%3D2%24%2C%20i.e.%2C%20%24u%20%3D%20x%20-%202%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(get_CoordSys%2C%20np%2C%20sp)%3A%0A%20%20%20%20from%20jaxfun.utils%20import%20lambdify%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%0A%20%20%20%20def%20plot()%3A%0A%20%20%20%20%20%20%20%20u%2C%20v%20%3D%20sp.symbols(%22u%2C%20v%22%2C%20real%3DTrue%2C%20positive%3DTrue)%0A%20%20%20%20%20%20%20%20P%20%3D%20get_CoordSys(%22P%22%2C%20sp.Lambda((u%2C%20v)%2C%20(u%20%2B%20v%2C%20v)))%0A%20%20%20%20%20%20%20%20u%2C%20v%20%3D%20P.base_scalars()%0A%20%20%20%20%20%20%20%20rv%20%3D%20P.position_vector(False)%0A%20%20%20%20%20%20%20%20assert%20isinstance(rv%2C%20sp.Tuple)%0A%0A%20%20%20%20%20%20%20%20b%20%3D%20P.get_covariant_basis()%0A%20%20%20%20%20%20%20%20bt%20%3D%20P.get_contravariant_basis()%0A%0A%20%20%20%20%20%20%20%20r0%20%3D%202.0%0A%20%20%20%20%20%20%20%20t0%20%3D%201.0%0A%20%20%20%20%20%20%20%20pos%20%3D%20np.array(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5Blambdify((u%2C%20v)%2C%20rv%5B0%5D)(r0%2C%20t0)%2C%20lambdify((u%2C%20v)%2C%20rv%5B1%5D)(r0%2C%20t0)%5D%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20b_num%20%3D%20np.array(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%5Blambdify((u%2C%20v)%2C%20b%5Bi%2C%20j%5D)(r0%2C%20t0)%20for%20j%20in%20range(2)%5D%20for%20i%20in%20range(2)%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dtype%3Dfloat%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20bt_num%20%3D%20np.array(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%5Blambdify((u%2C%20v)%2C%20bt%5Bi%2C%20j%5D)(r0%2C%20t0)%20for%20j%20in%20range(2)%5D%20for%20i%20in%20range(2)%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dtype%3Dfloat%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig%2C%20ax%20%3D%20plt.subplots(figsize%3D(5%2C%205))%0A%20%20%20%20%20%20%20%20ax.set_aspect(%22equal%22)%0A%20%20%20%20%20%20%20%20ax.set_title(%22Gridlines%20and%20basis%20vectors%22)%0A%0A%20%20%20%20%20%20%20%20u_grid%20%3D%20np.linspace(0.0%2C%202.0%2C%207)%0A%20%20%20%20%20%20%20%20v_grid%20%3D%20np.linspace(0.0%2C%202.0%2C%207)%0A%20%20%20%20%20%20%20%20v_line%20%3D%20np.linspace(0.0%2C%202.0%2C%20100)%0A%20%20%20%20%20%20%20%20u_line%20%3D%20np.linspace(0.0%2C%202.0%2C%20100)%0A%0A%20%20%20%20%20%20%20%20for%20u0%20in%20u_grid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20x_line%20%3D%20lambdify((u%2C%20v)%2C%20rv%5B0%5D)(u0%2C%20v_line)%0A%20%20%20%20%20%20%20%20%20%20%20%20y_line%20%3D%20lambdify((u%2C%20v)%2C%20rv%5B1%5D)(u0%2C%20v_line)%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.plot(x_line%2C%20y_line%2C%20color%3D%220.85%22%2C%20linewidth%3D1)%0A%0A%20%20%20%20%20%20%20%20for%20v0%20in%20v_grid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20x_line%20%3D%20np.atleast_1d(lambdify((u%2C%20v)%2C%20rv%5B0%5D)(u_line%2C%20v0))%0A%20%20%20%20%20%20%20%20%20%20%20%20y_line%20%3D%20np.atleast_1d(lambdify((u%2C%20v)%2C%20rv%5B1%5D)(u_line%2C%20v0))%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20y_line.shape%5B0%5D%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y_line%20%3D%20np.full_like(x_line%2C%20y_line.item())%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.plot(x_line%2C%20y_line%2C%20color%3D%220.85%22%2C%20linewidth%3D1)%0A%0A%20%20%20%20%20%20%20%20ax.quiver(%0A%20%20%20%20%20%20%20%20%20%20%20%20*pos%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20*b_num%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22tab%3Ablue%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20angles%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale_units%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr%22%24%5Cmathbf%7Bb%7D_u%24%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20ax.quiver(%0A%20%20%20%20%20%20%20%20%20%20%20%20*pos%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20*b_num%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22tab%3Ablue%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20angles%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale_units%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3D0.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr%22%24%5Cmathbf%7Bb%7D_v%24%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20ax.quiver(%0A%20%20%20%20%20%20%20%20%20%20%20%20*pos%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20*bt_num%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22tab%3Aorange%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20angles%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale_units%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr%22%24%5Cmathbf%7Bb%7D%5Eu%24%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20ax.quiver(%0A%20%20%20%20%20%20%20%20%20%20%20%20*pos%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20*bt_num%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22tab%3Aorange%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20angles%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale_units%3D%22xy%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3D0.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr%22%24%5Cmathbf%7Bb%7D%5Ev%24%22%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20ax.set_xlim(-0.2%2C%204.2)%0A%20%20%20%20%20%20%20%20ax.set_ylim(-0.2%2C%202.2)%0A%20%20%20%20%20%20%20%20ax.legend(loc%3D%22upper%20left%22)%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20plot()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Cylindrical%20coordinate%20system%0A%0A%20%20%20%20We%20will%20illustrate%20further%20by%20creating%20an%20orthogonal%20cylindrical%20coordinate%20system%2C%20defined%20from%20the%20position%20vector%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7Br%7D(r%2C%20%5Ctheta%2C%20z)%20%3D%20r%20%5Ccos%20%5Ctheta%20%5Cmathbf%7Bi%7D%20%2B%20r%20%5Csin%20%5Ctheta%20%5Cmathbf%7Bj%7D%20%2B%20z%20%5Cmathbf%7Bk%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24r%20%5Cin%20%5B0%2C%201%5D%24%20and%20%24%5Ctheta%20%5Cin%20(0%2C%202%20%5Cpi%5D%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20IPython.display%20import%20display%0A%20%20%20%20from%20jaxfun.operators%20import%20Dot%2C%20dot%0A%20%20%20%20from%20jaxfun.coordinates%20import%20get_CoordSys%0A%20%20%20%20import%20sympy%20as%20sp%0A%0A%20%20%20%20r%2C%20theta%2C%20z%20%3D%20sp.symbols(%22r%2Ctheta%2Cz%22%2C%20real%3DTrue%2C%20positive%3DTrue)%0A%20%20%20%20C%20%3D%20get_CoordSys(%0A%20%20%20%20%20%20%20%20%22C%22%2C%20sp.Lambda((r%2C%20theta%2C%20z)%2C%20(r%20*%20sp.cos(theta)%2C%20r%20*%20sp.sin(theta)%2C%20z))%0A%20%20%20%20)%0A%20%20%20%20r%2C%20theta%2C%20z%20%3D%20C.base_scalars()%0A%20%20%20%20return%20C%2C%20Dot%2C%20display%2C%20dot%2C%20get_CoordSys%2C%20r%2C%20sp%2C%20theta%2C%20z%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20that%20the%20curvilinear%20coordinate%20system%20is%20created%20from%20only%20the%20forward%20map%20%24%5Cmathbf%7Bx%7D(%5Cmathbf%7BX%7D)%24%20and%20we%20do%20not%20need%20to%20provide%20the%20reverse%20map%20%24%5Cmathbf%7BX%7D(%5Cmathbf%7Bx%7D)%24%2C%20which%20for%20the%20cylinder%20coordinates%20would%20be%0A%0A%20%20%20%20%24%24%0A%20%20%20%20r%20%3D%20%5Csqrt%7Bx%5E2%2By%5E2%7D%2C%20%5Cquad%20%5Ctheta%20%3D%20%5Ctan%5E%7B-1%7D(y%2Fx)%2C%20%5Cquad%20z%20%3D%20z.%0A%20%20%20%20%24%24%0A%0A%20%20%20%20This%20is%20because%20Jaxfun%20is%20using%20the%20covariant%20basis%20vectors%20computed%20from%20the%20forward%20map%2C%20and%20the%20contravariant%20basis%20vector%20may%20then%20be%20computed%20simply%20from%20the%20%24%5Cmathbf%7Bb%7D%5Ei%20%3D%20g%5E%7Bij%7D%20%5Cmathbf%7Bb%7D_j%24%2C%20where%20%24%5Bg%5E%7Bij%7D%5D%20%3D%20%5Bg_%7Bij%7D%5D%5E%7B-1%7D%24.%20So%20the%20reverse%20map%20is%20not%20explicitly%20used%20and%20as%20such%20it%20does%20not%20have%20to%20be%20provided%20by%20the%20user.%0A%0A%20%20%20%20Note%20that%20on%20the%20last%20line%20in%20the%20code%20section%20above%20we%20overwrite%20the%20sympy%20symbols%20%60r%60%2C%20%60theta%60%2C%20%60z%60%20with%20objects%20of%20type%20%60BaseScalar%60.%0A%0A%20%20%20%20As%20a%20first%20example%20create%20two%20contravariant%20vectors%20and%20take%20the%20dot%20product%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Dot%2C%20display)%3A%0A%20%20%20%20u%20%3D%204%20*%20C.b_r%20%2B%203%20*%20C.b_theta%20%2B%202%20*%20C.b_z%0A%20%20%20%20v%20%3D%20C.b_r%0A%20%20%20%20d%20%3D%20Dot(u%2C%20v)%0A%20%20%20%20display(d)%0A%20%20%20%20display(d.doit())%0A%20%20%20%20return%20u%2C%20v%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20that%20%60Dot%60%20represents%20an%20unevaluated%20dot%20product.%20It%20is%20evaluated%20by%20calling%20%60doit()%60.%20Under%20the%20hood%20this%20invokes%20the%20%60dot%60%20function.%20We%20could%20alternatively%20just%20use%20the%20%60dot%60function%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(dot%2C%20u%2C%20v)%3A%0A%20%20%20%20dot(u%2C%20v)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20covariant%20metric%20tensor%20is%20given%20for%20cylindrical%20coordinates%20as%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C)%3A%0A%20%20%20%20print(C.get_covariant_metric_tensor())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20metric%20tensor%20is%20diagonal%20since%20the%20cylindrical%20coordinates%20are%20orthogonal.%0A%0A%20%20%20%20We%20can%20also%20create%20vectors%20in%20Cartesian%20Coordinates%20and%20transform%20them%20into%20the%20curvilinear%20system.%20For%20example%2C%20the%20position%20vector%20in%20Cartesian%20coordinates%20is%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20display)%3A%0A%20%20%20%20R%20%3D%20C._parent%20%20%23%20The%20Cartesian%20coordinate%20system%0A%20%20%20%20p%20%3D%20R.x%20*%20R.i%20%2B%20R.y%20*%20R.j%20%2B%20R.z%20*%20R.k%0A%20%20%20%20display(p)%0A%20%20%20%20return%20(p%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Running%20%60doit%60%20on%20this%20vector%20transforms%20the%20components%20into%20computational%20coordinates%2C%20but%20does%20not%20change%20basis%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(display%2C%20p)%3A%0A%20%20%20%20display(p.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20can%20get%20this%20vector%20%24%5Cmathbf%7Bp%7D%24%20as%20fully%20contravariant%20by%20computing%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cboldsymbol%7Bp%7D%20%3D%20(%5Cboldsymbol%7Bp%7D%20%5Ccdot%20%5Cboldsymbol%7Bb%7D_r)%20%5Cboldsymbol%7Bb%7D_r%20%2B%20(%5Cboldsymbol%7Bp%7D%20%5Ccdot%20%5Cboldsymbol%7Bb%7D_%7B%5Ctheta%7D)%20%5Cboldsymbol%7Bb%7D_%7B%5Ctheta%7D%20%2B%20(%5Cboldsymbol%7Bp%7D%20%5Ccdot%20%5Cboldsymbol%7Bb%7D_%7Bz%7D)%20%5Cboldsymbol%7Bb%7D_%7Bz%7D%20%3D%20r%20%5Cboldsymbol%7Bb%7D_r%20%2B%20z%20%5Cmathbf%7Bb%7D_z%0A%20%20%20%20%24%24%0A%0A%20%20%20%20This%20is%20called%20a%20projection%20of%20the%20vector%20%24%5Cboldsymbol%7Bp%7D%24%20onto%20the%20covariant%20cylinder%20basis.%20The%20projection%20can%20be%20computed%20with%20method%20%60from_cartesian%60%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20display%2C%20p)%3A%0A%20%20%20%20display(C.from_cartesian(p))%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20can%20also%20go%20the%20other%20way%20and%20compute%20a%20Cartesian%20vector%20from%20a%20contravariant%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C)%3A%0A%20%20%20%20C.to_cartesian(C.b_theta)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20And%20we%20can%20look%20at%20the%20contravariant%20basis%20vectors%20in%20terms%20of%20Cartesian%20coordinates%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C)%3A%0A%20%20%20%20C.get_contravariant_basis(True)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20point%20is%20that%20a%20vector%20%24%5Cmathbf%7Bv%7D%24%20can%20be%20formulated%20using%20several%20different%20basis%20vectors%20and%20there%20may%20be%20advantages%20or%20disadvantages%20to%20all%20of%20them.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Cross%20product%0A%0A%20%20%20%20The%20cross%20product%20between%20two%20vectors%20can%20be%20obtained%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7Bu%7D%20%5Ctimes%20%5Cmathbf%7Bv%7D%20%3D%20%5Cvarepsilon_%7Bijk%7D%20%5Csqrt%7Bg%7D%20%7Bu%7D%5Ej%20%7Bv%7D%5Ek%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%3D%20%5Cvarepsilon_%7Bijk%7D%20%5Csqrt%7Bg%7D%20%7Bu%7D%5Ej%20%7Bv%7D%5Ek%20g%5E%7Bil%7D%5Cmathbf%7Bb%7D_l%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20display)%3A%0A%20%20%20%20from%20jaxfun.operators%20import%20Cross%0A%0A%20%20%20%20cr%20%3D%20Cross(C.b_r%2C%20C.b_theta)%0A%20%20%20%20display(cr)%0A%20%20%20%20display(cr.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Dyadics%0A%0A%20%20%20%20The%20tensor%20product%20(or%20outer%20product)%20of%20two%20vectors%20is%20written%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7BA%7D%20%3D%20%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20second%20order%20tensor%20%24%5Cmathbf%7BA%7D%24%20is%20called%20a%20dyad.%20There%20are%20four%20possible%20basis%20configurations%20for%20dyads%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%26%5Cotimes%20%5Cmathbf%7Bb%7D%5E%7Bj%7D%20%5C%5C%0A%20%20%20%20%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%26%5Cotimes%20%5Cmathbf%7Bb%7D_%7Bj%7D%20%5C%5C%0A%20%20%20%20%5Cmathbf%7Bb%7D_%7Bi%7D%20%26%5Cotimes%20%5Cmathbf%7Bb%7D%5E%7Bj%7D%20%5C%5C%0A%20%20%20%20%5Cmathbf%7Bb%7D_%7Bi%7D%20%26%5Cotimes%20%5Cmathbf%7Bb%7D_%7Bj%7D%20%5C%5C%0A%20%20%20%20%5Cend%7Balign*%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20In%20Jaxfun%20we%20use%20the%20last%20one%2C%20with%20two%20covariant%20base%20vectors%20%24%5Cmathbf%7Bb%7D_%7Bi%7D%20%5Cotimes%20%5Cmathbf%7Bb%7D_%7Bj%7D%24.%20In%20this%20case%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7BA%7D%20%3D%20A%5E%7Bij%7D%20%5Cmathbf%7Bb%7D_i%20%5Cotimes%20%5Cmathbf%7Bb%7D_j.%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24A%5E%7Bij%7D%24%20are%20called%20the%20contravariant%20components.%0A%0A%20%20%20%20The%20outer%20product%20of%20two%20vectors%20is%20computed%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D%20%3D%20%7Bu%7D%5E%7Bi%7D%20%5Cmathbf%7Bb%7D_%7Bi%7D%20%5Cotimes%20%7Bv%7D%5E%7Bj%7D%20%5Cmathbf%7Bb%7D_%7Bj%7D%20%3D%20%7Bu%7D%5E%7Bi%7D%20%7Bv%7D%5E%7Bj%7D%20%5Cmathbf%7Bb%7D_%7Bi%7D%20%5Cotimes%20%5Cmathbf%7Bb%7D_%7Bj%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20Dyads%20are%20actually%20defined%20by%20how%20they%20contract%20with%20vectors%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cbegin%7Balign*%7D%0A%20%20%20%20(%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D)%20%5Ccdot%20%5Cmathbf%7Bw%7D%20%26%3D%20(%5Cmathbf%7Bv%7D%20%5Ccdot%20%5Cmathbf%7Bw%7D)%20%5Cmathbf%7Bu%7D%5C%5C%0A%20%20%20%20%5Cmathbf%7Bw%7D%20%5Ccdot%20(%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D)%20%26%3D%20(%5Cmathbf%7Bw%7D%20%5Ccdot%20%5Cmathbf%7Bu%7D)%20%5Cmathbf%7Bv%7D%0A%20%20%20%20%5Cend%7Balign*%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20Note%20that%20some%20authors%20do%20not%20use%20a%20dot%20for%20the%20contraction%20of%20a%20dyad%20with%20a%20vector%20and%20would%20write%20instead%20%24(%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D)%20%5Cmathbf%7Bw%7D%24.%20Since%20we%20use%20the%20%60Dot%2Fdot%60%20in%20Jaxfun%20to%20represent%20the%20contraction%20of%20both%20dyadics%20and%20vectors%2C%20we%20find%20it%20more%20appropriate%20to%20include%20the%20dot%20also%20for%20contraction%20of%20higher%20order%20tensors.%0A%0A%20%20%20%20A%20linear%20combination%20of%20dyads%20is%20called%20a%20dyadic.%20For%20example%20%24%5Cmathbf%7BA%7D%20%3D%202(%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D)%20%2B%203%20(%5Cmathbf%7Bw%7D%20%5Cotimes%20%5Cmathbf%7Bz%7D)%24.%20Note%20that%20even%20though%20a%20dyad%20is%20a%20second%20order%20tensor%2C%20not%20all%20second%20order%20tensors%20are%20dyads.%20That%20is%2C%20we%20cannot%20always%20write%20the%20tensor%20%24%5Cmathbf%7BA%7D%24%20as%20the%20tensor%20product%20of%20two%20vectors%20%24%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D%24.%0A%0A%20%20%20%20The%20contraction%20of%20two%20dyads%20leads%20to%20a%20dyad%0A%0A%20%20%20%20%24%24%0A%20%20%20%20(%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bv%7D)%20%5Ccdot%20(%5Cmathbf%7Bw%7D%20%5Cotimes%20%5Cmathbf%7Bz%7D)%20%3D%20(%5Cmathbf%7Bv%7D%20%5Ccdot%20%5Cmathbf%7Bw%7D)%20(%5Cmathbf%7Bu%7D%20%5Cotimes%20%5Cmathbf%7Bz%7D)%0A%20%20%20%20%24%24%0A%0A%20%20%20%20Let%20create%20some%20dyadics%20in%20Jaxfun%20and%20illustrate.%20First%2C%20the%209%20dyad%20base%20vectors%20can%20be%20obtained%20as%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20display)%3A%0A%20%20%20%20bb%20%3D%20C.base_dyadics()%0A%20%20%20%20display(bb)%0A%20%20%20%20return%20(bb%2C)%0A%0A%0A%40app.cell%0Adef%20_(bb%2C%20display%2C%20r%2C%20theta)%3A%0A%20%20%20%20import%20numpy%20as%20np%0A%0A%20%20%20%20bv%20%3D%20np.array(bb%2C%20dtype%3Dobject).reshape((3%2C%203))%0A%20%20%20%20A%20%3D%202%20*%20bv%5B0%2C%201%5D%20%2B%203%20*%20bv%5B1%2C%202%5D%0A%20%20%20%20B%20%3D%20r%20*%20bv%5B1%2C%201%5D%20%2B%20theta%20*%20bv%5B2%2C%202%5D%0A%20%20%20%20display(A)%0A%20%20%20%20display(B)%0A%20%20%20%20return%20A%2C%20B%2C%20bv%2C%20np%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Contract%20%60A%60%20with%20%60B%60%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(A%2C%20B%2C%20Dot%2C%20display)%3A%0A%20%20%20%20H%20%3D%20Dot(A%2C%20B)%0A%20%20%20%20display(H)%0A%20%20%20%20display(H.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Operators%20in%20curvilinear%20coordinates%0A%0A%20%20%20%20%23%23%23%20Vector%20operations%0A%0A%20%20%20%20The%20gradient%20of%20a%20scalar%20field%20%24f(%5Cmathbf%7Bx%7D)%20(%3DF(%5Cmathbf%7BX%7D))%24%20is%20termed%20%24%5Ctext%7Bgrad%7D(f)%24%20and%20equals%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Ctext%7Bgrad%7D(f)%20%3D%20%5Cnabla%20f%20%3D%20%5Cfrac%7B%5Cpartial%20%7BF%7D%7D%7B%5Cpartial%20X%5E%7Bi%7D%7D%5C%2C%5Cmathbf%7Bb%7D%5E%7Bi%7D%20%3D%20%5Cfrac%7B%5Cpartial%20%7BF%7D%7D%7B%5Cpartial%20X%5E%7Bi%7D%7D%20g%5E%7Bij%7D%20%5C%2C%5Cmathbf%7Bb%7D_%7Bj%7D.%20%5Ctag%7B15%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20Note%20that%20the%20computation%20in%20curvilinear%20coordinates%20is%20simply%20using%20a%20change%20of%20variables%20and%20the%20chain%20rule%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cnabla%20f%20%3D%20%5Cfrac%7B%5Cpartial%20f(%5Cmathbf%7Bx%7D)%7D%7B%5Cpartial%20x_i%7D%20%5Cmathbf%7Bi%7D_%7Bi%7D%20%3D%20%5Cfrac%7B%5Cpartial%20F(%5Cmathbf%7BX%7D)%7D%7B%5Cpartial%20X%5Ej%7D%20%5Cfrac%7B%5Cpartial%20X%5Ej%7D%7B%5Cpartial%20x_i%7D%20%5Cmathbf%7Bi%7D_%7Bi%7D%20%3D%20%5Cfrac%7B%5Cpartial%20F%7D%7B%5Cpartial%20X%5Ej%7D%20%5Cmathbf%7Bb%7D%5Ej.%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20divergence%20of%20a%20vector%20%24%5Cmathbf%7Bv%7D%24%2C%20in%20terms%20of%20its%20contravariant%20components%2C%20is%20given%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Ctext%7Bdiv%7D(%5Cmathbf%7Bv%7D)%20%3D%20%5Cnabla%20%5Ccdot%20%5Cmathbf%7Bv%7D%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Bv%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%5Ccdot%20%5Cmathbf%7Bb%7D%5Ej%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7Bg%7D%7D%20%5Cfrac%7B%5Cpartial%20%7Bv%7D%5E%7Bi%7D%20%5Csqrt%7Bg%7D%7D%7B%5Cpartial%20X%5E%7Bi%7D%7D%2C%5Ctag%7B16%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20and%20the%20Laplacian%20of%20the%20scalar%20field%20%24f%24%20can%20be%20written%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Ctext%7Bdiv%7D(%5Ctext%7Bgrad%7D(f))%20%3D%20%5Cnabla%5E2%20f%20%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7Bg%7D%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20X%5E%7Bi%7D%7D%5Cleft(%20g%5E%7Bij%7D%20%5Csqrt%7Bg%7D%20%5Cfrac%7B%5Cpartial%20%7BF%7D%7D%7B%5Cpartial%20X%5E%7Bj%7D%7D%5Cright).%20%5Ctag%7B17%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20Note%20that%20%24g%5E%7Bij%7D%24%20and%20%24%5Csqrt%7Bg%7D%24%20will%20act%20as%20variable%20coefficients%20when%20the%20operators%20are%20used%20in%20differential%20equations.%0A%0A%20%20%20%20The%20curl%20of%20a%20vector%20is%20defined%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Ctext%7Bcurl%7D(%5Cmathbf%7Bv%7D)%20%3D%20%5Cnabla%20%5Ctimes%20%5Cmathbf%7Bv%7D%20%3D%20%5Cmathbf%7Bb%7D%5E%7Bj%7D%20%5Ctimes%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Bv%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%3D%20%5Cfrac%7B%5Cvarepsilon_%7Bijk%7D%7D%7B%5Csqrt%7Bg%7D%7D%20%5Cfrac%7B%5Cpartial%20%7Bv%7D_k%7D%7B%5Cpartial%20X%5Ej%7D%20%5Cmathbf%7Bb%7D_i%20%5Ctag%7B18%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20partial%20derivative%20%24%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Bv%7D%7D%7B%5Cpartial%20X%5Ej%7D%24%20is%20implemented%20in%20Jaxfun%20as%20the%20%60diff%60%20operator%20working%20on%20vectors.%20The%20partial%20derivative%20can%20be%20computed%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Bv%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%3D%20%5Cleft(%5Cfrac%7B%5Cpartial%20%7Bv%7D%5E%7Bi%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%2B%20%5CGamma%5E%7Bi%7D_%7Bkj%7D%20%7Bv%7D%5Ek%5Cright)%20%5Cmathbf%7Bb%7D_i%20%5Ctag%7B19%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24%5CGamma%5E%7Bi%7D_%7Bkj%7D%24%20is%20the%20Christoffel%20symbol%20of%20the%20second%20kind%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5CGamma%5E%7Bk%7D_%7Bji%7D%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Bb%7D_%7Bi%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%5Ccdot%20%5Cmathbf%7Bb%7D%5Ek%20%5Ctag%7B20%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20available%20in%20Jaxfun%20as%20method%20%60get_christoffel_second%60.%0A%0A%20%20%20%20The%20term%20%24%5Cfrac%7B%5Cpartial%20%7Bv%7D%5E%7Bi%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%2B%20%5CGamma%5E%7Bi%7D_%7Bkj%7D%20%7Bv%7D%5Ek%24%20is%20called%20the%20covariant%20derivative%20of%20vector%20components.%0A%0A%20%20%20%20The%20Christoffel%20symbol%20falls%20out%20of%20the%20last%20identity%20for%20the%20curl%20due%20to%20the%20symmetry%20%24%5CGamma%5E%7Bk%7D_%7Bji%7D%20%3D%20%5CGamma%5Ek_%7Bij%7D%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Tensor%20operations%0A%0A%20%20%20%20The%20gradient%20of%20a%20vector%20is%20a%20second%20order%20tensor%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Ctext%7Bgrad%7D(%5Cmathbf%7Bv%7D)%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7Bv%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%5Cotimes%20%5Cmathbf%7Bb%7D%5Ej%20%5Ctag%7B21%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20Note%20that%20if%20%24%5Cnabla%24%20is%20interpreted%20as%20a%20vector%2C%20then%20this%20corresponds%20to%20%24(%5Cnabla%20%5Cotimes%20%5Cmathbf%7Bv%7D)%5ET%24.%20However%2C%20in%20Jaxfun%20printing%20we%20interpret%20%24%5Cnabla%24%20as%20an%20operator%20and%20as%20such%20%24%5Ctext%7Bgrad%7D(%5Cmathbf%7Bv%7D)%24%20is%20printed%20as%20%24%5Cnabla%20%5Cmathbf%7Bv%7D%24.%0A%0A%20%20%20%20The%20divergence%20of%20a%20second%20order%20tensor%20%24%5Cmathbf%7BA%7D%24%20is%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Ctext%7Bdiv%7D(%5Cmathbf%7BA%7D)%20%3D%20%5Cfrac%7B%5Cpartial%20%5Cmathbf%7BA%7D%7D%7B%5Cpartial%20X%5Ej%7D%20%5Ccdot%20%5Cmathbf%7Bb%7D%5Ej%20%5Ctag%7B22%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20Again%2C%20if%20%24%5Cnabla%24%20is%20interpreted%20as%20a%20vector%2C%20then%20%24%5Ctext%7Bdiv%7D(%5Cmathbf%7BA%7D)%20%3D%20%5Cnabla%20%5Ccdot%20%5Cmathbf%7BA%7D%5ET%24.%20But%20in%20Jaxfun's%20printing%20%24%5Cnabla%24%20is%20an%20operator%20acting%20over%20the%20last%20axis%20of%20its%20input%20tensor.%20Hence%20the%20divergence%20of%20a%20tensor%20is%20printed%20as%20%24%5Cnabla%20%5Ccdot%20%5Cmathbf%7BA%7D%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20display%2C%20r%2C%20theta)%3A%0A%20%20%20%20from%20jaxfun.operators%20import%20Grad%2C%20Div%0A%0A%20%20%20%20w%20%3D%20r%20*%20C.b_r%20%2B%20theta%20*%20C.b_z%0A%20%20%20%20g%20%3D%20Grad(w)%0A%20%20%20%20display(g)%0A%20%20%20%20display(g.doit())%0A%20%20%20%20return%20Div%2C%20Grad%0A%0A%0A%40app.cell%0Adef%20_(Div%2C%20bv%2C%20display%2C%20r%2C%20z)%3A%0A%20%20%20%20D%20%3D%20r%20*%20bv%5B0%2C%200%5D%20%2B%20z%20*%20bv%5B1%2C%202%5D%0A%20%20%20%20q%20%3D%20Div(D)%0A%20%20%20%20display(q)%0A%20%20%20%20display(q.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Curvilinear%20equations%0A%0A%20%20%20%20Lets%20consider%20the%20Laplace%20operator%20in%20curvilinear%20coordinates.%20For%20this%20we%20use%20a%20%60ScalarFunction%60%20and%20Jaxfun%20operators%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Div%2C%20Grad%2C%20display)%3A%0A%20%20%20%20from%20jaxfun.galerkin.arguments%20import%20ScalarFunction%0A%0A%20%20%20%20u_%20%3D%20ScalarFunction(name%3D%22u%22%2C%20system%3DC)%0A%20%20%20%20Lu%20%3D%20Div(Grad(u_))%0A%20%20%20%20display(Lu)%0A%20%20%20%20return%20Lu%2C%20u_%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20Laplace%20operator%20is%20displayed%20in%20Cartesian%20coordinates.%20When%20evaluated%2C%20we%20get%20the%20operator%20in%20cylinder%20coordinates%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Lu%2C%20display)%3A%0A%20%20%20%20display(Lu.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20the%20map%20from%20Cartesian%20function%20%24u(x%2C%20y%2C%20z)%24%20for%20the%20generic%20(unevaluated)%20operator%20to%20computational%20%24U(r%2C%20%5Ctheta%2C%20z)%24%20in%20the%20evaluated%20domain.%0A%0A%20%20%20%20We%20can%20also%20look%20at%20the%20gradient%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Grad%2C%20display%2C%20u_)%3A%0A%20%20%20%20display(Grad(u_))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Grad%2C%20display%2C%20u_)%3A%0A%20%20%20%20display(Grad(u_).doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20the%20small%20difference%20here%20from%20most%20textbooks%20that%20present%20the%20gradient%20as%20(see%2C%20e.g.%2C%20%5Bwikipedia%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FGradient))%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cnabla%20u%20%3D%20%5Cfrac%7B%5Cpartial%20U%7D%7B%5Cpartial%20r%7D%20%5Chat%7B%5Cmathbf%7Bb%7D%7D_r%20%2B%20%5Cfrac%7B1%7D%7Br%7D%5Cfrac%7B%5Cpartial%20U%7D%7B%5Cpartial%20%5Ctheta%7D%20%5Chat%7B%5Cmathbf%7Bb%7D%7D_%7B%5Ctheta%7D%20%2B%20%5Cfrac%7B%5Cpartial%20U%7D%7B%5Cpartial%20z%7D%5Chat%7B%5Cmathbf%7Bb%7D%7D_z%0A%20%20%20%20%24%24%0A%0A%20%20%20%20using%20normalized%20(unit)%20basis%20vectors%20%24%5Chat%7B%5Cmathbf%7Bb%7D%7D_r%20%3D%20%7B%5Cmathbf%7Bb%7D%7D_r%2C%20%5Chat%7B%5Cmathbf%7Bb%7D%7D_%7B%5Ctheta%7D%20%3D%20%5Cmathbf%7Bb%7D_%7B%5Ctheta%7D%20%2F%20r%24%20and%20%24%5Chat%7B%5Cmathbf%7Bb%7D%7D_z%20%3D%20%5Cmathbf%7Bb%7D_z%24.%20Replacing%20the%20hat%20vectors%20above%20with%20the%20covariant%20basis%20vectors%20leads%20to%20the%20same%20result.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20curl%20of%20a%20gradient%20should%20be%20zero.%20Lets%20verify%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Grad%2C%20display%2C%20u_)%3A%0A%20%20%20%20from%20jaxfun.operators%20import%20Curl%0A%0A%20%20%20%20display(Curl(Grad(u_)))%0A%20%20%20%20return%20(Curl%2C)%0A%0A%0A%40app.cell%0Adef%20_(Curl%2C%20Grad%2C%20display%2C%20u_)%3A%0A%20%20%20%20display(Curl(Grad(u_)).doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Inner%20products%0A%0A%20%20%20%20The%20weighted%20%24L_%7B%5Comega%7D%5E2(%5COmega%5Em)%24%20inner%20product%20is%20defined%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20(u(%5Cmathbf%7Bx%7D)%2C%20v(%5Cmathbf%7Bx%7D))_%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%20%3D%20%5Cint_%7B%5COmega%5Em%7Du(%5Cmathbf%7Bx%7D)%20%5Coverline%7Bv%7D(%5Cmathbf%7Bx%7D)%20%5Comega(%5Cmathbf%7Bx%7D)%20d%5Clambda%5Em%20%5Ctag%7B23%7D%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20as%20before%20%24m%24%3D%201%2C%202%20or%203%20represents%20a%20curve%2C%20surface%20or%20volume%2C%20and%20%20%24d%5Clambda%5Em%24%20represents%20an%20infinitesimal%20line%2C%20surface%20or%20volume%20element.%20The%20overline%20on%20%24%5Coverline%7Bv%7D%24%20represents%20a%20complex%20conjugate.%0A%0A%20%20%20%20The%20computational%20domain%20is%20a%20hypercube%2C%20with%20%24%5Cmathbb%7BI%7D%5E2%20%3D%20%5Ctext%7BI%7D%5E0%20%5Ctimes%20%5Ctext%7BI%7D%5E1%24%20and%20%24%5Cmathbb%7BI%7D%5E3%20%3D%20%5Ctext%7BI%7D%5E0%20%5Ctimes%20%5Ctext%7BI%7D%5E1%20%5Ctimes%20%5Ctext%7BI%7D%5E2%24%2C%20where%20%24%5Ctext%7BI%7D%5Em%24%20is%20the%20interval%20used%20for%20computational%20dimension%20%24m%24.%20When%20computing%20the%20inner%20product%2C%20we%20first%20transform%20the%20integral%20to%20computational%20coordinates.%20We%20use%20the%20following%20mapped%20tensor%20product%20function%20approximations%0A%0A%20%20%20%20%24%24%0A%20%20%20%20u(%5Cmathbf%7Bx%7D)%20%3D%20U(X%5E0)%20%3D%20%5Csum_%7Bk%3D0%7D%5E%7BN-1%7D%20%5Chat%7Bu%7D_k%20%5Cphi_k(X%5E0)%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20%24%24%0A%20%20%20%20u(%5Cmathbf%7Bx%7D)%20%3D%20U(X%5E0%2C%20X%5E1)%20%3D%20%5Csum_%7Bk%3D0%7D%5E%7BN_0-1%7D%5Csum_%7Bj%3D0%7D%5E%7BN_1-1%7D%20%5Chat%7Bu%7D_%7Bkj%7D%20%5Cphi_k(X%5E0)%20%5Cpsi_j(X%5E1)%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20%24%24%0A%20%20%20%20u(%5Cmathbf%7Bx%7D)%20%3D%20U(X%5E0%2C%20X%5E1%2C%20X%5E2)%20%3D%20%5Csum_%7Bk%3D0%7D%5E%7BN_0-1%7D%5Csum_%7Bj%3D0%7D%5E%7BN_1-1%7D%20%5Csum_%7Bi%3D0%7D%5E%7BN_2-1%7D%5Chat%7Bu%7D_%7Bkji%7D%20%5Cphi_k(X%5E0)%20%5Cpsi_j(X%5E1)%20%5Cgamma_i(X%5E2)%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20for%20curves%2C%20surfaces%20or%20volumes.%0A%0A%20%20%20%20Consider%20a%20differential%20equation%20of%20the%20form%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20L%20u(%5Cmathbf%7Bx%7D)%20%3D%20f(%5Cmathbf%7Bx%7D)%2C%20%5Cquad%20%5Ctext%7Bfor%20%7D%20%5Cmathbf%7Bx%7D%20%5Cin%20%5COmega%5Em%2C%20%5Ctag%7B24%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20where%20%24L%24%20is%20a%20linear%20operator%2C%20%24f(%5Cmathbf%7Bx%7D)%20%5Cin%20L%5E2_%7B%5Comega%7D(%5COmega%5Em)%24%2C%20and%20%24u(%5Cmathbf%7Bx%7D)%20%5Cin%20%5Ctext%7BV%7D(%5COmega%5Em)%24.%20The%20weighted%20variational%20forms%20obtained%20by%20multiplying%20the%20differential%20equation%20by%20a%20test%20function%20and%20integrating%20over%20the%20domain%20are%0A%0A%20%20%20%20%5Cbegin%7Balign%7D%0A%20%20%20%20%20%20%20%20a(u%2C%20v)_%7B%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%7D%20%26%3D%20%5Cint_%7B%5COmega%5Em%7D%20L%20u(%5Cmathbf%7Bx%7D)%20%5C%2C%5Coverline%7Bv%7D(%5Cmathbf%7Bx%7D)%20%5C%2C%20%5Comega(%5Cmathbf%7Bx%7D)%20%5C%2C%20d%5Clambda%5Em%2C%20%5Ctag%7B25%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20(f%2C%20v)_%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%20%26%3D%20%5Cint_%7B%5COmega%5Em%7D%20f(%5Cmathbf%7Bx%7D)%20%5C%2C%5Coverline%7Bv%7D(%5Cmathbf%7Bx%7D)%20%5C%2C%20%5Comega(%5Cmathbf%7Bx%7D)%20%5C%2C%20d%5Clambda%5Em%2C%20%5Ctag%7B26%7D%0A%20%20%20%20%5Cend%7Balign%7D%0A%0A%20%20%20%20and%20the%20weighted%20Galerkin%20method%20is%20to%20find%20%24u%20%5Cin%20%5Ctext%7BV%7D(%5COmega%5Em)%24%20such%20that%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20a(u%2C%20v)_%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%20%3D%20(f%2C%20v)_%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%2C%20%5Cquad%20%5Cforall%20%5C%2C%20v%20%5Cin%20%5Ctext%7BV%7D(%5COmega%5Em).%20%5Ctag%7B27%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20For%20either%20curves%2C%20surfaces%20or%20volumes%2C%20the%20integrals%20are%20transformed%20to%0A%0A%20%20%20%20%5Cbegin%7Balign%7D%0A%20%20%20%20%20%20%20%20a(u%2C%20v)_%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%20%26%3D%20%20%5Cint_%7B%5Cmathbb%7BI%7D%5Em%7D%20%7BL%7D%20U%20%5C%2C%20%5Coverline%7BV%7D%20%5C%2C%20W%20%5C%2C%20%5Csqrt%7Bg%7D%20d%7BX%7D%2C%20%5Ctag%7B28%7D%5C%5C%0A%20%20%20%20%20%20%20%20(f%2C%20v)_%7BL_%7B%5Comega%7D%5E2(%5COmega%5Em)%7D%20%26%3D%20%5Cint_%7B%5Cmathbb%7BI%7D%5Em%7D%20F%20%5C%2C%5Coverline%7BV%7D%20%5C%2C%20W%20%5C%2C%20%5Csqrt%7Bg%7D%20d%7BX%7D%2C%20%5Ctag%7B29%7D%0A%20%20%20%20%5Cend%7Balign%7D%0A%0A%20%20%20%20where%20%24d%7BX%7D%3D%5Cprod_%7Bi%5Cin%20%5Cmathcal%7BI%7D%5Em%7D%20dX%5E%7Bi%7D%24%20and%20%24%7BL%7DU%24%20is%20an%20operator%20transformed%20to%20computational%20space%2C%20like%20Eqs.%20(17).%20The%20computational%20weights%20%24W(%5Cmathbf%7BX%7D)%24%20are%20determined%20by%20the%20choice%20of%20basis%20functions.%20Note%20that%20the%20transformation%20makes%20use%20of%20%24d%5Clambda%5Em%20%3D%20%5Csqrt%7Bg%7Dd%7BX%7D%24%20for%20all%20%24m%20%5Cle%20n%24.%0A%0A%20%20%20%20An%20example%20solving%20Helmholtz%20equation%20on%20an%20annulus%20is%20given%20in%20the%20following%20%20%5Bnotebook%5D(https%3A%2F%2Fspectraldns.github.io%2Fjaxfun%2Fannulus.html).%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">ab30538231878be4cd77322c5e8e5226</marimo-code-hash>
</body>
</html>
