<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>formlanguage.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>formlanguage</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/index-DVgeLSg0.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-DxWb3aMV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-NOntBqny.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-CF9gSfGe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-PzrizfuL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-BNkRH34W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-LUpffRIq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-MyTWYTLd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-maX8rbyb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-Bt3KRZho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cells-Botr-aL3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/textarea-BmPX99zz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/switch-Vbll2pdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/mode-C1hn9AVp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/ai-model-dropdown-BMv5J-EA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cell-link-DvW8RUk0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/datasource-acoDY9Ku.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/state-AxOl5_1Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/MarimoErrorOutput-a6bY4dzO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/html-to-image-CVa2JapI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/focus--DQRDy9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/LazyAnyLanguageCodeMirror-BTO7DS3k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/markdown-renderer-DqiLSa6X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/command-BMidGaii.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/download-COpfLoar.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useRunCells-DrrCdLgV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/RenderHTML-CG3x4AfR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/JsonOutput-ChH_9MPt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDeleteCell-CRLMdzIa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/process-output-uzyiTMlC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/esm-BqiVbELQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/add-cell-with-ai-C09q01JF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chat-display-DLmJWehR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/column-preview-BZevmZKp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/globals-DVVNoYwt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/utilities.esm-Di0IV3nO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/floating-outline-CMt2sk--.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useAddCell-DKJ0NHXX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/readonly-python-code-Co1fGZLh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/types-Dv1-Phf0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/form-CEIWhPlm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.11/dist/assets/index-CeUwN_0i.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
    window.__MARIMO_STATIC__.modelNotifications = [];
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "formlanguage.py",
            "mode": "read",
            "version": "0.19.11",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "mo.md(r\"\"\"\n# The form language in Jaxfun (WIP)\n\nJaxfun consists of a rich form-language that is used to formulate problems. This language is built on top of Sympy's Function and Vector classes. The fundamental idea is that you choose a functionspace and then you create functions on that space. For the global Galerkin method, this means that you work with functions like\n\n\\begin{equation}\nv(x) = \\sum_{i=0}^{N-1} \\hat{v}_i \\phi_i(x) \\tag{1}\n\\end{equation}\n\nwhere $v(x)$ is your function, $\\phi_i(x)$ are $N$ basis functions and $\\hat{v}_i$ are $N$ unknown expansion coefficients. The functionspace corresponding to this function is $V=\\text{span}\\{\\phi_i\\}_{i=0}^{N-1}$. When we say that $v(x) \\in V$, this means that $v$ can be expanded as shown in Eq. (1), but we do not necessarily know the coefficients.\n\nA tensorproductspace in 2D Cartesian space can be defined as $T = V \\otimes V$. A scalar function $f \\in T$ is then defined as\n\n\\begin{equation}\nf(x, y) = \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\hat{f}_{ij} \\phi_i(x) \\phi_j(y) \\tag{2}\n\\end{equation}\n\nwith the unknown matrix $F=\\{\\hat{f}_{ij}\\}_{i,j=0}^{N-1} \\in \\mathbb{R}^{N \\times N}$.\n\nA vector tensorproductspace in 2D can be defined as $W = T \\times T$. A function $\\boldsymbol{w} \\in W$ is then defined as\n\n\\begin{equation}\n\\boldsymbol{w}(x, y) = w^{(0)}(x, y) \\boldsymbol{i} + w^{(1)}(x, y) \\boldsymbol{j} \\tag{3}\n\\end{equation}\n\nwhere $\\boldsymbol{i}$ and $\\boldsymbol{j}$ are Cartesian unit vectors in $x$ and $y$ direction, respectively, and $w^{(i)}$ represents component $i$ of the vector. That is, $w^{(0)} = \\boldsymbol{w} \\cdot \\boldsymbol{i}$ and $w^{(1)} = \\boldsymbol{w} \\cdot \\boldsymbol{j}$. In Eq. (3) both $w^{(0)}$ and $w^{(1)}$ can be expanded as shown in Eq (2).\n\nIn Jaxfun you choose the functionspace and then you create functions. Let's create samples of all the three Galerkin functions defined above ($v(x), f(x, y), \\boldsymbol{w}(x, y)$):\n\"\"\")", "code_hash": "9b0559c96d4c28aaa3cbdee5e6ca3afc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "from IPython.display import display\n\nimport jax.numpy as jnp\n\nfrom jaxfun.galerkin import (\n    JAXFunction,\n    Legendre,\n    TensorProduct,\n    TestFunction,\n    TrialFunction,\n    VectorTensorProductSpace,\n    inner,\n)\n\nN = 20\nV = Legendre.Legendre(N, name=\"V\", fun_str=\"phi\")\nT = TensorProduct(V, V, name=\"T\")\nW = VectorTensorProductSpace(T, name=\"W\")\nv = TestFunction(V, name=\"v\")\nf = TestFunction(T, name=\"f\")\nw = TestFunction(W, name=\"w\")\ndisplay(v)\ndisplay(f)\ndisplay(w)", "code_hash": "f79da2e55996c1c7b3a4f8ed27831a9e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote that the three displayed functions are all in unevaluated state. They appear as the left hand side of their definition. We see $v(x; V)$, which is the left hand side of Eq. (1), with an additional $V$ to show that this function has been created from the space named \"V\".\n\nWe can get the basisfunctions from the right hand side by evaluating the expressions:\n\"\"\")", "code_hash": "f204ef8479fb64943983d36c45898fc1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "display(v.doit())\ndisplay(f.doit())\ndisplay(w.doit())", "code_hash": "11836981a2fda43e720a982255a26118", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote that since test functions do not contain any expansion coefficients, only the basis functions are shown. The superscript in parenthesis on the vector components shows the index into the vector of basis functions. Hence, $\\phi_i^{(0)}(x)$ is the $i$'th basis function in the first component of the vector space $W$, and $\\phi_j^{(1)}(y)$ is the $j$'th basis function in the second component of $W$.\n\nA trial function is similar to the test function, but represents the unknown solution that we are trying to find. The trial function is displayed exactly like the test function, but with a different index. Remember the test function on $V$ was displayed as $\\phi_i(x)$. The trial function is displayed as $\\phi_j(x)$:\n\"\"\")", "code_hash": "567c9cb1c773d9563bb8c04350d63a38", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "u = TrialFunction(V, name=\"u\")\ndisplay(u)\ndisplay(u.doit())", "code_hash": "793db74f20b23a898479e71e1e7a843b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "mo.md(r\"\"\"\nTrial and test functions are used together to assemble matrices in variational forms. Consider the L2 inner product\n\n$$\n(u, v)_{L^2(\\Omega)} = \\int_{\\Omega} \\phi_j(x)\\phi_i(x)dx, (i, j) \\in (0, \\ldots, N-1) \\times (0, \\ldots, N-1)\n$$\n\nwhere $u$ is a trial function and $v$ is a test function. The left hand side is in unevaluated form and the right hand side with the integral is in evaluated form using the basis functions retrieved from `doit`. This inner product results in a matrix $A \\in \\mathbb{R}^{N \\times N}$ with components $a_{ij} = \\int_{\\Omega} \\phi_j(x)\\phi_i(x)dx$.\n\"\"\")", "code_hash": "e762303e6d1e3cf73a104f1207b7c4cc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "A = inner(u * v)\ndisplay(u * v)\ndisplay((u * v).doit())\nprint(\"Shape of matrix A =\", A.shape)", "code_hash": "fa8b20fd88a29b2f9155f030c89c135e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe integral is computed using numerical quadrature on the quadrature points of the Legendre basis functions. For multidimensional problems we get tensor product matrices, that we will get back to in a little while. First, there is a third function that deserves some attentions. The `JAXFunction`s are complete Galerkin functions, containing also the expansion coefficients of the Galerkin function.\n\"\"\")", "code_hash": "c82b52e1f71086bb58cb27b54bd7c059", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "h = JAXFunction(jnp.ones(N), V, name=\"h\")\ndisplay(h)\ndisplay(h.doit(linear=True))", "code_hash": "119fa78b435b440bf62c3b8f6598273f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe JAXFunction displayed above is shown first in unevaluated state. It is shown as a function of $x$, created on the function space `V`. When evaluated using `doit`, the JAXFunction returns the product of its expansion coefficients $\\hat{h}_j$ and trial basis functions (using the same index as the trial function). Note that there is summation implied by repeating indices. Unlike the test and trial functions, the JAXFunction may appear in expressions in non-linear form. In that case, we do not expand the function with indices, but treat it like any other computable function. Note the missing keyword argument `linear=True` below:\n\"\"\")", "code_hash": "765a1cf0e3a21a8c1273d7125af7ccc9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "display(h.doit())", "code_hash": "8ccc0f229334e2ec7dbc5efb25bd844d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe can create JAXFunctions for any of the three spaces created initially in this notebook:\n\"\"\")", "code_hash": "e113c8c8ac7a88db1d8baceb366ef53c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "b = JAXFunction(jnp.ones((N, N)), T, name=\"b\")\ndisplay(b)\ndisplay(b.doit(linear=True))\ndisplay(b.doit())", "code_hash": "58b241c3366d09f57b9d0692b17f2c97", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "c = JAXFunction(jnp.ones((2, N, N)), W, name=\"c\")\ndisplay(c)\ndisplay(c.doit(linear=True))\ndisplay(c.doit())", "code_hash": "4df92a24146c88ea255eed90e7663504", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "mo.md(r\"\"\"\nConsider the $L^2$ inner product $(h, v)_{L^2(\\Omega)}$. The integrand is now\n\"\"\")", "code_hash": "f7721d3e96995639a747f04afa0eee8a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "(h * v).doit(linear=True)", "code_hash": "6aa14656c648b89fefafeee5b917d40d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote the repeated $j$ index, which implies summation (Einstein summation convention). There is only one free index, $i$, and a such `inner(h*v)` returns a vector.\n\"\"\")", "code_hash": "aa623e2fb14cd82942c5311869981163", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "qnkX", "name": "_"}, {"code": "from jaxfun.galerkin.forms import split\n\nsplit(v * h)", "code_hash": "77762ad9a83160982f8c7e5446826bed", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "hv = inner(h * v)\nprint(hv.shape)", "code_hash": "453ebcf6515f877ceb7b2a658d12375e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe vector `hv` equals the matrix vector product $A h$\n\"\"\")", "code_hash": "a87599741a1767ce90200fd26315f28f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "assert jnp.all(hv == A @ h)", "code_hash": "1065dae45d62c8ba05b4b1fc24251761", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(r\"\"\"\nFor the tensorproductspace we get 4 free indices, $\\phi_i(x)\\phi_j(y)$ from the test function and $\\phi_k(x)\\phi_l(y)$ from the trial.\n\"\"\")", "code_hash": "7d3a759059e96981cdc01df283e468fe", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "g = TrialFunction(T, \"g\")\ndisplay((g * f).doit())", "code_hash": "b1d091700bb0185e3db7708d63c576b5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(r\"\"\"\nHence the inner product leads to a tensor with 4 indices.\n\"\"\")", "code_hash": "db91a5de59054d2757a9ddce7ac9bd20", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZBYS", "name": "_"}, {"code": "B = inner(f * g)\ndisplay(B)", "code_hash": "c624fd8aa36017716fc9fbee00ada154", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe `TPMatrix` B is a tensor product matrix equal to the outer product of two regular matrices $b_{ijkl}=b^{(0)}_{ik}b^{(1)}_{jl}$, where $b^{(0)}_{ik}=\\int_{\\Omega_x}\\phi_i(x)\\phi_k(x)dx$ and $b^{(1)}_{jl}=\\int_{\\Omega_y}\\phi_j(y)\\phi_l(y)dy$, with $\\Omega = \\Omega_x \\times \\Omega_y$. The two smaller matrices are stored under `B.mats`.\n\"\"\")", "code_hash": "85b667fa6942e588b73ecb0cb624c6c6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"\nA multilayer perceptron neural network is defined as the function\n\n$$\nM(\\boldsymbol{z}; \\theta) =  W^{L} \\sigma( W^{L-1} \\ldots \\sigma( W^1 \\boldsymbol{z} + \\boldsymbol{b}^1) \\ldots + \\boldsymbol{b}^{L-1})  + \\boldsymbol{b}^L\n$$\n\nwhere $\\theta = \\{W^l, \\boldsymbol{b}^l\\}_{l=1}^L$ represents all the unknowns in the model and $W^l, \\boldsymbol{b}^l$ represents the weights and biases on level $l$. The model input $\\boldsymbol{z}$ can be anything. For example, $\\boldsymbol{z}$ can represent $(x), (x, y), (x, y, z), (x, t), (x, y, t), ...$. For $Z$ number of inputs the scalar function $M_{\\theta}: \\mathbb{R}^Z \\rightarrow \\mathbb{R}$. Similarly, a vector function in 2D space is simply $M_{\\theta}: \\mathbb{R}^Z \\rightarrow \\mathbb{R}^2$. The neural networks are represented in Jaxfun through a `FlaxFunction`, and we can use them in any numer of dimensions and also of vector rank.\n\"\"\")", "code_hash": "b80569ae0b311e5fc0c780048a2e4deb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xXTn", "name": "_"}, {"code": "from jaxfun.pinns import FlaxFunction, MLPSpace\n\nM1 = MLPSpace([20], dims=1, rank=0, name=\"M1\")\nM2 = MLPSpace([20], dims=2, rank=0, name=\"M2\")\nM3 = MLPSpace([20], dims=2, rank=1, name=\"M3\")\nf1 = FlaxFunction(M1, name=\"a\")\nf2 = FlaxFunction(M2, name=\"b\")\nf3 = FlaxFunction(M3, name=\"c\")\ndisplay(f1)\ndisplay(f2)\ndisplay(f3)\ndisplay(f1.doit())\ndisplay(f2.doit())\ndisplay(f3.doit())", "code_hash": "9d8989df06a4a7cc7de6ab370ccd99ce", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "pHFh", "name": "_"}], "metadata": {"marimo_version": "0.19.11"}, "version": "1"},
            "session": {"cells": [{"code_hash": "9b0559c96d4c28aaa3cbdee5e6ca3afc", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"the-form-language-in-jaxfun-wip\"\u003EThe form language in Jaxfun (WIP)\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EJaxfun consists of a rich form-language that is used to formulate problems. This language is built on top of Sympy's Function and Vector classes. The fundamental idea is that you choose a functionspace and then you create functions on that space. For the global Galerkin method, this means that you work with functions like\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\nv(x) = \\sum_{i=0}^{N-1} \\hat{v}_i \\phi_i(x) \\tag{1}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v(x)||)\u003C/marimo-tex\u003E is your function, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_i(x)||)\u003C/marimo-tex\u003E are \u003Cmarimo-tex class=\"arithmatex\"\u003E||(N||)\u003C/marimo-tex\u003E basis functions and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\hat{v}_i||)\u003C/marimo-tex\u003E are \u003Cmarimo-tex class=\"arithmatex\"\u003E||(N||)\u003C/marimo-tex\u003E unknown expansion coefficients. The functionspace corresponding to this function is \u003Cmarimo-tex class=\"arithmatex\"\u003E||(V=\\text{span}\\{\\phi_i\\}_{i=0}^{N-1}||)\u003C/marimo-tex\u003E. When we say that \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v(x) \\in V||)\u003C/marimo-tex\u003E, this means that \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v||)\u003C/marimo-tex\u003E can be expanded as shown in Eq. (1), but we do not necessarily know the coefficients.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EA tensorproductspace in 2D Cartesian space can be defined as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(T = V \\otimes V||)\u003C/marimo-tex\u003E. A scalar function \u003Cmarimo-tex class=\"arithmatex\"\u003E||(f \\in T||)\u003C/marimo-tex\u003E is then defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\nf(x, y) = \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\hat{f}_{ij} \\phi_i(x) \\phi_j(y) \\tag{2}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewith the unknown matrix \u003Cmarimo-tex class=\"arithmatex\"\u003E||(F=\\{\\hat{f}_{ij}\\}_{i,j=0}^{N-1} \\in \\mathbb{R}^{N \\times N}||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EA vector tensorproductspace in 2D can be defined as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(W = T \\times T||)\u003C/marimo-tex\u003E. A function \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{w} \\in W||)\u003C/marimo-tex\u003E is then defined as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\begin{equation}\n\\boldsymbol{w}(x, y) = w^{(0)}(x, y) \\boldsymbol{i} + w^{(1)}(x, y) \\boldsymbol{j} \\tag{3}\n\\end{equation}||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{i}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{j}||)\u003C/marimo-tex\u003E are Cartesian unit vectors in \u003Cmarimo-tex class=\"arithmatex\"\u003E||(x||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(y||)\u003C/marimo-tex\u003E direction, respectively, and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w^{(i)}||)\u003C/marimo-tex\u003E represents component \u003Cmarimo-tex class=\"arithmatex\"\u003E||(i||)\u003C/marimo-tex\u003E of the vector. That is, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w^{(0)} = \\boldsymbol{w} \\cdot \\boldsymbol{i}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w^{(1)} = \\boldsymbol{w} \\cdot \\boldsymbol{j}||)\u003C/marimo-tex\u003E. In Eq. (3) both \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w^{(0)}||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w^{(1)}||)\u003C/marimo-tex\u003E can be expanded as shown in Eq (2).\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIn Jaxfun you choose the functionspace and then you create functions. Let's create samples of all the three Galerkin functions defined above (\u003Cmarimo-tex class=\"arithmatex\"\u003E||(v(x), f(x, y), \\boldsymbol{w}(x, y)||)\u003C/marimo-tex\u003E):\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f79da2e55996c1c7b3a4f8ed27831a9e", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[v(x; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[f(x, y; T)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{ {w} }(x, y; W)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "f204ef8479fb64943983d36c45898fc1", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote that the three displayed functions are all in unevaluated state. They appear as the left hand side of their definition. We see \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v(x; V)||)\u003C/marimo-tex\u003E, which is the left hand side of Eq. (1), with an additional \u003Cmarimo-tex class=\"arithmatex\"\u003E||(V||)\u003C/marimo-tex\u003E to show that this function has been created from the space named \"V\".\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can get the basisfunctions from the right hand side by evaluating the expressions:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "11836981a2fda43e720a982255a26118", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\phi_i(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\phi_i(x) \\phi_j(y)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\phi_i^{(0)}(x) \\phi_j^{(0)}(y)\\right)\\mathbf{{i}} + \\left(\\phi_i^{(1)}(x) \\phi_j^{(1)}(y)\\right)\\mathbf{{j}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "567c9cb1c773d9563bb8c04350d63a38", "console": [], "id": "lEQa", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote that since test functions do not contain any expansion coefficients, only the basis functions are shown. The superscript in parenthesis on the vector components shows the index into the vector of basis functions. Hence, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_i^{(0)}(x)||)\u003C/marimo-tex\u003E is the \u003Cmarimo-tex class=\"arithmatex\"\u003E||(i||)\u003C/marimo-tex\u003E'th basis function in the first component of the vector space \u003Cmarimo-tex class=\"arithmatex\"\u003E||(W||)\u003C/marimo-tex\u003E, and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_j^{(1)}(y)||)\u003C/marimo-tex\u003E is the \u003Cmarimo-tex class=\"arithmatex\"\u003E||(j||)\u003C/marimo-tex\u003E'th basis function in the second component of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(W||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EA trial function is similar to the test function, but represents the unknown solution that we are trying to find. The trial function is displayed exactly like the test function, but with a different index. Remember the test function on \u003Cmarimo-tex class=\"arithmatex\"\u003E||(V||)\u003C/marimo-tex\u003E was displayed as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_i(x)||)\u003C/marimo-tex\u003E. The trial function is displayed as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_j(x)||)\u003C/marimo-tex\u003E:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "793db74f20b23a898479e71e1e7a843b", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[u(x; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\phi_j(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "e762303e6d1e3cf73a104f1207b7c4cc", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ETrial and test functions are used together to assemble matrices in variational forms. Consider the L2 inner product\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n(u, v)_{L^2(\\Omega)} = \\int_{\\Omega} \\phi_j(x)\\phi_i(x)dx, (i, j) \\in (0, \\ldots, N-1) \\times (0, \\ldots, N-1)\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u||)\u003C/marimo-tex\u003E is a trial function and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(v||)\u003C/marimo-tex\u003E is a test function. The left hand side is in unevaluated form and the right hand side with the integral is in evaluated form using the basis functions retrieved from \u003Ccode\u003Edoit\u003C/code\u003E. This inner product results in a matrix \u003Cmarimo-tex class=\"arithmatex\"\u003E||(A \\in \\mathbb{R}^{N \\times N}||)\u003C/marimo-tex\u003E with components \u003Cmarimo-tex class=\"arithmatex\"\u003E||(a_{ij} = \\int_{\\Omega} \\phi_j(x)\\phi_i(x)dx||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "fa8b20fd88a29b2f9155f030c89c135e", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Shape of matrix A = (20, 20)\n", "type": "stream"}], "id": "SFPL", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[v(x; V) u(x; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\phi_i(x) \\phi_j(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "c82b52e1f71086bb58cb27b54bd7c059", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe integral is computed using numerical quadrature on the quadrature points of the Legendre basis functions. For multidimensional problems we get tensor product matrices, that we will get back to in a little while. First, there is a third function that deserves some attentions. The \u003Ccode\u003EJAXFunction\u003C/code\u003Es are complete Galerkin functions, containing also the expansion coefficients of the Galerkin function.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "119fa78b435b440bf62c3b8f6598273f", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[h(x; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\hat{h}_{j} \\phi_j(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "765a1cf0e3a21a8c1273d7125af7ccc9", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe JAXFunction displayed above is shown first in unevaluated state. It is shown as a function of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(x||)\u003C/marimo-tex\u003E, created on the function space \u003Ccode\u003EV\u003C/code\u003E. When evaluated using \u003Ccode\u003Edoit\u003C/code\u003E, the JAXFunction returns the product of its expansion coefficients \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\hat{h}_j||)\u003C/marimo-tex\u003E and trial basis functions (using the same index as the trial function). Note that there is summation implied by repeating indices. Unlike the test and trial functions, the JAXFunction may appear in expressions in non-linear form. In that case, we do not expand the function with indices, but treat it like any other computable function. Note the missing keyword argument \u003Ccode\u003Elinear=True\u003C/code\u003E below:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "8ccc0f229334e2ec7dbc5efb25bd844d", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[h(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "e113c8c8ac7a88db1d8baceb366ef53c", "console": [], "id": "Hstk", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe can create JAXFunctions for any of the three spaces created initially in this notebook:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "58b241c3366d09f57b9d0692b17f2c97", "console": [], "id": "nWHF", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[b(x, y; T)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\hat{b}_{kl} \\phi_k(x) \\phi_l(y)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[b(x, y)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "4df92a24146c88ea255eed90e7663504", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{ {c} }(x, y; W)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\hat{c}_{kl}^{(0)} \\phi_k^{(0)}(x) \\phi_l^{(0)}(y)\\right)\\mathbf{{i}} + \\left(\\hat{c}_{kl}^{(1)} \\phi_k^{(1)}(x) \\phi_l^{(1)}(y)\\right)\\mathbf{{j}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(c^{(0)}(x, y)\\right)\\mathbf{{i}} + \\left(c^{(1)}(x, y)\\right)\\mathbf{{j}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "f7721d3e96995639a747f04afa0eee8a", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EConsider the \u003Cmarimo-tex class=\"arithmatex\"\u003E||(L^2||)\u003C/marimo-tex\u003E inner product \u003Cmarimo-tex class=\"arithmatex\"\u003E||((h, v)_{L^2(\\Omega)}||)\u003C/marimo-tex\u003E. The integrand is now\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6aa14656c648b89fefafeee5b917d40d", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\hat{h}_{j} \\phi_i(x) \\phi_j(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "aa623e2fb14cd82942c5311869981163", "console": [], "id": "qnkX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote the repeated \u003Cmarimo-tex class=\"arithmatex\"\u003E||(j||)\u003C/marimo-tex\u003E index, which implies summation (Einstein summation convention). There is only one free index, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(i||)\u003C/marimo-tex\u003E, and a such \u003Ccode\u003Einner(h*v)\u003C/code\u003E returns a vector.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "77762ad9a83160982f8c7e5446826bed", "console": [], "id": "TqIu", "outputs": [{"data": {"application/json": "{\"linear\": [], \"bilinear\": [{\"x\": \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[\\\\phi_i(x) \\\\phi_j(x)||]\u003C/marimo-tex\u003E\u003C/span\u003E\", \"coeff\": \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[\\\\hat{h}_{j}||]\u003C/marimo-tex\u003E\u003C/span\u003E\"}]}"}, "type": "data"}]}, {"code_hash": "453ebcf6515f877ceb7b2a658d12375e", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "(20,)\n", "type": "stream"}], "id": "Vxnm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a87599741a1767ce90200fd26315f28f", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe vector \u003Ccode\u003Ehv\u003C/code\u003E equals the matrix vector product \u003Cmarimo-tex class=\"arithmatex\"\u003E||(A h||)\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1065dae45d62c8ba05b4b1fc24251761", "console": [], "id": "ulZA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7d3a759059e96981cdc01df283e468fe", "console": [], "id": "ecfG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EFor the tensorproductspace we get 4 free indices, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_i(x)\\phi_j(y)||)\u003C/marimo-tex\u003E from the test function and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\phi_k(x)\\phi_l(y)||)\u003C/marimo-tex\u003E from the trial.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b1d091700bb0185e3db7708d63c576b5", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\phi_i(x) \\phi_k(x) \\phi_j(y) \\phi_l(y)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "db91a5de59054d2757a9ddce7ac9bd20", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EHence the inner product leads to a tensor with 4 indices.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c624fd8aa36017716fc9fbee00ada154", "console": [], "id": "aLJB", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-json-output data-json-data='[\u0026quot;text/plain:\u0026lt;jaxfun.galerkin.tensorproductspace.TPMatrix object at 0x7f78106f0e90\u0026gt;\u0026quot;]' data-value-types='\u0026quot;python\u0026quot;'\u003E\u003C/marimo-json-output\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "85b667fa6942e588b73ecb0cb624c6c6", "console": [], "id": "nHfw", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe \u003Ccode\u003ETPMatrix\u003C/code\u003E B is a tensor product matrix equal to the outer product of two regular matrices \u003Cmarimo-tex class=\"arithmatex\"\u003E||(b_{ijkl}=b^{(0)}_{ik}b^{(1)}_{jl}||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(b^{(0)}_{ik}=\\int_{\\Omega_x}\\phi_i(x)\\phi_k(x)dx||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(b^{(1)}_{jl}=\\int_{\\Omega_y}\\phi_j(y)\\phi_l(y)dy||)\u003C/marimo-tex\u003E, with \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\Omega = \\Omega_x \\times \\Omega_y||)\u003C/marimo-tex\u003E. The two smaller matrices are stored under \u003Ccode\u003EB.mats\u003C/code\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b80569ae0b311e5fc0c780048a2e4deb", "console": [], "id": "xXTn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EA multilayer perceptron neural network is defined as the function\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nM(\\boldsymbol{z}; \\theta) =  W^{L} \\sigma( W^{L-1} \\ldots \\sigma( W^1 \\boldsymbol{z} + \\boldsymbol{b}^1) \\ldots + \\boldsymbol{b}^{L-1})  + \\boldsymbol{b}^L\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\theta = \\{W^l, \\boldsymbol{b}^l\\}_{l=1}^L||)\u003C/marimo-tex\u003E represents all the unknowns in the model and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(W^l, \\boldsymbol{b}^l||)\u003C/marimo-tex\u003E represents the weights and biases on level \u003Cmarimo-tex class=\"arithmatex\"\u003E||(l||)\u003C/marimo-tex\u003E. The model input \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{z}||)\u003C/marimo-tex\u003E can be anything. For example, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{z}||)\u003C/marimo-tex\u003E can represent \u003Cmarimo-tex class=\"arithmatex\"\u003E||((x), (x, y), (x, y, z), (x, t), (x, y, t), ...||)\u003C/marimo-tex\u003E. For \u003Cmarimo-tex class=\"arithmatex\"\u003E||(Z||)\u003C/marimo-tex\u003E number of inputs the scalar function \u003Cmarimo-tex class=\"arithmatex\"\u003E||(M_{\\theta}: \\mathbb{R}^Z \\rightarrow \\mathbb{R}||)\u003C/marimo-tex\u003E. Similarly, a vector function in 2D space is simply \u003Cmarimo-tex class=\"arithmatex\"\u003E||(M_{\\theta}: \\mathbb{R}^Z \\rightarrow \\mathbb{R}^2||)\u003C/marimo-tex\u003E. The neural networks are represented in Jaxfun through a \u003Ccode\u003EFlaxFunction\u003C/code\u003E, and we can use them in any numer of dimensions and also of vector rank.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "9d8989df06a4a7cc7de6ab370ccd99ce", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[a(x; M1)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[b(x, y; M2)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{ {c} }(x, y; M3)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[a{\\left(x \\right)}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[b{\\left(x,y \\right)}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(c^{(0)}{\\left(x,y \\right)}\\right)\\mathbf{{i}} + \\left(c^{(1)}{\\left(x,y \\right)}\\right)\\mathbf{{j}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "pHFh", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.11"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.11%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20The%20form%20language%20in%20Jaxfun%20(WIP)%0A%0A%20%20%20%20Jaxfun%20consists%20of%20a%20rich%20form-language%20that%20is%20used%20to%20formulate%20problems.%20This%20language%20is%20built%20on%20top%20of%20Sympy's%20Function%20and%20Vector%20classes.%20The%20fundamental%20idea%20is%20that%20you%20choose%20a%20functionspace%20and%20then%20you%20create%20functions%20on%20that%20space.%20For%20the%20global%20Galerkin%20method%2C%20this%20means%20that%20you%20work%20with%20functions%20like%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20v(x)%20%3D%20%5Csum_%7Bi%3D0%7D%5E%7BN-1%7D%20%5Chat%7Bv%7D_i%20%5Cphi_i(x)%20%5Ctag%7B1%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20where%20%24v(x)%24%20is%20your%20function%2C%20%24%5Cphi_i(x)%24%20are%20%24N%24%20basis%20functions%20and%20%24%5Chat%7Bv%7D_i%24%20are%20%24N%24%20unknown%20expansion%20coefficients.%20The%20functionspace%20corresponding%20to%20this%20function%20is%20%24V%3D%5Ctext%7Bspan%7D%5C%7B%5Cphi_i%5C%7D_%7Bi%3D0%7D%5E%7BN-1%7D%24.%20When%20we%20say%20that%20%24v(x)%20%5Cin%20V%24%2C%20this%20means%20that%20%24v%24%20can%20be%20expanded%20as%20shown%20in%20Eq.%20(1)%2C%20but%20we%20do%20not%20necessarily%20know%20the%20coefficients.%0A%0A%20%20%20%20A%20tensorproductspace%20in%202D%20Cartesian%20space%20can%20be%20defined%20as%20%24T%20%3D%20V%20%5Cotimes%20V%24.%20A%20scalar%20function%20%24f%20%5Cin%20T%24%20is%20then%20defined%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20f(x%2C%20y)%20%3D%20%5Csum_%7Bi%3D0%7D%5E%7BN-1%7D%20%5Csum_%7Bj%3D0%7D%5E%7BN-1%7D%20%5Chat%7Bf%7D_%7Bij%7D%20%5Cphi_i(x)%20%5Cphi_j(y)%20%5Ctag%7B2%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20with%20the%20unknown%20matrix%20%24F%3D%5C%7B%5Chat%7Bf%7D_%7Bij%7D%5C%7D_%7Bi%2Cj%3D0%7D%5E%7BN-1%7D%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BN%20%5Ctimes%20N%7D%24.%0A%0A%20%20%20%20A%20vector%20tensorproductspace%20in%202D%20can%20be%20defined%20as%20%24W%20%3D%20T%20%5Ctimes%20T%24.%20A%20function%20%24%5Cboldsymbol%7Bw%7D%20%5Cin%20W%24%20is%20then%20defined%20as%0A%0A%20%20%20%20%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cboldsymbol%7Bw%7D(x%2C%20y)%20%3D%20w%5E%7B(0)%7D(x%2C%20y)%20%5Cboldsymbol%7Bi%7D%20%2B%20w%5E%7B(1)%7D(x%2C%20y)%20%5Cboldsymbol%7Bj%7D%20%5Ctag%7B3%7D%0A%20%20%20%20%5Cend%7Bequation%7D%0A%0A%20%20%20%20where%20%24%5Cboldsymbol%7Bi%7D%24%20and%20%24%5Cboldsymbol%7Bj%7D%24%20are%20Cartesian%20unit%20vectors%20in%20%24x%24%20and%20%24y%24%20direction%2C%20respectively%2C%20and%20%24w%5E%7B(i)%7D%24%20represents%20component%20%24i%24%20of%20the%20vector.%20That%20is%2C%20%24w%5E%7B(0)%7D%20%3D%20%5Cboldsymbol%7Bw%7D%20%5Ccdot%20%5Cboldsymbol%7Bi%7D%24%20and%20%24w%5E%7B(1)%7D%20%3D%20%5Cboldsymbol%7Bw%7D%20%5Ccdot%20%5Cboldsymbol%7Bj%7D%24.%20In%20Eq.%20(3)%20both%20%24w%5E%7B(0)%7D%24%20and%20%24w%5E%7B(1)%7D%24%20can%20be%20expanded%20as%20shown%20in%20Eq%20(2).%0A%0A%20%20%20%20In%20Jaxfun%20you%20choose%20the%20functionspace%20and%20then%20you%20create%20functions.%20Let's%20create%20samples%20of%20all%20the%20three%20Galerkin%20functions%20defined%20above%20(%24v(x)%2C%20f(x%2C%20y)%2C%20%5Cboldsymbol%7Bw%7D(x%2C%20y)%24)%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20IPython.display%20import%20display%0A%0A%20%20%20%20import%20jax.numpy%20as%20jnp%0A%0A%20%20%20%20from%20jaxfun.galerkin%20import%20(%0A%20%20%20%20%20%20%20%20JAXFunction%2C%0A%20%20%20%20%20%20%20%20Legendre%2C%0A%20%20%20%20%20%20%20%20TensorProduct%2C%0A%20%20%20%20%20%20%20%20TestFunction%2C%0A%20%20%20%20%20%20%20%20TrialFunction%2C%0A%20%20%20%20%20%20%20%20VectorTensorProductSpace%2C%0A%20%20%20%20%20%20%20%20inner%2C%0A%20%20%20%20)%0A%0A%20%20%20%20N%20%3D%2020%0A%20%20%20%20V%20%3D%20Legendre.Legendre(N%2C%20name%3D%22V%22%2C%20fun_str%3D%22phi%22)%0A%20%20%20%20T%20%3D%20TensorProduct(V%2C%20V%2C%20name%3D%22T%22)%0A%20%20%20%20W%20%3D%20VectorTensorProductSpace(T%2C%20name%3D%22W%22)%0A%20%20%20%20v%20%3D%20TestFunction(V%2C%20name%3D%22v%22)%0A%20%20%20%20f%20%3D%20TestFunction(T%2C%20name%3D%22f%22)%0A%20%20%20%20w%20%3D%20TestFunction(W%2C%20name%3D%22w%22)%0A%20%20%20%20display(v)%0A%20%20%20%20display(f)%0A%20%20%20%20display(w)%0A%20%20%20%20return%20JAXFunction%2C%20N%2C%20T%2C%20TrialFunction%2C%20V%2C%20W%2C%20display%2C%20f%2C%20inner%2C%20jnp%2C%20v%2C%20w%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20that%20the%20three%20displayed%20functions%20are%20all%20in%20unevaluated%20state.%20They%20appear%20as%20the%20left%20hand%20side%20of%20their%20definition.%20We%20see%20%24v(x%3B%20V)%24%2C%20which%20is%20the%20left%20hand%20side%20of%20Eq.%20(1)%2C%20with%20an%20additional%20%24V%24%20to%20show%20that%20this%20function%20has%20been%20created%20from%20the%20space%20named%20%22V%22.%0A%0A%20%20%20%20We%20can%20get%20the%20basisfunctions%20from%20the%20right%20hand%20side%20by%20evaluating%20the%20expressions%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(display%2C%20f%2C%20v%2C%20w)%3A%0A%20%20%20%20display(v.doit())%0A%20%20%20%20display(f.doit())%0A%20%20%20%20display(w.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20that%20since%20test%20functions%20do%20not%20contain%20any%20expansion%20coefficients%2C%20only%20the%20basis%20functions%20are%20shown.%20The%20superscript%20in%20parenthesis%20on%20the%20vector%20components%20shows%20the%20index%20into%20the%20vector%20of%20basis%20functions.%20Hence%2C%20%24%5Cphi_i%5E%7B(0)%7D(x)%24%20is%20the%20%24i%24'th%20basis%20function%20in%20the%20first%20component%20of%20the%20vector%20space%20%24W%24%2C%20and%20%24%5Cphi_j%5E%7B(1)%7D(y)%24%20is%20the%20%24j%24'th%20basis%20function%20in%20the%20second%20component%20of%20%24W%24.%0A%0A%20%20%20%20A%20trial%20function%20is%20similar%20to%20the%20test%20function%2C%20but%20represents%20the%20unknown%20solution%20that%20we%20are%20trying%20to%20find.%20The%20trial%20function%20is%20displayed%20exactly%20like%20the%20test%20function%2C%20but%20with%20a%20different%20index.%20Remember%20the%20test%20function%20on%20%24V%24%20was%20displayed%20as%20%24%5Cphi_i(x)%24.%20The%20trial%20function%20is%20displayed%20as%20%24%5Cphi_j(x)%24%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(TrialFunction%2C%20V%2C%20display)%3A%0A%20%20%20%20u%20%3D%20TrialFunction(V%2C%20name%3D%22u%22)%0A%20%20%20%20display(u)%0A%20%20%20%20display(u.doit())%0A%20%20%20%20return%20(u%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Trial%20and%20test%20functions%20are%20used%20together%20to%20assemble%20matrices%20in%20variational%20forms.%20Consider%20the%20L2%20inner%20product%0A%0A%20%20%20%20%24%24%0A%20%20%20%20(u%2C%20v)_%7BL%5E2(%5COmega)%7D%20%3D%20%5Cint_%7B%5COmega%7D%20%5Cphi_j(x)%5Cphi_i(x)dx%2C%20(i%2C%20j)%20%5Cin%20(0%2C%20%5Cldots%2C%20N-1)%20%5Ctimes%20(0%2C%20%5Cldots%2C%20N-1)%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24u%24%20is%20a%20trial%20function%20and%20%24v%24%20is%20a%20test%20function.%20The%20left%20hand%20side%20is%20in%20unevaluated%20form%20and%20the%20right%20hand%20side%20with%20the%20integral%20is%20in%20evaluated%20form%20using%20the%20basis%20functions%20retrieved%20from%20%60doit%60.%20This%20inner%20product%20results%20in%20a%20matrix%20%24A%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BN%20%5Ctimes%20N%7D%24%20with%20components%20%24a_%7Bij%7D%20%3D%20%5Cint_%7B%5COmega%7D%20%5Cphi_j(x)%5Cphi_i(x)dx%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(display%2C%20inner%2C%20u%2C%20v)%3A%0A%20%20%20%20A%20%3D%20inner(u%20*%20v)%0A%20%20%20%20display(u%20*%20v)%0A%20%20%20%20display((u%20*%20v).doit())%0A%20%20%20%20print(%22Shape%20of%20matrix%20A%20%3D%22%2C%20A.shape)%0A%20%20%20%20return%20(A%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20integral%20is%20computed%20using%20numerical%20quadrature%20on%20the%20quadrature%20points%20of%20the%20Legendre%20basis%20functions.%20For%20multidimensional%20problems%20we%20get%20tensor%20product%20matrices%2C%20that%20we%20will%20get%20back%20to%20in%20a%20little%20while.%20First%2C%20there%20is%20a%20third%20function%20that%20deserves%20some%20attentions.%20The%20%60JAXFunction%60s%20are%20complete%20Galerkin%20functions%2C%20containing%20also%20the%20expansion%20coefficients%20of%20the%20Galerkin%20function.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(JAXFunction%2C%20N%2C%20V%2C%20display%2C%20jnp)%3A%0A%20%20%20%20h%20%3D%20JAXFunction(jnp.ones(N)%2C%20V%2C%20name%3D%22h%22)%0A%20%20%20%20display(h)%0A%20%20%20%20display(h.doit(linear%3DTrue))%0A%20%20%20%20return%20(h%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20JAXFunction%20displayed%20above%20is%20shown%20first%20in%20unevaluated%20state.%20It%20is%20shown%20as%20a%20function%20of%20%24x%24%2C%20created%20on%20the%20function%20space%20%60V%60.%20When%20evaluated%20using%20%60doit%60%2C%20the%20JAXFunction%20returns%20the%20product%20of%20its%20expansion%20coefficients%20%24%5Chat%7Bh%7D_j%24%20and%20trial%20basis%20functions%20(using%20the%20same%20index%20as%20the%20trial%20function).%20Note%20that%20there%20is%20summation%20implied%20by%20repeating%20indices.%20Unlike%20the%20test%20and%20trial%20functions%2C%20the%20JAXFunction%20may%20appear%20in%20expressions%20in%20non-linear%20form.%20In%20that%20case%2C%20we%20do%20not%20expand%20the%20function%20with%20indices%2C%20but%20treat%20it%20like%20any%20other%20computable%20function.%20Note%20the%20missing%20keyword%20argument%20%60linear%3DTrue%60%20below%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(display%2C%20h)%3A%0A%20%20%20%20display(h.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20can%20create%20JAXFunctions%20for%20any%20of%20the%20three%20spaces%20created%20initially%20in%20this%20notebook%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(JAXFunction%2C%20N%2C%20T%2C%20display%2C%20jnp)%3A%0A%20%20%20%20b%20%3D%20JAXFunction(jnp.ones((N%2C%20N))%2C%20T%2C%20name%3D%22b%22)%0A%20%20%20%20display(b)%0A%20%20%20%20display(b.doit(linear%3DTrue))%0A%20%20%20%20display(b.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(JAXFunction%2C%20N%2C%20W%2C%20display%2C%20jnp)%3A%0A%20%20%20%20c%20%3D%20JAXFunction(jnp.ones((2%2C%20N%2C%20N))%2C%20W%2C%20name%3D%22c%22)%0A%20%20%20%20display(c)%0A%20%20%20%20display(c.doit(linear%3DTrue))%0A%20%20%20%20display(c.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Consider%20the%20%24L%5E2%24%20inner%20product%20%24(h%2C%20v)_%7BL%5E2(%5COmega)%7D%24.%20The%20integrand%20is%20now%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(h%2C%20v)%3A%0A%20%20%20%20(h%20*%20v).doit(linear%3DTrue)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20the%20repeated%20%24j%24%20index%2C%20which%20implies%20summation%20(Einstein%20summation%20convention).%20There%20is%20only%20one%20free%20index%2C%20%24i%24%2C%20and%20a%20such%20%60inner(h*v)%60%20returns%20a%20vector.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(h%2C%20v)%3A%0A%20%20%20%20from%20jaxfun.galerkin.forms%20import%20split%0A%0A%20%20%20%20split(v%20*%20h)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(h%2C%20inner%2C%20v)%3A%0A%20%20%20%20hv%20%3D%20inner(h%20*%20v)%0A%20%20%20%20print(hv.shape)%0A%20%20%20%20return%20(hv%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20vector%20%60hv%60%20equals%20the%20matrix%20vector%20product%20%24A%20h%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(A%2C%20h%2C%20hv%2C%20jnp)%3A%0A%20%20%20%20assert%20jnp.all(hv%20%3D%3D%20A%20%40%20h)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20For%20the%20tensorproductspace%20we%20get%204%20free%20indices%2C%20%24%5Cphi_i(x)%5Cphi_j(y)%24%20from%20the%20test%20function%20and%20%24%5Cphi_k(x)%5Cphi_l(y)%24%20from%20the%20trial.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(T%2C%20TrialFunction%2C%20display%2C%20f)%3A%0A%20%20%20%20g%20%3D%20TrialFunction(T%2C%20%22g%22)%0A%20%20%20%20display((g%20*%20f).doit())%0A%20%20%20%20return%20(g%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Hence%20the%20inner%20product%20leads%20to%20a%20tensor%20with%204%20indices.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(display%2C%20f%2C%20g%2C%20inner)%3A%0A%20%20%20%20B%20%3D%20inner(f%20*%20g)%0A%20%20%20%20display(B)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20%60TPMatrix%60%20B%20is%20a%20tensor%20product%20matrix%20equal%20to%20the%20outer%20product%20of%20two%20regular%20matrices%20%24b_%7Bijkl%7D%3Db%5E%7B(0)%7D_%7Bik%7Db%5E%7B(1)%7D_%7Bjl%7D%24%2C%20where%20%24b%5E%7B(0)%7D_%7Bik%7D%3D%5Cint_%7B%5COmega_x%7D%5Cphi_i(x)%5Cphi_k(x)dx%24%20and%20%24b%5E%7B(1)%7D_%7Bjl%7D%3D%5Cint_%7B%5COmega_y%7D%5Cphi_j(y)%5Cphi_l(y)dy%24%2C%20with%20%24%5COmega%20%3D%20%5COmega_x%20%5Ctimes%20%5COmega_y%24.%20The%20two%20smaller%20matrices%20are%20stored%20under%20%60B.mats%60.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20A%20multilayer%20perceptron%20neural%20network%20is%20defined%20as%20the%20function%0A%0A%20%20%20%20%24%24%0A%20%20%20%20M(%5Cboldsymbol%7Bz%7D%3B%20%5Ctheta)%20%3D%20%20W%5E%7BL%7D%20%5Csigma(%20W%5E%7BL-1%7D%20%5Cldots%20%5Csigma(%20W%5E1%20%5Cboldsymbol%7Bz%7D%20%2B%20%5Cboldsymbol%7Bb%7D%5E1)%20%5Cldots%20%2B%20%5Cboldsymbol%7Bb%7D%5E%7BL-1%7D)%20%20%2B%20%5Cboldsymbol%7Bb%7D%5EL%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24%5Ctheta%20%3D%20%5C%7BW%5El%2C%20%5Cboldsymbol%7Bb%7D%5El%5C%7D_%7Bl%3D1%7D%5EL%24%20represents%20all%20the%20unknowns%20in%20the%20model%20and%20%24W%5El%2C%20%5Cboldsymbol%7Bb%7D%5El%24%20represents%20the%20weights%20and%20biases%20on%20level%20%24l%24.%20The%20model%20input%20%24%5Cboldsymbol%7Bz%7D%24%20can%20be%20anything.%20For%20example%2C%20%24%5Cboldsymbol%7Bz%7D%24%20can%20represent%20%24(x)%2C%20(x%2C%20y)%2C%20(x%2C%20y%2C%20z)%2C%20(x%2C%20t)%2C%20(x%2C%20y%2C%20t)%2C%20...%24.%20For%20%24Z%24%20number%20of%20inputs%20the%20scalar%20function%20%24M_%7B%5Ctheta%7D%3A%20%5Cmathbb%7BR%7D%5EZ%20%5Crightarrow%20%5Cmathbb%7BR%7D%24.%20Similarly%2C%20a%20vector%20function%20in%202D%20space%20is%20simply%20%24M_%7B%5Ctheta%7D%3A%20%5Cmathbb%7BR%7D%5EZ%20%5Crightarrow%20%5Cmathbb%7BR%7D%5E2%24.%20The%20neural%20networks%20are%20represented%20in%20Jaxfun%20through%20a%20%60FlaxFunction%60%2C%20and%20we%20can%20use%20them%20in%20any%20numer%20of%20dimensions%20and%20also%20of%20vector%20rank.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(display)%3A%0A%20%20%20%20from%20jaxfun.pinns%20import%20FlaxFunction%2C%20MLPSpace%0A%0A%20%20%20%20M1%20%3D%20MLPSpace(%5B20%5D%2C%20dims%3D1%2C%20rank%3D0%2C%20name%3D%22M1%22)%0A%20%20%20%20M2%20%3D%20MLPSpace(%5B20%5D%2C%20dims%3D2%2C%20rank%3D0%2C%20name%3D%22M2%22)%0A%20%20%20%20M3%20%3D%20MLPSpace(%5B20%5D%2C%20dims%3D2%2C%20rank%3D1%2C%20name%3D%22M3%22)%0A%20%20%20%20f1%20%3D%20FlaxFunction(M1%2C%20name%3D%22a%22)%0A%20%20%20%20f2%20%3D%20FlaxFunction(M2%2C%20name%3D%22b%22)%0A%20%20%20%20f3%20%3D%20FlaxFunction(M3%2C%20name%3D%22c%22)%0A%20%20%20%20display(f1)%0A%20%20%20%20display(f2)%0A%20%20%20%20display(f3)%0A%20%20%20%20display(f1.doit())%0A%20%20%20%20display(f2.doit())%0A%20%20%20%20display(f3.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">9b866ead5cf9ead8c619f1f4274d194a</marimo-code-hash>
</body>
</html>
