<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>polar.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>polar</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/index-DFrkvKWf.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-Dcqqg9UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-sMh6mJ2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-Btv5Rh1v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-bBwmhqty.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-CoCQUAeM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cells-DPp5cDaO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/textarea-CRI7xDBj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/switch-dWLWbbtg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/mode-Bn7pdJvO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/ai-model-dropdown-Dk2SdB3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cell-link-B9b7J8QK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/datasource-CtyqtITR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/state-D4T75eZb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/MarimoErrorOutput-Lf9P8Fhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/html-to-image-CIQqSu-S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/focus-C1YokgL7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/LazyAnyLanguageCodeMirror-DgZ8iknE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/markdown-renderer-DJy8ww5d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/command-2ElA5IkO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/download-os8QlW6l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useRunCells-D2HBb4DB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/RenderHTML-D-of_-s7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/JsonOutput-PE5ko4gi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDeleteCell-DdRX94yC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/process-output-ByfLnk6j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/esm-Bmu2DhPy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/add-cell-with-ai-e_HMl7UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chat-display--jAB7huF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/column-preview-CXjSXUhP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/globals-BgACvYmr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/utilities.esm-MA1QpjVT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/floating-outline-BtdqbkUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useAddCell-CmuX2hOk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/readonly-python-code-WjTf6Pdd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/types-BRfQN3HL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/form-BidPUZUn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/index-CeUwN_0i.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "polar.py",
            "mode": "read",
            "version": "0.19.8",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "mo.md(r\"\"\"\n# Polar coordinates with jaxfun\n\nJust some tests to illustrate curvilinear coordinates.\n\"\"\")", "code_hash": "287ab9edc9461c48c5fcd5d080843a75", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "import numpy as np\nimport sympy as sp\n\nfrom jaxfun.coordinates import get_CoordSys\nfrom jaxfun.galerkin import (\n    FunctionSpace,\n    Legendre,\n    TensorProductSpace,\n    TestFunction,\n    TrialFunction,\n)\nfrom jaxfun.operators import Cross, Curl, Div, Dot, Grad\nfrom jaxfun.utils.common import Domain\n\nsystem = \"cylindrical\"\n_r, _theta, _z = sp.symbols(\"r,theta,z\", real=True, positive=True)\nif system == \"polar\":\n    C = get_CoordSys(\n        \"C\", sp.Lambda((_r, _theta), (_r * sp.cos(_theta), _r * sp.sin(_theta)))\n    )\n    R = FunctionSpace(\n        20,\n        Legendre.Legendre,\n        bcs={\"left\": {\"D\": 0}, \"right\": {\"D\": 0}},\n        domain=Domain(0.5, 1),\n        name=\"R\",\n        fun_str=\"phi\",\n    )\n    T = FunctionSpace(\n        20,\n        Legendre.Legendre,\n        bcs={\"left\": {\"D\": 0}, \"right\": {\"D\": 0}},\n        domain=Domain(0, np.pi),\n        name=\"T\",\n        fun_str=\"psi\",\n    )\n    P = TensorProductSpace((R, T), system=C, name=\"P\")\nelif system == \"cylindrical\":\n    # system = 'polar'\n    C = get_CoordSys(\n        \"C\",\n        sp.Lambda((_r, _theta, _z), (_r * sp.cos(_theta), _r * sp.sin(_theta), _z)),\n    )\n    R = FunctionSpace(\n        20,\n        Legendre.Legendre,\n        bcs={\"left\": {\"D\": 0}, \"right\": {\"D\": 0}},\n        domain=Domain(0.5, 1),\n        name=\"R\",\n        fun_str=\"phi\",\n    )\n    T = FunctionSpace(\n        20,\n        Legendre.Legendre,\n        bcs={\"left\": {\"D\": 0}, \"right\": {\"D\": 0}},\n        domain=Domain(0, np.pi),\n        name=\"T\",\n        fun_str=\"psi\",\n    )\n    Z = FunctionSpace(\n        20, Legendre.Legendre, domain=Domain(0, 1), name=\"Z\", fun_str=\"L\"\n    )\n    P = TensorProductSpace((R, T, Z), system=C, name=\"P\")", "code_hash": "28dd666ffbf8fd42c41266b49d245138", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "f = TrialFunction(P, name=\"f\")\ndu = Div(Grad(f))\ndu", "code_hash": "8126b13d4798a846f7b28a1453bdeaf7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "du.doit()", "code_hash": "d92b67e4157864ab1e853ff27b02cb7b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "from sympy import srepr\n\nsrepr(du)", "code_hash": "3f1030ebd8c8cf039692c121c678ae5c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "dv = sp.Add.fromiter(C._parent.base_scalars()) * Div(Grad(f))\ndv", "code_hash": "84b672ff78926488ca64bd5e87b3bcd7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "srepr(dv)", "code_hash": "48595a633a82a98c8b2d4f02334d6972", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "dv.doit()", "code_hash": "6e37420be4ad56fe08cd2c41a42e5f59", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "Grad(f).doit()", "code_hash": "1b103c601b694dcf1b63dc1f71be5eae", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "from jaxfun.galerkin.arguments import ScalarFunction\n\ng = ScalarFunction(\"g\", C)\ng", "code_hash": "b39ee5471058811998254684b2fd4b83", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "G = g.doit()\nG", "code_hash": "830ec09b64e0adcfaacc94a6d2253628", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "Div(Grad(g))", "code_hash": "070b186c6c4745727dd0bcad28e54144", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "Div(Grad(g)).doit()", "code_hash": "4bfdafc915d0253a488d5c84d3653e6e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "P.tensorname", "code_hash": "5b68b410a49a6ef3f1edfbedff66a8b2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Test operators on vectors\n\"\"\")", "code_hash": "b6911dba33e5c12e19f448862840d654", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "from jaxfun.galerkin import VectorTensorProductSpace\n\nV = VectorTensorProductSpace(P, name=\"V\")\nV.tensorname", "code_hash": "ff03367cdb5e90e613168245ae99d789", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "V.name", "code_hash": "4a8bc1a13a5077877d44c1c683cf1249", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "v = TestFunction(V, name=\"v\")\nv", "code_hash": "9177bc56aa5a3ee2b5a36116ac9947e1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "v.doit()", "code_hash": "36f71256f1014d410882f82d662dda2a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "mo.md(r\"\"\"\nGradient of vector:\n\"\"\")", "code_hash": "cf0ed61f2e91074cd5f64d722dfebf4e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "Grad(u)", "code_hash": "157e89a0c27a4d48a4057219822ab19f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote that the gradient of a vector $\\boldsymbol{u}$ is written as $\\nabla \\boldsymbol{u}$ since $\\nabla$ is interpreted as an operator and not a vector. If $\\nabla$ had instead been interpreted as a vector, then the gradient of $\\boldsymbol{u}$ would be written as $(\\nabla \\boldsymbol{u})^T$.\n\"\"\")", "code_hash": "ea2a1fb2e7d5a75c186c9f0b16818968", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ulZA", "name": "_"}, {"code": "Grad(u).doit()", "code_hash": "6e68a7f4370f6379a9817f6e2ad17114", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "mo.md(r\"\"\"\nDot product:\n\"\"\")", "code_hash": "c18eef35ce489cbd5acc8a6697feb2db", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Pvdt", "name": "_"}, {"code": "Dot(v, v).doit()", "code_hash": "333766993e3246a4da079af8884e21b2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "from IPython.display import display\n\nif C.dims == 3:\n    y = Cross(v, v).doit()\n    display(y)", "code_hash": "6019e6dd8e26c6edb161f3df2915cfa9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "if C.dims == 3:\n    z = Cross(v, C.b_r)\n    display(z)\n    display(z.doit())", "code_hash": "4ba5a5cf352f7bd7d81cd47b8713a8dd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "if C.dims == 3:\n    d = Curl(v)\n    F = C.to_cartesian(d.doit())\n    display(d)\n    display(d.doit())\n    display(F)", "code_hash": "5f0fe62a621ee7afd9e136f55d5f39ff", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "from jaxfun.galerkin.arguments import VectorFunction\n\nh = VectorFunction(\"h\", C)\nh", "code_hash": "ab32c829c36c54bc021ce5a125a22576", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "H = h.doit()\nH", "code_hash": "5f5cca6ad580bc84e6b8fd02e529bf5d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "w = TrialFunction(V, name=\"u\")\nvw = Dot(w, v)\nsrepr(vw)", "code_hash": "317f9b3361264e39266171fb28f7936a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "NCOB", "name": "_"}, {"code": "VW = vw.doit()\nVW", "code_hash": "618efe48508a2b4ae5230985661f48cf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "VW.args", "code_hash": "1bb0c995358f109643e0ae82cf316ecd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TRpd", "name": "_"}, {"code": "a = sp.separatevars(VW.args[1], dict=True, symbols=C._base_scalars)", "code_hash": "5698cae09c5d510f88aad32860cfee57", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "a", "code_hash": "0cc175b9c0f1b6a831c399e269772661", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dNNg", "name": "_"}, {"code": "import contextlib\n\nfor _r in C._base_scalars:\n    for j in a[_r].args:\n        with contextlib.suppress(AttributeError):\n            print(j.local_index)", "code_hash": "82b6baa5370c78973a330ff284804c8a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "from flax import nnx\n\nfrom jaxfun.operators import Identity, Outer\nfrom jaxfun.pinns import FlaxFunction, MLPSpace\n\nW = MLPSpace([8], dims=C.dims, rank=1, system=C, name=\"V\")\nQ = MLPSpace([8], dims=C.dims, rank=0, system=C, name=\"Q\")\nu = FlaxFunction(W, \"u\", rngs=nnx.Rngs(2002))  # Vector space for velocity\np = FlaxFunction(Q, \"p\", rngs=nnx.Rngs(1001))  # Scalar space for pressure", "code_hash": "d669ca0ce7196f355e40ee5fcee10544", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wlCL", "name": "_"}, {"code": "C.simplify(Div(u).doit())", "code_hash": "1441ec8921ea7c9a5cd35524cb957f79", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kqZH", "name": "_"}, {"code": "R1 = Dot(Grad(u), u) - Div(Grad(u)) + Grad(p)\nR1", "code_hash": "40461cd597533ddd058702ab2d0e52d2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wAgl", "name": "_"}, {"code": "I = Identity(C)\nR2 = Div(Outer(u, u)) - Div(\n    Grad(u) + Grad(u).T - sp.Rational(2, 3) * Div(u) * I + p * I\n)\nR2.doit()", "code_hash": "bd974da0f6a7ad05bbf35ea76cdc02f2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}, {"code": "if C.dims == 3:\n    R3 = Cross(Curl(u), u) + sp.S.Half * Grad(Dot(u, u)) - Div(Grad(u)) + Grad(p)\n    display(R3)\n    display(R3.doit())", "code_hash": "d51aaec9a2a78a205396506bf632fe36", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dGlV", "name": "_"}, {"code": "mo.md(r\"\"\"\nNote that the divergence of a dyadic $A$ is defined as $\\text{div}(A) = \\nabla \\cdot A$, since we choose to interpret $\\nabla$ as an operator and not a vector. This operator acts over the last axis of $A$. Some authors define $\\nabla$ as a vector and in that case the definition of the divergence is $\\nabla \\cdot A^T$. This is perfectly fine, just a difference in notation. With index notation in Cartesian coordinates the divergence may also be written as $\\frac{\\partial A_{ij}}{\\partial x_j}$ or $\\frac{\\partial A_{ij}}{\\partial x_j} \\boldsymbol{i}_i$, where $\\{\\boldsymbol{i}_j\\}_{j=1}^3$ are the 3 Cartesian unit vectors.\n\nHence we write Div(Grad(u)) as $\\nabla \\cdot \\nabla \\boldsymbol{u}$.\n\"\"\")", "code_hash": "362b6ead6ec1345e935eec368e98b355", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SdmI", "name": "_"}, {"code": "ut = Dot(u, C.get_contravariant_basis_vector(1)).doit()\nsp.srepr(ut)", "code_hash": "cfb9c55956678846e89e2ccda40db873", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lgWD", "name": "_"}, {"code": "uu = Outer(u, u).doit()", "code_hash": "3d3d9ecbb894782ec0beb4714d396c02", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yOPj", "name": "_"}, {"code": "uu", "code_hash": "6277e2a7446059985dc9bcf0a4ac1a8f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fwwy", "name": "_"}, {"code": "C.simplify(Dot(R1, C.get_contravariant_basis_vector(0)).doit())", "code_hash": "30ce5006e607b59502ba4e528310d549", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LJZf", "name": "_"}, {"code": "C.simplify(R1.doit())", "code_hash": "daa1928fc9be9413c3076e5f0c8ed1b2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "urSm", "name": "_"}, {"code": "r1 = Dot(R1, C.get_contravariant_basis_vector(0)).doit()\nr1", "code_hash": "5916335f2d5be490953063481df9e1b9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jxvo", "name": "_"}, {"code": "r1.expand()", "code_hash": "4ca2f3afaa005c6e7d5e960b7a6e9d90", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mWxS", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "CcZR", "name": "_"}], "metadata": {"marimo_version": "0.19.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "287ab9edc9461c48c5fcd5d080843a75", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"polar-coordinates-with-jaxfun\"\u003EPolar coordinates with jaxfun\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EJust some tests to illustrate curvilinear coordinates.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "28dd666ffbf8fd42c41266b49d245138", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8126b13d4798a846f7b28a1453bdeaf7", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\nabla\\cdot \\displaystyle \\nabla f(x, y, z; P)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d92b67e4157864ab1e853ff27b02cb7b", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[L_n(z) \\psi_m(\\theta) \\frac{d^{2}}{d r^{2}} \\phi_l(r) + \\phi_l(r) \\psi_m(\\theta) \\frac{d^{2}}{d z^{2}} L_n(z) + \\frac{L_n(z) \\psi_m(\\theta) \\frac{d}{d r} \\phi_l(r)}{r} + \\frac{L_n(z) \\phi_l(r) \\frac{d^{2}}{d \\theta^{2}} \\psi_m(\\theta)}{r^{2}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3f1030ebd8c8cf039692c121c678ae5c", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026quot;Div(Grad(TrialFunction(x, y, z, Symbol(\u0026#x27;P\u0026#x27;))))\u0026quot;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "84b672ff78926488ca64bd5e87b3bcd7", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(x + y + z\\right) \\nabla\\cdot \\displaystyle \\nabla f(x, y, z; P)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "48595a633a82a98c8b2d4f02334d6972", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026quot;Mul(Add(x, y, z), Div(Grad(TrialFunction(x, y, z, Symbol(\u0026#x27;P\u0026#x27;)))))\u0026quot;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "6e37420be4ad56fe08cd2c41a42e5f59", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r \\sin{\\left(\\theta \\right)} + r \\cos{\\left(\\theta \\right)} + z\\right) \\left(L_n(z) \\psi_m(\\theta) \\frac{d^{2}}{d r^{2}} \\phi_l(r) + \\phi_l(r) \\psi_m(\\theta) \\frac{d^{2}}{d z^{2}} L_n(z) + \\frac{L_n(z) \\psi_m(\\theta) \\frac{d}{d r} \\phi_l(r)}{r} + \\frac{L_n(z) \\phi_l(r) \\frac{d^{2}}{d \\theta^{2}} \\psi_m(\\theta)}{r^{2}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1b103c601b694dcf1b63dc1f71be5eae", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(L_n(z) \\psi_m(\\theta) \\frac{d}{d r} \\phi_l(r)\\right)\\mathbf{b_{r}} + \\left(\\frac{L_n(z) \\phi_l(r) \\frac{d}{d \\theta} \\psi_m(\\theta)}{r^{2}}\\right)\\mathbf{b_{\\theta}} + \\left(\\phi_l(r) \\psi_m(\\theta) \\frac{d}{d z} L_n(z)\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b39ee5471058811998254684b2fd4b83", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[g(x, y, z)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "830ec09b64e0adcfaacc94a6d2253628", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[G{\\left(r,\\theta,z \\right)}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "070b186c6c4745727dd0bcad28e54144", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\nabla\\cdot \\displaystyle \\nabla g(x, y, z)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4bfdafc915d0253a488d5c84d3653e6e", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\frac{\\partial^{2}}{\\partial r^{2}} G{\\left(r,\\theta,z \\right)} + \\frac{\\partial^{2}}{\\partial z^{2}} G{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial r} G{\\left(r,\\theta,z \\right)}}{r} + \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} G{\\left(r,\\theta,z \\right)}}{r^{2}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5b68b410a49a6ef3f1edfbedff66a8b2", "console": [], "id": "nWHF", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026#x27;R\u2297T\u2297Z\u0026#x27;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "b6911dba33e5c12e19f448862840d654", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"test-operators-on-vectors\"\u003ETest operators on vectors\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ff03367cdb5e90e613168245ae99d789", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026#x27;P\u00d7P\u00d7P\u0026#x27;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "4a8bc1a13a5077877d44c1c683cf1249", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026#x27;V\u0026#x27;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "9177bc56aa5a3ee2b5a36116ac9947e1", "console": [], "id": "qnkX", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{ {v} }(x, y, z; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "36f71256f1014d410882f82d662dda2a", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(L_k^{(0)}(z) \\phi_i^{(0)}(r) \\psi_j^{(0)}(\\theta)\\right)\\mathbf{b_{r}} + \\left(L_k^{(1)}(z) \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta)\\right)\\mathbf{b_{\\theta}} + \\left(L_k^{(2)}(z) \\phi_i^{(2)}(r) \\psi_j^{(2)}(\\theta)\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "cf0ed61f2e91074cd5f64d722dfebf4e", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EGradient of vector:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "157e89a0c27a4d48a4057219822ab19f", "console": [], "id": "DnEU", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\displaystyle \\nabla \\mathbf{ {u} }(x, y, z; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ea2a1fb2e7d5a75c186c9f0b16818968", "console": [], "id": "ulZA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote that the gradient of a vector \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{u}||)\u003C/marimo-tex\u003E is written as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla \\boldsymbol{u}||)\u003C/marimo-tex\u003E since \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E is interpreted as an operator and not a vector. If \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E had instead been interpreted as a vector, then the gradient of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\boldsymbol{u}||)\u003C/marimo-tex\u003E would be written as \u003Cmarimo-tex class=\"arithmatex\"\u003E||((\\nabla \\boldsymbol{u})^T||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6e68a7f4370f6379a9817f6e2ad17114", "console": [], "id": "ecfG", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{r}}\\right) + \\left(\\frac{- r u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(\\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{z}}\\right) + \\left(\\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{\\theta}{\\left(r,\\theta,z \\right)}}{r}\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{r}}\\right) + \\left(\\frac{\\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{r}{\\left(r,\\theta,z \\right)}}{r}}{r^{2}}\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(\\frac{\\partial}{\\partial z} u_{\\theta}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right) + \\left(\\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{r}}\\right) + \\left(\\frac{\\frac{\\partial}{\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(\\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{z}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c18eef35ce489cbd5acc8a6697feb2db", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDot product:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "333766993e3246a4da079af8884e21b2", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[r^{2} \\left(L_k^{(1)}(z)\\right)^{2} \\left(\\phi_i^{(1)}(r)\\right)^{2} \\left(\\psi_j^{(1)}(\\theta)\\right)^{2} + \\left(L_k^{(0)}(z)\\right)^{2} \\left(\\phi_i^{(0)}(r)\\right)^{2} \\left(\\psi_j^{(0)}(\\theta)\\right)^{2} + \\left(L_k^{(2)}(z)\\right)^{2} \\left(\\phi_i^{(2)}(r)\\right)^{2} \\left(\\psi_j^{(2)}(\\theta)\\right)^{2}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6019e6dd8e26c6edb161f3df2915cfa9", "console": [], "id": "aLJB", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(- r L_k^{(2)}(z) L_k^{(1)}(z) \\phi_i^{(2)}(r) \\phi_i^{(1)}(r) \\psi_j^{(2)}(\\theta) \\psi_j^{(1)}(\\theta) + r L_k^{(1)}(z) L_k^{(2)}(z) \\phi_i^{(1)}(r) \\phi_i^{(2)}(r) \\psi_j^{(1)}(\\theta) \\psi_j^{(2)}(\\theta)\\right)\\mathbf{b_{r}} + \\left(- \\frac{L_k^{(0)}(z) L_k^{(2)}(z) \\phi_i^{(0)}(r) \\phi_i^{(2)}(r) \\psi_j^{(0)}(\\theta) \\psi_j^{(2)}(\\theta)}{r} + \\frac{L_k^{(2)}(z) L_k^{(0)}(z) \\phi_i^{(2)}(r) \\phi_i^{(0)}(r) \\psi_j^{(2)}(\\theta) \\psi_j^{(0)}(\\theta)}{r}\\right)\\mathbf{b_{\\theta}} + \\left(- r L_k^{(1)}(z) L_k^{(0)}(z) \\phi_i^{(1)}(r) \\phi_i^{(0)}(r) \\psi_j^{(1)}(\\theta) \\psi_j^{(0)}(\\theta) + r L_k^{(0)}(z) L_k^{(1)}(z) \\phi_i^{(0)}(r) \\phi_i^{(1)}(r) \\psi_j^{(0)}(\\theta) \\psi_j^{(1)}(\\theta)\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "4ba5a5cf352f7bd7d81cd47b8713a8dd", "console": [], "id": "nHfw", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{ {v} }(x, y, z; V) \\times \\mathbf{b_{r}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\frac{L_k^{(2)}(z) \\phi_i^{(2)}(r) \\psi_j^{(2)}(\\theta)}{r}\\right)\\mathbf{b_{\\theta}} + \\left(- r L_k^{(1)}(z) \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta)\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "5f0fe62a621ee7afd9e136f55d5f39ff", "console": [], "id": "xXTn", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\nabla\\times \\mathbf{ {v} }(x, y, z; V)||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(- r \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta) \\frac{d}{d z} L_k^{(1)}(z) + \\frac{L_k^{(2)}(z) \\phi_i^{(2)}(r) \\frac{d}{d \\theta} \\psi_j^{(2)}(\\theta)}{r}\\right)\\mathbf{b_{r}} + \\left(- \\frac{L_k^{(2)}(z) \\psi_j^{(2)}(\\theta) \\frac{d}{d r} \\phi_i^{(2)}(r)}{r} + \\frac{\\phi_i^{(0)}(r) \\psi_j^{(0)}(\\theta) \\frac{d}{d z} L_k^{(0)}(z)}{r}\\right)\\mathbf{b_{\\theta}} + \\left(r \\left(L_k^{(1)}(z) \\psi_j^{(1)}(\\theta) \\frac{d}{d r} \\phi_i^{(1)}(r) + \\frac{L_k^{(1)}(z) \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta)}{r}\\right) - \\frac{- r L_k^{(1)}(z) \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta) + L_k^{(0)}(z) \\phi_i^{(0)}(r) \\frac{d}{d \\theta} \\psi_j^{(0)}(\\theta)}{r}\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(- r \\left(- \\frac{L_k^{(2)}(z) \\psi_j^{(2)}(\\theta) \\frac{d}{d r} \\phi_i^{(2)}(r)}{r} + \\frac{\\phi_i^{(0)}(r) \\psi_j^{(0)}(\\theta) \\frac{d}{d z} L_k^{(0)}(z)}{r}\\right) \\sin{\\left(\\theta \\right)} + \\left(- r \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta) \\frac{d}{d z} L_k^{(1)}(z) + \\frac{L_k^{(2)}(z) \\phi_i^{(2)}(r) \\frac{d}{d \\theta} \\psi_j^{(2)}(\\theta)}{r}\\right) \\cos{\\left(\\theta \\right)}\\right)\\mathbf{{i}} + \\left(r \\left(- \\frac{L_k^{(2)}(z) \\psi_j^{(2)}(\\theta) \\frac{d}{d r} \\phi_i^{(2)}(r)}{r} + \\frac{\\phi_i^{(0)}(r) \\psi_j^{(0)}(\\theta) \\frac{d}{d z} L_k^{(0)}(z)}{r}\\right) \\cos{\\left(\\theta \\right)} + \\left(- r \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta) \\frac{d}{d z} L_k^{(1)}(z) + \\frac{L_k^{(2)}(z) \\phi_i^{(2)}(r) \\frac{d}{d \\theta} \\psi_j^{(2)}(\\theta)}{r}\\right) \\sin{\\left(\\theta \\right)}\\right)\\mathbf{{j}} + \\left(r \\left(L_k^{(1)}(z) \\psi_j^{(1)}(\\theta) \\frac{d}{d r} \\phi_i^{(1)}(r) + \\frac{L_k^{(1)}(z) \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta)}{r}\\right) - \\frac{- r L_k^{(1)}(z) \\phi_i^{(1)}(r) \\psi_j^{(1)}(\\theta) + L_k^{(0)}(z) \\phi_i^{(0)}(r) \\frac{d}{d \\theta} \\psi_j^{(0)}(\\theta)}{r}\\right)\\mathbf{{k}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "ab32c829c36c54bc021ce5a125a22576", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\mathbf{{h}}(x, y, z)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5f5cca6ad580bc84e6b8fd02e529bf5d", "console": [], "id": "pHFh", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(H_{r}{\\left(r,\\theta,z \\right)}\\right)\\mathbf{b_{r}} + \\left(H_{\\theta}{\\left(r,\\theta,z \\right)}\\right)\\mathbf{b_{\\theta}} + \\left(H_{z}{\\left(r,\\theta,z \\right)}\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "317f9b3361264e39266171fb28f7936a", "console": [], "id": "NCOB", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026quot;Dot(TrialFunction(x, y, z, Symbol(\u0026#x27;V\u0026#x27;)), TestFunction(x, y, z, Symbol(\u0026#x27;V\u0026#x27;)))\u0026quot;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "618efe48508a2b4ae5230985661f48cf", "console": [], "id": "aqbW", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[r^{2} L_n^{(1)}(z) L_k^{(1)}(z) \\phi_l^{(1)}(r) \\phi_i^{(1)}(r) \\psi_m^{(1)}(\\theta) \\psi_j^{(1)}(\\theta) + L_n^{(0)}(z) L_k^{(0)}(z) \\phi_l^{(0)}(r) \\phi_i^{(0)}(r) \\psi_m^{(0)}(\\theta) \\psi_j^{(0)}(\\theta) + L_n^{(2)}(z) L_k^{(2)}(z) \\phi_l^{(2)}(r) \\phi_i^{(2)}(r) \\psi_m^{(2)}(\\theta) \\psi_j^{(2)}(\\theta)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1bb0c995358f109643e0ae82cf316ecd", "console": [], "id": "TRpd", "outputs": [{"data": {"application/json": "[\"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[L_n^{(0)}(z) L_k^{(0)}(z) \\\\phi_l^{(0)}(r) \\\\phi_i^{(0)}(r) \\\\psi_m^{(0)}(\\\\theta) \\\\psi_j^{(0)}(\\\\theta)||]\u003C/marimo-tex\u003E\u003C/span\u003E\", \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[L_n^{(2)}(z) L_k^{(2)}(z) \\\\phi_l^{(2)}(r) \\\\phi_i^{(2)}(r) \\\\psi_m^{(2)}(\\\\theta) \\\\psi_j^{(2)}(\\\\theta)||]\u003C/marimo-tex\u003E\u003C/span\u003E\", \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[r^{2} L_n^{(1)}(z) L_k^{(1)}(z) \\\\phi_l^{(1)}(r) \\\\phi_i^{(1)}(r) \\\\psi_m^{(1)}(\\\\theta) \\\\psi_j^{(1)}(\\\\theta)||]\u003C/marimo-tex\u003E\u003C/span\u003E\"]"}, "type": "data"}]}, {"code_hash": "5698cae09c5d510f88aad32860cfee57", "console": [], "id": "TXez", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "0cc175b9c0f1b6a831c399e269772661", "console": [], "id": "dNNg", "outputs": [{"data": {"application/json": "{\"r\": \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[\\\\phi_l^{(2)}(r) \\\\phi_i^{(2)}(r)||]\u003C/marimo-tex\u003E\u003C/span\u003E\", \"theta\": \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[\\\\psi_m^{(2)}(\\\\theta) \\\\psi_j^{(2)}(\\\\theta)||]\u003C/marimo-tex\u003E\u003C/span\u003E\", \"z\": \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[L_n^{(2)}(z) L_k^{(2)}(z)||]\u003C/marimo-tex\u003E\u003C/span\u003E\", \"coeff\": \"text/html:\u003Cspan class=\\\"markdown prose dark:prose-invert contents\\\"\u003E\u003Cmarimo-tex class=\\\"arithmatex\\\"\u003E||[1||]\u003C/marimo-tex\u003E\u003C/span\u003E\"}"}, "type": "data"}]}, {"code_hash": "82b6baa5370c78973a330ff284804c8a", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "0\n0\n1\n1\n2\n2\n", "type": "stream"}], "id": "yCnT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d669ca0ce7196f355e40ee5fcee10544", "console": [], "id": "wlCL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1441ec8921ea7c9a5cd35524cb957f79", "console": [], "id": "kqZH", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)} + \\frac{u_{r}{\\left(r,\\theta,z \\right)}}{r}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "40461cd597533ddd058702ab2d0e52d2", "console": [], "id": "wAgl", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[- \\nabla\\cdot \\displaystyle \\nabla \\mathbf{ {u} }(x, y, z; V) + \\displaystyle \\nabla \\mathbf{ {u} }(x, y, z; V) \\cdot \\mathbf{ {u} }(x, y, z; V) + \\displaystyle \\nabla p(x, y, z; Q)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "bd974da0f6a7ad05bbf35ea76cdc02f2", "console": [], "id": "rEll", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r \\left(p{\\left(r,\\theta,z \\right)} - \\frac{2 \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 u_{r}{\\left(r,\\theta,z \\right)}}{3 r} + \\frac{2 \\left(\\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{r}{\\left(r,\\theta,z \\right)}}{r}\\right)}{r^{2}}\\right) - r u_{\\theta}^{2}{\\left(r,\\theta,z \\right)} + 2 u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial}{\\partial r} p{\\left(r,\\theta,z \\right)} - \\frac{4 \\frac{\\partial^{2}}{\\partial r^{2}} u_{r}{\\left(r,\\theta,z \\right)}}{3} - 2 \\frac{\\partial^{2}}{\\partial z^{2}} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{2 \\frac{\\partial^{2}}{\\partial \\theta\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)}}{3} + \\frac{2 \\frac{\\partial^{2}}{\\partial z\\partial r} u_{z}{\\left(r,\\theta,z \\right)}}{3} - \\frac{p{\\left(r,\\theta,z \\right)} + \\frac{4 \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 u_{r}{\\left(r,\\theta,z \\right)}}{3 r}}{r} + \\frac{u_{r}^{2}{\\left(r,\\theta,z \\right)}}{r} + \\frac{2 \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{3 r} - \\frac{2 \\left(- r \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{r}{\\left(r,\\theta,z \\right)}\\right)}{r^{2}} - \\frac{2 u_{r}{\\left(r,\\theta,z \\right)}}{3 r^{2}}\\right)\\mathbf{b_{r}} + \\left(u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + 2 u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{\\theta}{\\left(r,\\theta,z \\right)} - \\frac{\\partial}{\\partial \\theta} p{\\left(r,\\theta,z \\right)} - 2 \\frac{\\partial^{2}}{\\partial r^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{2 \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)}}{3} - 2 \\frac{\\partial^{2}}{\\partial z^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{2 \\frac{\\partial^{2}}{\\partial \\theta\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{3} + \\frac{2 \\frac{\\partial^{2}}{\\partial z\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)}}{3} - \\frac{2 \\left(2 \\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{2 u_{\\theta}{\\left(r,\\theta,z \\right)}}{r}\\right)}{r} + \\frac{3 u_{r}{\\left(r,\\theta,z \\right)} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r} + \\frac{2 \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{3 r} - \\frac{2 \\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r} - \\frac{2 \\left(\\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r}\\right)}{r^{2}} + \\frac{2 u_{\\theta}{\\left(r,\\theta,z \\right)}}{r^{2}} - \\frac{2 \\left(- r u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}\\right)}{r^{3}}\\right)\\mathbf{b_{\\theta}} + \\left(u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + 2 u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)} - \\frac{\\partial}{\\partial z} p{\\left(r,\\theta,z \\right)} - 2 \\frac{\\partial^{2}}{\\partial r^{2}} u_{z}{\\left(r,\\theta,z \\right)} - \\frac{4 \\frac{\\partial^{2}}{\\partial z^{2}} u_{z}{\\left(r,\\theta,z \\right)}}{3} + \\frac{2 \\frac{\\partial^{2}}{\\partial z\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{3} + \\frac{2 \\frac{\\partial^{2}}{\\partial z\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)}}{3} + \\frac{u_{r}{\\left(r,\\theta,z \\right)} u_{z}{\\left(r,\\theta,z \\right)}}{r} + \\frac{2 \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)}}{3 r} - \\frac{2 \\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)}}{r} - \\frac{2 \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{z}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d51aaec9a2a78a205396506bf632fe36", "console": [], "id": "dGlV", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\nabla\\times \\mathbf{ {u} }(x, y, z; V)\\right) \\times \\mathbf{ {u} }(x, y, z; V) - \\nabla\\cdot \\displaystyle \\nabla \\mathbf{ {u} }(x, y, z; V) + \\displaystyle \\nabla p(x, y, z; Q) + \\frac{\\displaystyle \\nabla \\mathbf{ {u} }(x, y, z; V) \\cdot \\mathbf{ {u} }(x, y, z; V)}{2}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(r^{2} u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + r \\left(\\frac{\\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)}}{r} - \\frac{\\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)}}{r}\\right) u_{z}{\\left(r,\\theta,z \\right)} - r \\left(r \\left(\\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{\\theta}{\\left(r,\\theta,z \\right)}}{r}\\right) - \\frac{- r u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r}\\right) u_{\\theta}{\\left(r,\\theta,z \\right)} + r u_{\\theta}^{2}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial r} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{r}{\\left(r,\\theta,z \\right)}}{r}}{r} - \\frac{\\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{r} - \\frac{- r \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\mathbf{b_{r}} + \\left(- \\frac{\\partial^{2}}{\\partial r^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\left(r \\left(\\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{\\theta}{\\left(r,\\theta,z \\right)}}{r}\\right) - \\frac{- r u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r}\\right) u_{r}{\\left(r,\\theta,z \\right)}}{r} - \\frac{\\left(- r \\frac{\\partial}{\\partial z} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)}}{r}\\right) u_{z}{\\left(r,\\theta,z \\right)}}{r} - \\frac{2 \\left(\\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{\\theta}{\\left(r,\\theta,z \\right)}}{r}\\right)}{r} - \\frac{\\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r} - \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r}}{r^{2}} + \\frac{2 r^{2} u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + 2 u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)} + 2 u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)}}{2 r^{2}} + \\frac{u_{\\theta}{\\left(r,\\theta,z \\right)}}{r^{2}} + \\frac{\\frac{\\partial}{\\partial \\theta} p{\\left(r,\\theta,z \\right)}}{r^{2}} - \\frac{- r u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r^{3}}\\right)\\mathbf{b_{\\theta}} + \\left(r^{2} u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{\\theta}{\\left(r,\\theta,z \\right)} - r \\left(\\frac{\\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)}}{r} - \\frac{\\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)}}{r}\\right) u_{r}{\\left(r,\\theta,z \\right)} + r \\left(- r \\frac{\\partial}{\\partial z} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)}}{r}\\right) u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial z} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{z}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{z}{\\left(r,\\theta,z \\right)} - \\frac{\\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)}}{r} - \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{z}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "362b6ead6ec1345e935eec368e98b355", "console": [], "id": "SdmI", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENote that the divergence of a dyadic \u003Cmarimo-tex class=\"arithmatex\"\u003E||(A||)\u003C/marimo-tex\u003E is defined as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\text{div}(A) = \\nabla \\cdot A||)\u003C/marimo-tex\u003E, since we choose to interpret \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E as an operator and not a vector. This operator acts over the last axis of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(A||)\u003C/marimo-tex\u003E. Some authors define \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla||)\u003C/marimo-tex\u003E as a vector and in that case the definition of the divergence is \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla \\cdot A^T||)\u003C/marimo-tex\u003E. This is perfectly fine, just a difference in notation. With index notation in Cartesian coordinates the divergence may also be written as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\frac{\\partial A_{ij}}{\\partial x_j}||)\u003C/marimo-tex\u003E or \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\frac{\\partial A_{ij}}{\\partial x_j} \\boldsymbol{i}_i||)\u003C/marimo-tex\u003E, where \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\{\\boldsymbol{i}_j\\}_{j=1}^3||)\u003C/marimo-tex\u003E are the 3 Cartesian unit vectors.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EHence we write Div(Grad(u)) as \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla \\cdot \\nabla \\boldsymbol{u}||)\u003C/marimo-tex\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "cfb9c55956678846e89e2ccda40db873", "console": [], "id": "lgWD", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026quot;Function(\u0026#x27;u_theta\u0026#x27;)(r, theta, z)\u0026quot;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "3d3d9ecbb894782ec0beb4714d396c02", "console": [], "id": "yOPj", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6277e2a7446059985dc9bcf0a4ac1a8f", "console": [], "id": "fwwy", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(u_{r}^{2}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{r}}\\right) + \\left(u_{r}{\\left(r,\\theta,z \\right)} u_{\\theta}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(u_{r}{\\left(r,\\theta,z \\right)} u_{z}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{r}}\u2297\\mathbf{b_{z}}\\right) + \\left(u_{r}{\\left(r,\\theta,z \\right)} u_{\\theta}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{r}}\\right) + \\left(u_{\\theta}^{2}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(u_{\\theta}{\\left(r,\\theta,z \\right)} u_{z}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{\\theta}}\u2297\\mathbf{b_{z}}\\right) + \\left(u_{r}{\\left(r,\\theta,z \\right)} u_{z}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{r}}\\right) + \\left(u_{\\theta}{\\left(r,\\theta,z \\right)} u_{z}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{\\theta}}\\right) + \\left(u_{z}^{2}{\\left(r,\\theta,z \\right)}\\right)\\left(\\mathbf{b_{z}}\u2297\\mathbf{b_{z}}\\right)||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "30ce5006e607b59502ba4e528310d549", "console": [], "id": "LJZf", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\frac{r^{2} \\left(- \\left(r u_{\\theta}{\\left(r,\\theta,z \\right)} - \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}\\right) u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial r} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{r}{\\left(r,\\theta,z \\right)}\\right) - r \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + 2 r \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "daa1928fc9be9413c3076e5f0c8ed1b2", "console": [], "id": "urSm", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(\\frac{r^{2} \\left(- \\left(r u_{\\theta}{\\left(r,\\theta,z \\right)} - \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}\\right) u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial r} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{r}{\\left(r,\\theta,z \\right)}\\right) - r \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + 2 r \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\mathbf{b_{r}} + \\left(u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{\\theta}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{2 u_{r}{\\left(r,\\theta,z \\right)} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r} - \\frac{3 \\frac{\\partial}{\\partial r} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r} + \\frac{\\frac{\\partial}{\\partial \\theta} p{\\left(r,\\theta,z \\right)}}{r^{2}} - \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r^{2}} - \\frac{2 \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}}{r^{3}}\\right)\\mathbf{b_{\\theta}} + \\left(u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{z}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{z}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial z} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{z}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{z}{\\left(r,\\theta,z \\right)} - \\frac{\\frac{\\partial}{\\partial r} u_{z}{\\left(r,\\theta,z \\right)}}{r} - \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{z}{\\left(r,\\theta,z \\right)}}{r^{2}}\\right)\\mathbf{b_{z}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5916335f2d5be490953063481df9e1b9", "console": [], "id": "jxvo", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\left(- r u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)}\\right) u_{\\theta}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial r} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{u_{r}{\\left(r,\\theta,z \\right)}}{r}}{r} - \\frac{\\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{r} - \\frac{- r \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)} + \\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4ca2f3afaa005c6e7d5e960b7a6e9d90", "console": [], "id": "mWxS", "outputs": [{"data": {"text/html": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[- r u_{\\theta}^{2}{\\left(r,\\theta,z \\right)} + u_{r}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)} + u_{\\theta}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial \\theta} u_{r}{\\left(r,\\theta,z \\right)} + u_{z}{\\left(r,\\theta,z \\right)} \\frac{\\partial}{\\partial z} u_{r}{\\left(r,\\theta,z \\right)} + \\frac{\\partial}{\\partial r} p{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial r^{2}} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\partial^{2}}{\\partial z^{2}} u_{r}{\\left(r,\\theta,z \\right)} - \\frac{\\frac{\\partial}{\\partial r} u_{r}{\\left(r,\\theta,z \\right)}}{r} + \\frac{2 \\frac{\\partial}{\\partial \\theta} u_{\\theta}{\\left(r,\\theta,z \\right)}}{r} + \\frac{u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}} - \\frac{\\frac{\\partial^{2}}{\\partial \\theta^{2}} u_{r}{\\left(r,\\theta,z \\right)}}{r^{2}}||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "CcZR", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.8%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Polar%20coordinates%20with%20jaxfun%0A%0A%20%20%20%20Just%20some%20tests%20to%20illustrate%20curvilinear%20coordinates.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20sympy%20as%20sp%0A%0A%20%20%20%20from%20jaxfun.coordinates%20import%20get_CoordSys%0A%20%20%20%20from%20jaxfun.galerkin%20import%20(%0A%20%20%20%20%20%20%20%20FunctionSpace%2C%0A%20%20%20%20%20%20%20%20Legendre%2C%0A%20%20%20%20%20%20%20%20TensorProductSpace%2C%0A%20%20%20%20%20%20%20%20TestFunction%2C%0A%20%20%20%20%20%20%20%20TrialFunction%2C%0A%20%20%20%20)%0A%20%20%20%20from%20jaxfun.operators%20import%20Cross%2C%20Curl%2C%20Div%2C%20Dot%2C%20Grad%0A%20%20%20%20from%20jaxfun.utils.common%20import%20Domain%0A%0A%20%20%20%20system%20%3D%20%22cylindrical%22%0A%20%20%20%20_r%2C%20_theta%2C%20_z%20%3D%20sp.symbols(%22r%2Ctheta%2Cz%22%2C%20real%3DTrue%2C%20positive%3DTrue)%0A%20%20%20%20if%20system%20%3D%3D%20%22polar%22%3A%0A%20%20%20%20%20%20%20%20C%20%3D%20get_CoordSys(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22C%22%2C%20sp.Lambda((_r%2C%20_theta)%2C%20(_r%20*%20sp.cos(_theta)%2C%20_r%20*%20sp.sin(_theta)))%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20R%20%3D%20FunctionSpace(%0A%20%20%20%20%20%20%20%20%20%20%20%2020%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20Legendre.Legendre%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20bcs%3D%7B%22left%22%3A%20%7B%22D%22%3A%200%7D%2C%20%22right%22%3A%20%7B%22D%22%3A%200%7D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20domain%3DDomain(0.5%2C%201)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D%22R%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fun_str%3D%22phi%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20T%20%3D%20FunctionSpace(%0A%20%20%20%20%20%20%20%20%20%20%20%2020%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20Legendre.Legendre%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20bcs%3D%7B%22left%22%3A%20%7B%22D%22%3A%200%7D%2C%20%22right%22%3A%20%7B%22D%22%3A%200%7D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20domain%3DDomain(0%2C%20np.pi)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D%22T%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fun_str%3D%22psi%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20P%20%3D%20TensorProductSpace((R%2C%20T)%2C%20system%3DC%2C%20name%3D%22P%22)%0A%20%20%20%20elif%20system%20%3D%3D%20%22cylindrical%22%3A%0A%20%20%20%20%20%20%20%20%23%20system%20%3D%20'polar'%0A%20%20%20%20%20%20%20%20C%20%3D%20get_CoordSys(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22C%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20sp.Lambda((_r%2C%20_theta%2C%20_z)%2C%20(_r%20*%20sp.cos(_theta)%2C%20_r%20*%20sp.sin(_theta)%2C%20_z))%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20R%20%3D%20FunctionSpace(%0A%20%20%20%20%20%20%20%20%20%20%20%2020%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20Legendre.Legendre%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20bcs%3D%7B%22left%22%3A%20%7B%22D%22%3A%200%7D%2C%20%22right%22%3A%20%7B%22D%22%3A%200%7D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20domain%3DDomain(0.5%2C%201)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D%22R%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fun_str%3D%22phi%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20T%20%3D%20FunctionSpace(%0A%20%20%20%20%20%20%20%20%20%20%20%2020%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20Legendre.Legendre%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20bcs%3D%7B%22left%22%3A%20%7B%22D%22%3A%200%7D%2C%20%22right%22%3A%20%7B%22D%22%3A%200%7D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20domain%3DDomain(0%2C%20np.pi)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D%22T%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fun_str%3D%22psi%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20Z%20%3D%20FunctionSpace(%0A%20%20%20%20%20%20%20%20%20%20%20%2020%2C%20Legendre.Legendre%2C%20domain%3DDomain(0%2C%201)%2C%20name%3D%22Z%22%2C%20fun_str%3D%22L%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20P%20%3D%20TensorProductSpace((R%2C%20T%2C%20Z)%2C%20system%3DC%2C%20name%3D%22P%22)%0A%20%20%20%20return%20C%2C%20Cross%2C%20Curl%2C%20Div%2C%20Dot%2C%20Grad%2C%20P%2C%20TestFunction%2C%20TrialFunction%2C%20sp%0A%0A%0A%40app.cell%0Adef%20_(Div%2C%20Grad%2C%20P%2C%20TrialFunction)%3A%0A%20%20%20%20f%20%3D%20TrialFunction(P%2C%20name%3D%22f%22)%0A%20%20%20%20du%20%3D%20Div(Grad(f))%0A%20%20%20%20du%0A%20%20%20%20return%20du%2C%20f%0A%0A%0A%40app.cell%0Adef%20_(du)%3A%0A%20%20%20%20du.doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(du)%3A%0A%20%20%20%20from%20sympy%20import%20srepr%0A%0A%20%20%20%20srepr(du)%0A%20%20%20%20return%20(srepr%2C)%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Div%2C%20Grad%2C%20f%2C%20sp)%3A%0A%20%20%20%20dv%20%3D%20sp.Add.fromiter(C._parent.base_scalars())%20*%20Div(Grad(f))%0A%20%20%20%20dv%0A%20%20%20%20return%20(dv%2C)%0A%0A%0A%40app.cell%0Adef%20_(dv%2C%20srepr)%3A%0A%20%20%20%20srepr(dv)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(dv)%3A%0A%20%20%20%20dv.doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Grad%2C%20f)%3A%0A%20%20%20%20Grad(f).doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C)%3A%0A%20%20%20%20from%20jaxfun.galerkin.arguments%20import%20ScalarFunction%0A%0A%20%20%20%20g%20%3D%20ScalarFunction(%22g%22%2C%20C)%0A%20%20%20%20g%0A%20%20%20%20return%20(g%2C)%0A%0A%0A%40app.cell%0Adef%20_(g)%3A%0A%20%20%20%20G%20%3D%20g.doit()%0A%20%20%20%20G%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Div%2C%20Grad%2C%20g)%3A%0A%20%20%20%20Div(Grad(g))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Div%2C%20Grad%2C%20g)%3A%0A%20%20%20%20Div(Grad(g)).doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(P)%3A%0A%20%20%20%20P.tensorname%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Test%20operators%20on%20vectors%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(P)%3A%0A%20%20%20%20from%20jaxfun.galerkin%20import%20VectorTensorProductSpace%0A%0A%20%20%20%20V%20%3D%20VectorTensorProductSpace(P%2C%20name%3D%22V%22)%0A%20%20%20%20V.tensorname%0A%20%20%20%20return%20(V%2C)%0A%0A%0A%40app.cell%0Adef%20_(V)%3A%0A%20%20%20%20V.name%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(TestFunction%2C%20V)%3A%0A%20%20%20%20v%20%3D%20TestFunction(V%2C%20name%3D%22v%22)%0A%20%20%20%20v%0A%20%20%20%20return%20(v%2C)%0A%0A%0A%40app.cell%0Adef%20_(v)%3A%0A%20%20%20%20v.doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Gradient%20of%20vector%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Grad%2C%20u)%3A%0A%20%20%20%20Grad(u)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20that%20the%20gradient%20of%20a%20vector%20%24%5Cboldsymbol%7Bu%7D%24%20is%20written%20as%20%24%5Cnabla%20%5Cboldsymbol%7Bu%7D%24%20since%20%24%5Cnabla%24%20is%20interpreted%20as%20an%20operator%20and%20not%20a%20vector.%20If%20%24%5Cnabla%24%20had%20instead%20been%20interpreted%20as%20a%20vector%2C%20then%20the%20gradient%20of%20%24%5Cboldsymbol%7Bu%7D%24%20would%20be%20written%20as%20%24(%5Cnabla%20%5Cboldsymbol%7Bu%7D)%5ET%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Grad%2C%20u)%3A%0A%20%20%20%20Grad(u).doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Dot%20product%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Dot%2C%20v)%3A%0A%20%20%20%20Dot(v%2C%20v).doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Cross%2C%20v)%3A%0A%20%20%20%20from%20IPython.display%20import%20display%0A%0A%20%20%20%20if%20C.dims%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20y%20%3D%20Cross(v%2C%20v).doit()%0A%20%20%20%20%20%20%20%20display(y)%0A%20%20%20%20return%20(display%2C)%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Cross%2C%20display%2C%20v)%3A%0A%20%20%20%20if%20C.dims%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20z%20%3D%20Cross(v%2C%20C.b_r)%0A%20%20%20%20%20%20%20%20display(z)%0A%20%20%20%20%20%20%20%20display(z.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Curl%2C%20display%2C%20v)%3A%0A%20%20%20%20if%20C.dims%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20d%20%3D%20Curl(v)%0A%20%20%20%20%20%20%20%20F%20%3D%20C.to_cartesian(d.doit())%0A%20%20%20%20%20%20%20%20display(d)%0A%20%20%20%20%20%20%20%20display(d.doit())%0A%20%20%20%20%20%20%20%20display(F)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C)%3A%0A%20%20%20%20from%20jaxfun.galerkin.arguments%20import%20VectorFunction%0A%0A%20%20%20%20h%20%3D%20VectorFunction(%22h%22%2C%20C)%0A%20%20%20%20h%0A%20%20%20%20return%20(h%2C)%0A%0A%0A%40app.cell%0Adef%20_(h)%3A%0A%20%20%20%20H%20%3D%20h.doit()%0A%20%20%20%20H%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Dot%2C%20TrialFunction%2C%20V%2C%20srepr%2C%20v)%3A%0A%20%20%20%20w%20%3D%20TrialFunction(V%2C%20name%3D%22u%22)%0A%20%20%20%20vw%20%3D%20Dot(w%2C%20v)%0A%20%20%20%20srepr(vw)%0A%20%20%20%20return%20(vw%2C)%0A%0A%0A%40app.cell%0Adef%20_(vw)%3A%0A%20%20%20%20VW%20%3D%20vw.doit()%0A%20%20%20%20VW%0A%20%20%20%20return%20(VW%2C)%0A%0A%0A%40app.cell%0Adef%20_(VW)%3A%0A%20%20%20%20VW.args%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20VW%2C%20sp)%3A%0A%20%20%20%20a%20%3D%20sp.separatevars(VW.args%5B1%5D%2C%20dict%3DTrue%2C%20symbols%3DC._base_scalars)%0A%20%20%20%20return%20(a%2C)%0A%0A%0A%40app.cell%0Adef%20_(a)%3A%0A%20%20%20%20a%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20a)%3A%0A%20%20%20%20import%20contextlib%0A%0A%20%20%20%20for%20_r%20in%20C._base_scalars%3A%0A%20%20%20%20%20%20%20%20for%20j%20in%20a%5B_r%5D.args%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20with%20contextlib.suppress(AttributeError)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(j.local_index)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C)%3A%0A%20%20%20%20from%20flax%20import%20nnx%0A%0A%20%20%20%20from%20jaxfun.operators%20import%20Identity%2C%20Outer%0A%20%20%20%20from%20jaxfun.pinns%20import%20FlaxFunction%2C%20MLPSpace%0A%0A%20%20%20%20W%20%3D%20MLPSpace(%5B8%5D%2C%20dims%3DC.dims%2C%20rank%3D1%2C%20system%3DC%2C%20name%3D%22V%22)%0A%20%20%20%20Q%20%3D%20MLPSpace(%5B8%5D%2C%20dims%3DC.dims%2C%20rank%3D0%2C%20system%3DC%2C%20name%3D%22Q%22)%0A%20%20%20%20u%20%3D%20FlaxFunction(W%2C%20%22u%22%2C%20rngs%3Dnnx.Rngs(2002))%20%20%23%20Vector%20space%20for%20velocity%0A%20%20%20%20p%20%3D%20FlaxFunction(Q%2C%20%22p%22%2C%20rngs%3Dnnx.Rngs(1001))%20%20%23%20Scalar%20space%20for%20pressure%0A%20%20%20%20return%20Identity%2C%20Outer%2C%20p%2C%20u%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Div%2C%20u)%3A%0A%20%20%20%20C.simplify(Div(u).doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Div%2C%20Dot%2C%20Grad%2C%20p%2C%20u)%3A%0A%20%20%20%20R1%20%3D%20Dot(Grad(u)%2C%20u)%20-%20Div(Grad(u))%20%2B%20Grad(p)%0A%20%20%20%20R1%0A%20%20%20%20return%20(R1%2C)%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Div%2C%20Grad%2C%20Identity%2C%20Outer%2C%20p%2C%20sp%2C%20u)%3A%0A%20%20%20%20I%20%3D%20Identity(C)%0A%20%20%20%20R2%20%3D%20Div(Outer(u%2C%20u))%20-%20Div(%0A%20%20%20%20%20%20%20%20Grad(u)%20%2B%20Grad(u).T%20-%20sp.Rational(2%2C%203)%20*%20Div(u)%20*%20I%20%2B%20p%20*%20I%0A%20%20%20%20)%0A%20%20%20%20R2.doit()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Cross%2C%20Curl%2C%20Div%2C%20Dot%2C%20Grad%2C%20display%2C%20p%2C%20sp%2C%20u)%3A%0A%20%20%20%20if%20C.dims%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20R3%20%3D%20Cross(Curl(u)%2C%20u)%20%2B%20sp.S.Half%20*%20Grad(Dot(u%2C%20u))%20-%20Div(Grad(u))%20%2B%20Grad(p)%0A%20%20%20%20%20%20%20%20display(R3)%0A%20%20%20%20%20%20%20%20display(R3.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Note%20that%20the%20divergence%20of%20a%20dyadic%20%24A%24%20is%20defined%20as%20%24%5Ctext%7Bdiv%7D(A)%20%3D%20%5Cnabla%20%5Ccdot%20A%24%2C%20since%20we%20choose%20to%20interpret%20%24%5Cnabla%24%20as%20an%20operator%20and%20not%20a%20vector.%20This%20operator%20acts%20over%20the%20last%20axis%20of%20%24A%24.%20Some%20authors%20define%20%24%5Cnabla%24%20as%20a%20vector%20and%20in%20that%20case%20the%20definition%20of%20the%20divergence%20is%20%24%5Cnabla%20%5Ccdot%20A%5ET%24.%20This%20is%20perfectly%20fine%2C%20just%20a%20difference%20in%20notation.%20With%20index%20notation%20in%20Cartesian%20coordinates%20the%20divergence%20may%20also%20be%20written%20as%20%24%5Cfrac%7B%5Cpartial%20A_%7Bij%7D%7D%7B%5Cpartial%20x_j%7D%24%20or%20%24%5Cfrac%7B%5Cpartial%20A_%7Bij%7D%7D%7B%5Cpartial%20x_j%7D%20%5Cboldsymbol%7Bi%7D_i%24%2C%20where%20%24%5C%7B%5Cboldsymbol%7Bi%7D_j%5C%7D_%7Bj%3D1%7D%5E3%24%20are%20the%203%20Cartesian%20unit%20vectors.%0A%0A%20%20%20%20Hence%20we%20write%20Div(Grad(u))%20as%20%24%5Cnabla%20%5Ccdot%20%5Cnabla%20%5Cboldsymbol%7Bu%7D%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Dot%2C%20sp%2C%20u)%3A%0A%20%20%20%20ut%20%3D%20Dot(u%2C%20C.get_contravariant_basis_vector(1)).doit()%0A%20%20%20%20sp.srepr(ut)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Outer%2C%20u)%3A%0A%20%20%20%20uu%20%3D%20Outer(u%2C%20u).doit()%0A%20%20%20%20return%20(uu%2C)%0A%0A%0A%40app.cell%0Adef%20_(uu)%3A%0A%20%20%20%20uu%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Dot%2C%20R1)%3A%0A%20%20%20%20C.simplify(Dot(R1%2C%20C.get_contravariant_basis_vector(0)).doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20R1)%3A%0A%20%20%20%20C.simplify(R1.doit())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(C%2C%20Dot%2C%20R1)%3A%0A%20%20%20%20r1%20%3D%20Dot(R1%2C%20C.get_contravariant_basis_vector(0)).doit()%0A%20%20%20%20r1%0A%20%20%20%20return%20(r1%2C)%0A%0A%0A%40app.cell%0Adef%20_(r1)%3A%0A%20%20%20%20r1.expand()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">cf2d56ca9d3b6db00ac020c1a4948280</marimo-code-hash>
</body>
</html>
